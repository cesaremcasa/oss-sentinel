id,number,title,state,body,author,comments_count,labels,url,created_at,closed_at,sentiment,category,urgency
3758303403,67470,dump-to-h2 fails if copying an entity type takes longer than 5 minutes,open,"### Describe the bug

If you run `dump-to-h2` and copying one particular entity type takes longer than the default app DB `c3p0.unreturnedConnectionTimeout` (5 minutes, which is the c3p0 general default) then the export fails.

This originated from a cloud snapshot job that couldn't finish after 5mins, for an instance with 15 million fields ðŸ˜±

### To Reproduce

1. Create a ginormous data set in a Postgres DB, e.g, a million fields:
```sql
DO $$
DECLARE
    table_index INTEGER;
    column_index INTEGER;
    create_table_sql TEXT;
BEGIN
    FOR table_index IN 1..1000 LOOP
        create_table_sql := format('CREATE TABLE table_%s (', table_index);
        
        FOR column_index IN 1..1000 LOOP
            create_table_sql := create_table_sql || format('field_%s TEXT', column_index);
            IF column_index < 1000 THEN
                create_table_sql := create_table_sql || ', ';
            END IF;
        END LOOP;
        
        create_table_sql := create_table_sql || ');';
        
        EXECUTE create_table_sql;
    END LOOP;
END $$;
```
2. Start Metabase on a postgres DB and add this DB, so that it syncs and creates 1M fields
3. Get a Metabase JAR and we'll also reduce the c3p0 timeout to fail quicker `java -Dc3p0.unreturnedConnectionTimeout=15 -jar local/jars/metabase-v57.7.5.jar dump-to-h2 test.h2`
4. Fails (see full logs below)
```
2025-12-23 16:13:00,535 ERROR cmd.core :: Failed to dump application database to H2 file 
org.postgresql.util.PSQLException: This ResultSet is closed.
```

### Expected behavior

Should perhaps ""poke the connection"" every few chunks copied or use a more generous unreturnedConnectionTimeout than the default.

### Logs

Had a couple more than 1M fields here but it should be similar:

```
2025-12-23 16:12:39,256 INFO app-db.setup :: Database Migrations Current ... âœ… 
2025-12-23 16:12:39,294 INFO metabase.util :: Database setup took 3.5 s 
2025-12-23 16:12:39,294 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,295 INFO cmd.copy :: Testing if target h2 database is already populated...  
2025-12-23 16:12:39,324 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,325 INFO cmd.copy :: Clearing default entries created by Liquibase migrations...  
2025-12-23 16:12:39,340 INFO cmd.copy :: Temporarily disabling DB constraints...  
2025-12-23 16:12:39,341 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,345 INFO cmd.copy :: Re-enabling DB constraints...  
2025-12-23 16:12:39,345 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,357 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,373 INFO cmd.copy :: Temporarily disabling DB constraints...  
2025-12-23 16:12:39,373 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,381 INFO cmd.copy :: Copying instances of ChannelTemplate... 
2025-12-23 16:12:39,383 INFO cmd.copy ::  copied 4 instances. 
2025-12-23 16:12:39,387 INFO cmd.copy :: Copying instances of Database... 
2025-12-23 16:12:39,387 INFO cmd.copy ::  copied 3 instances. 
2025-12-23 16:12:39,396 INFO cmd.copy :: Copying instances of User... 
2025-12-23 16:12:39,397 INFO cmd.copy ::  copied 2 instances. 
2025-12-23 16:12:39,398 INFO cmd.copy :: Copying instances of Setting... 
2025-12-23 16:12:39,398 INFO cmd.copy ::  copied 18 instances. 
2025-12-23 16:12:39,417 INFO cmd.copy :: Copying instances of Table... 
2025-12-23 16:12:39,621 INFO cmd.copy ::  copied 10021 instances. 
2025-12-23 16:12:48,803 INFO cmd.copy :: Copying instances of Field... 
2025-12-23 16:12:56,004 INFO cmd.copy :: Re-enabling DB constraints...  
2025-12-23 16:13:00,297 INFO cmd.copy :: [OK] 
2025-12-23 16:13:00,535 ERROR cmd.core :: Failed to dump application database to H2 file 
org.postgresql.util.PSQLException: This ResultSet is closed.
        at org.postgresql.jdbc.PgResultSet.checkClosed(PgResultSet.java:3259)
        at org.postgresql.jdbc.PgResultSet.next(PgResultSet.java:2272)
        at com.mchange.v2.c3p0.impl.NewProxyResultSet.next(NewProxyResultSet.java:4589)
        at clojure.java.jdbc$init_reduce_rs.invokeStatic(jdbc.clj:1204)
        at clojure.java.jdbc$init_reduce_rs.invoke(jdbc.clj:1197)
        at clojure.java.jdbc$reducible_result_set_STAR_$reify__40872.reduce(jdbc.clj:1227)
        at clojure.core$reduce.invokeStatic(core.clj:6964)
        at clojure.core$reduce.invoke(core.clj:6947)
        at clojure.java.jdbc$query_reducer$fn__40878$fn__40881.invoke(jdbc.clj:1262)
        at clojure.java.jdbc$execute_query_with_params.invokeStatic(jdbc.clj:1091)
        at clojure.java.jdbc$execute_query_with_params.invoke(jdbc.clj:1084)
        at clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1106)
        at clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093)
        at clojure.java.jdbc$reducible_query$reify__40895.reduce(jdbc.clj:1357)
        at clojure.core$transduce.invokeStatic(core.clj:7025)
        at clojure.core$transduce.invoke(core.clj:7012)
        at metabase.cmd.copy$copy_data_BANG_.invokeStatic(copy.clj:214)
        at metabase.cmd.copy$copy_data_BANG_.invoke(copy.clj:208)
        at metabase.cmd.copy$copy_BANG_$fn__115864$fn__115865$fn__115866.invoke(copy.clj:447)
        at metabase.cmd.copy$do_with_disabled_db_constraints.invokeStatic(copy.clj:309)
        at metabase.cmd.copy$do_with_disabled_db_constraints.invoke(copy.clj:305)
        at metabase.cmd.copy$copy_BANG_$fn__115864$fn__115865.invoke(copy.clj:446)
        at metabase.cmd.copy$do_with_connection_rollback_only.invokeStatic(copy.clj:251)
        at metabase.cmd.copy$do_with_connection_rollback_only.invoke(copy.clj:249)
        at metabase.cmd.copy$copy_BANG_$fn__115864.invoke(copy.clj:444)
        at clojure.java.jdbc$db_transaction_STAR_.invokeStatic(jdbc.clj:807)
        at clojure.java.jdbc$db_transaction_STAR_.invoke(jdbc.clj:776)
        at clojure.java.jdbc$db_transaction_STAR_.invokeStatic(jdbc.clj:852)
        at clojure.java.jdbc$db_transaction_STAR_.invoke(jdbc.clj:776)
        at clojure.java.jdbc$db_transaction_STAR_.invokeStatic(jdbc.clj:789)
        at clojure.java.jdbc$db_transaction_STAR_.invoke(jdbc.clj:776)
        at metabase.cmd.copy$copy_BANG_.invokeStatic(copy.clj:441)
        at metabase.cmd.copy$copy_BANG_.invoke(copy.clj:414)
        at metabase.cmd.dump_to_h2$dump_to_h2_BANG_.invokeStatic(dump_to_h2.clj:42)
        at metabase.cmd.dump_to_h2$dump_to_h2_BANG_.invoke(dump_to_h2.clj:25)
        at clojure.lang.Var.invoke(Var.java:390)
        at metabase.cmd.core$dump_to_h2.invokeStatic(core.clj:89)
        at metabase.cmd.core$dump_to_h2.doInvoke(core.clj:77)
        at clojure.lang.RestFn.invoke(RestFn.java:413)
        at clojure.lang.AFn.applyToHelper(AFn.java:154)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.cmd.core$run_cmd$fn__126087.invoke(core.clj:309)
        at metabase.cmd.core$run_cmd.invokeStatic(core.clj:306)
        at metabase.cmd.core$run_cmd.invoke(core.clj:296)
        at clojure.lang.Var.invoke(Var.java:395)
        at metabase.core.core$run_cmd.invokeStatic(core.clj:255)
        at metabase.core.core$run_cmd.invoke(core.clj:254)
        at metabase.core.core$entrypoint.invokeStatic(core.clj:279)
        at metabase.core.core$entrypoint.doInvoke(core.clj:272)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.core.bootstrap$_main.invokeStatic(bootstrap.clj:36)
        at metabase.core.bootstrap$_main.doInvoke(bootstrap.clj:29)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at metabase.core.bootstrap.main(Unknown Source)
```

### Information about your Metabase installation

```JSON
v57.7.5
```

### Severity

P2

### Additional context

Workaround is to slap for example `-Dc3p0.unreturnedConnectionTimeout=6000` (seconds) to make the connection timeout higher",ghostframe,0,"Type:Bug, Priority:P2, Operation/Serialization, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67470,2025-12-23T19:18:34Z,,negative,bug,high
3758185573,67469,Granular download permissions for SQL questions,open,"**Is your feature request related to a problem? Please describe.**
Right now download permissions is all or nothing if you have SQL questions (makes sense), but maybe there's admins that might want users to download some stuff and not others

**Describe the solution you'd like**
Granular question permissions for downloads (for SQL questions)

**Describe alternatives you've considered**
None

**How important is this feature to you?**
A customer needed this and we couldn't provide a solution, right now either you can download or not based on the database permission if you have SQL questions

**Additional context**
NA
",dragonsahead,0,"Type:New Feature, Administration/Permissions, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67469,2025-12-23T18:28:20Z,,neutral,feature_request,medium
3758087775,67466,Models explanatory modal's content isn't properly wrapping,open,"### Describe the bug

<img width=""583"" height=""427"" alt=""Image"" src=""https://github.com/user-attachments/assets/e992987b-db6c-44f8-a5fa-38ceee756760"" />

### To Reproduce

1. Start a new Metabase instance where you've never looked at a model before
2. Navigate to one of the example models
3. See this modal appear automatically and that its content isn't properly wrapping


### Expected behavior

Content should be centered and wrap

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2022-11-18"",
      ""src_hash"": ""09f4ec50c4b6096192e18c140068ce8a7e67434d"",
      ""tag"": ""v0.45.1-SNAPSHOT"",
      ""branch"": ""maz-make-saving-a-question-less-fear-inducing"",
      ""hash"": ""f694966""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2""
  }
}
```

### Severity

P2: it's an early first impression that makes our product seem broken.

### Additional context

_No response_",mazameli,2,"Type:Bug, Priority:P2, Querying/Models, .Team/Querying, Semantic Layer/Models, .Auto triaged",https://github.com/metabase/metabase/issues/67466,2025-12-23T17:43:39Z,,negative,bug,medium
3758079042,67465,"For admins, searches include other users' personal items when appdb is mysql but not postgres or h2",open,"### Describe the bug

This issue was found while fixing UXW-332. We noticed some inconsistent behavior with searching depending on our appdb type. Looks like the search endpoint uses ""exclude-others"" as a default for the `filter_items_in_personal_collection` param for postgres and h2 appdbs, but ""all"" when the appdb is mysql.

Including other users' personal items in quick search could potentially make it unusable.

### To Reproduce

1. Start an instance that uses either a postgres or h2 appdb and multiple users
2. Login as an admin
3. Search
4. Verify other users' personal collection items do not show up
5. Start an instance that uses a mysql appdb and multiple users
6. Login as an admin
7. Search

:x: All users' personal collection items show up

**Postgres/H2**

<img width=""2048"" height=""1127"" alt=""Image"" src=""https://github.com/user-attachments/assets/35f36a96-ce6d-4cb9-96e4-ff6e82e8eca7"" />

**Mysql**

<img width=""2048"" height=""1127"" alt=""Image"" src=""https://github.com/user-attachments/assets/7dcfcce9-bdbf-493d-9f5f-a48a880543c3"" />

### Expected behavior

Mysql appdbs should match postgres and h2 appdb behavior, should not include other users' personal items by default.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-12-04"",
      ""src_hash"": ""baccb62eb8ca1c3666a18784b134f709a4056fb9"",
      ""tag"": ""v1.57.1-SNAPSHOT"",
      ""hash"": ""ca49552""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql""
  }
}
```

### Severity

P3

### Additional context

_No response_",bpander,0,"Type:Bug, Priority:P3, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67465,2025-12-23T17:39:01Z,,negative,bug,high
3757969326,67462,Subscription emails failed to be sent on modular embeddings when dashboards has no data cards,open,"### Describe the bug

Even when the dashboard has no datacard, the subscription button is still visible, unlike in the core app. This will result in the email not sending.

<img width=""2457"" height=""1310"" alt=""Image"" src=""https://github.com/user-attachments/assets/128fee30-5700-43b9-adad-6b5fd3ad6fb3"" />

### To Reproduce

1. Create a dashboard without any cards
2. Set up SMTP server on admin settings > email
3. Click sharing icon > Embed
4. Select Metabase account (SSO)
5. Check ""Allow subscriptions""
6. The subscription button shouldn't be visible.

### Expected behavior

The subscription button shouldn't be visible like the internal use case because with no data cards, subscription seems to not work.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""pro-self-hosted"",
    ""version"": {
      ""date"": ""2025-12-05"",
      ""src_hash"": ""374b892ce9c512906eb510ddce991ff8cbf5bb72"",
      ""tag"": ""v1.57.1-SNAPSHOT"",
      ""hash"": ""908c174""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.2+13-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.2+13-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""26.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

This is confusing as the button shouldn't be there in the first place.

### Additional context

_No response_",WiNloSt,0,"Type:Bug, Priority:P3, .Frontend, .Team/Embedding, Embedding/EmbedJS",https://github.com/metabase/metabase/issues/67462,2025-12-23T16:55:24Z,,negative,bug,medium
