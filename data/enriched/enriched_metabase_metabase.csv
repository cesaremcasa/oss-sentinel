id,number,title,state,body,author,comments_count,labels,url,created_at,closed_at,sentiment,category,urgency
3758303403,67470,dump-to-h2 fails if copying an entity type takes longer than 5 minutes,open,"### Describe the bug

If you run `dump-to-h2` and copying one particular entity type takes longer than the default app DB `c3p0.unreturnedConnectionTimeout` (5 minutes, which is the c3p0 general default) then the export fails.

This originated from a cloud snapshot job that couldn't finish after 5mins, for an instance with 15 million fields ðŸ˜±

### To Reproduce

1. Create a ginormous data set in a Postgres DB, e.g, a million fields:
```sql
DO $$
DECLARE
    table_index INTEGER;
    column_index INTEGER;
    create_table_sql TEXT;
BEGIN
    FOR table_index IN 1..1000 LOOP
        create_table_sql := format('CREATE TABLE table_%s (', table_index);
        
        FOR column_index IN 1..1000 LOOP
            create_table_sql := create_table_sql || format('field_%s TEXT', column_index);
            IF column_index < 1000 THEN
                create_table_sql := create_table_sql || ', ';
            END IF;
        END LOOP;
        
        create_table_sql := create_table_sql || ');';
        
        EXECUTE create_table_sql;
    END LOOP;
END $$;
```
2. Start Metabase on a postgres DB and add this DB, so that it syncs and creates 1M fields
3. Get a Metabase JAR and we'll also reduce the c3p0 timeout to fail quicker `java -Dc3p0.unreturnedConnectionTimeout=15 -jar local/jars/metabase-v57.7.5.jar dump-to-h2 test.h2`
4. Fails (see full logs below)
```
2025-12-23 16:13:00,535 ERROR cmd.core :: Failed to dump application database to H2 file 
org.postgresql.util.PSQLException: This ResultSet is closed.
```

### Expected behavior

Should perhaps ""poke the connection"" every few chunks copied or use a more generous unreturnedConnectionTimeout than the default.

### Logs

Had a couple more than 1M fields here but it should be similar:

```
2025-12-23 16:12:39,256 INFO app-db.setup :: Database Migrations Current ... âœ… 
2025-12-23 16:12:39,294 INFO metabase.util :: Database setup took 3.5 s 
2025-12-23 16:12:39,294 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,295 INFO cmd.copy :: Testing if target h2 database is already populated...  
2025-12-23 16:12:39,324 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,325 INFO cmd.copy :: Clearing default entries created by Liquibase migrations...  
2025-12-23 16:12:39,340 INFO cmd.copy :: Temporarily disabling DB constraints...  
2025-12-23 16:12:39,341 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,345 INFO cmd.copy :: Re-enabling DB constraints...  
2025-12-23 16:12:39,345 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,357 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,373 INFO cmd.copy :: Temporarily disabling DB constraints...  
2025-12-23 16:12:39,373 INFO cmd.copy :: [OK] 
2025-12-23 16:12:39,381 INFO cmd.copy :: Copying instances of ChannelTemplate... 
2025-12-23 16:12:39,383 INFO cmd.copy ::  copied 4 instances. 
2025-12-23 16:12:39,387 INFO cmd.copy :: Copying instances of Database... 
2025-12-23 16:12:39,387 INFO cmd.copy ::  copied 3 instances. 
2025-12-23 16:12:39,396 INFO cmd.copy :: Copying instances of User... 
2025-12-23 16:12:39,397 INFO cmd.copy ::  copied 2 instances. 
2025-12-23 16:12:39,398 INFO cmd.copy :: Copying instances of Setting... 
2025-12-23 16:12:39,398 INFO cmd.copy ::  copied 18 instances. 
2025-12-23 16:12:39,417 INFO cmd.copy :: Copying instances of Table... 
2025-12-23 16:12:39,621 INFO cmd.copy ::  copied 10021 instances. 
2025-12-23 16:12:48,803 INFO cmd.copy :: Copying instances of Field... 
2025-12-23 16:12:56,004 INFO cmd.copy :: Re-enabling DB constraints...  
2025-12-23 16:13:00,297 INFO cmd.copy :: [OK] 
2025-12-23 16:13:00,535 ERROR cmd.core :: Failed to dump application database to H2 file 
org.postgresql.util.PSQLException: This ResultSet is closed.
        at org.postgresql.jdbc.PgResultSet.checkClosed(PgResultSet.java:3259)
        at org.postgresql.jdbc.PgResultSet.next(PgResultSet.java:2272)
        at com.mchange.v2.c3p0.impl.NewProxyResultSet.next(NewProxyResultSet.java:4589)
        at clojure.java.jdbc$init_reduce_rs.invokeStatic(jdbc.clj:1204)
        at clojure.java.jdbc$init_reduce_rs.invoke(jdbc.clj:1197)
        at clojure.java.jdbc$reducible_result_set_STAR_$reify__40872.reduce(jdbc.clj:1227)
        at clojure.core$reduce.invokeStatic(core.clj:6964)
        at clojure.core$reduce.invoke(core.clj:6947)
        at clojure.java.jdbc$query_reducer$fn__40878$fn__40881.invoke(jdbc.clj:1262)
        at clojure.java.jdbc$execute_query_with_params.invokeStatic(jdbc.clj:1091)
        at clojure.java.jdbc$execute_query_with_params.invoke(jdbc.clj:1084)
        at clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1106)
        at clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093)
        at clojure.java.jdbc$reducible_query$reify__40895.reduce(jdbc.clj:1357)
        at clojure.core$transduce.invokeStatic(core.clj:7025)
        at clojure.core$transduce.invoke(core.clj:7012)
        at metabase.cmd.copy$copy_data_BANG_.invokeStatic(copy.clj:214)
        at metabase.cmd.copy$copy_data_BANG_.invoke(copy.clj:208)
        at metabase.cmd.copy$copy_BANG_$fn__115864$fn__115865$fn__115866.invoke(copy.clj:447)
        at metabase.cmd.copy$do_with_disabled_db_constraints.invokeStatic(copy.clj:309)
        at metabase.cmd.copy$do_with_disabled_db_constraints.invoke(copy.clj:305)
        at metabase.cmd.copy$copy_BANG_$fn__115864$fn__115865.invoke(copy.clj:446)
        at metabase.cmd.copy$do_with_connection_rollback_only.invokeStatic(copy.clj:251)
        at metabase.cmd.copy$do_with_connection_rollback_only.invoke(copy.clj:249)
        at metabase.cmd.copy$copy_BANG_$fn__115864.invoke(copy.clj:444)
        at clojure.java.jdbc$db_transaction_STAR_.invokeStatic(jdbc.clj:807)
        at clojure.java.jdbc$db_transaction_STAR_.invoke(jdbc.clj:776)
        at clojure.java.jdbc$db_transaction_STAR_.invokeStatic(jdbc.clj:852)
        at clojure.java.jdbc$db_transaction_STAR_.invoke(jdbc.clj:776)
        at clojure.java.jdbc$db_transaction_STAR_.invokeStatic(jdbc.clj:789)
        at clojure.java.jdbc$db_transaction_STAR_.invoke(jdbc.clj:776)
        at metabase.cmd.copy$copy_BANG_.invokeStatic(copy.clj:441)
        at metabase.cmd.copy$copy_BANG_.invoke(copy.clj:414)
        at metabase.cmd.dump_to_h2$dump_to_h2_BANG_.invokeStatic(dump_to_h2.clj:42)
        at metabase.cmd.dump_to_h2$dump_to_h2_BANG_.invoke(dump_to_h2.clj:25)
        at clojure.lang.Var.invoke(Var.java:390)
        at metabase.cmd.core$dump_to_h2.invokeStatic(core.clj:89)
        at metabase.cmd.core$dump_to_h2.doInvoke(core.clj:77)
        at clojure.lang.RestFn.invoke(RestFn.java:413)
        at clojure.lang.AFn.applyToHelper(AFn.java:154)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.cmd.core$run_cmd$fn__126087.invoke(core.clj:309)
        at metabase.cmd.core$run_cmd.invokeStatic(core.clj:306)
        at metabase.cmd.core$run_cmd.invoke(core.clj:296)
        at clojure.lang.Var.invoke(Var.java:395)
        at metabase.core.core$run_cmd.invokeStatic(core.clj:255)
        at metabase.core.core$run_cmd.invoke(core.clj:254)
        at metabase.core.core$entrypoint.invokeStatic(core.clj:279)
        at metabase.core.core$entrypoint.doInvoke(core.clj:272)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.core.bootstrap$_main.invokeStatic(bootstrap.clj:36)
        at metabase.core.bootstrap$_main.doInvoke(bootstrap.clj:29)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at metabase.core.bootstrap.main(Unknown Source)
```

### Information about your Metabase installation

```JSON
v57.7.5
```

### Severity

P2

### Additional context

Workaround is to slap for example `-Dc3p0.unreturnedConnectionTimeout=6000` (seconds) to make the connection timeout higher",ghostframe,0,"Type:Bug, Priority:P2, Operation/Serialization, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67470,2025-12-23T19:18:34Z,,negative,bug,high
3758185573,67469,Granular download permissions for SQL questions,open,"**Is your feature request related to a problem? Please describe.**
Right now download permissions is all or nothing if you have SQL questions (makes sense), but maybe there's admins that might want users to download some stuff and not others

**Describe the solution you'd like**
Granular question permissions for downloads (for SQL questions)

**Describe alternatives you've considered**
None

**How important is this feature to you?**
A customer needed this and we couldn't provide a solution, right now either you can download or not based on the database permission if you have SQL questions

**Additional context**
NA
",dragonsahead,0,"Type:New Feature, Administration/Permissions, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67469,2025-12-23T18:28:20Z,,neutral,feature_request,medium
3758087775,67466,Models explanatory modal's content isn't properly wrapping,open,"### Describe the bug

<img width=""583"" height=""427"" alt=""Image"" src=""https://github.com/user-attachments/assets/e992987b-db6c-44f8-a5fa-38ceee756760"" />

### To Reproduce

1. Start a new Metabase instance where you've never looked at a model before
2. Navigate to one of the example models
3. See this modal appear automatically and that its content isn't properly wrapping


### Expected behavior

Content should be centered and wrap

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2022-11-18"",
      ""src_hash"": ""09f4ec50c4b6096192e18c140068ce8a7e67434d"",
      ""tag"": ""v0.45.1-SNAPSHOT"",
      ""branch"": ""maz-make-saving-a-question-less-fear-inducing"",
      ""hash"": ""f694966""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2""
  }
}
```

### Severity

P2: it's an early first impression that makes our product seem broken.

### Additional context

_No response_",mazameli,2,"Type:Bug, Priority:P2, Querying/Models, .Team/Querying, Semantic Layer/Models, .Auto triaged",https://github.com/metabase/metabase/issues/67466,2025-12-23T17:43:39Z,,negative,bug,medium
3758079042,67465,"For admins, searches include other users' personal items when appdb is mysql but not postgres or h2",open,"### Describe the bug

This issue was found while fixing UXW-332. We noticed some inconsistent behavior with searching depending on our appdb type. Looks like the search endpoint uses ""exclude-others"" as a default for the `filter_items_in_personal_collection` param for postgres and h2 appdbs, but ""all"" when the appdb is mysql.

Including other users' personal items in quick search could potentially make it unusable.

### To Reproduce

1. Start an instance that uses either a postgres or h2 appdb and multiple users
2. Login as an admin
3. Search
4. Verify other users' personal collection items do not show up
5. Start an instance that uses a mysql appdb and multiple users
6. Login as an admin
7. Search

:x: All users' personal collection items show up

**Postgres/H2**

<img width=""2048"" height=""1127"" alt=""Image"" src=""https://github.com/user-attachments/assets/35f36a96-ce6d-4cb9-96e4-ff6e82e8eca7"" />

**Mysql**

<img width=""2048"" height=""1127"" alt=""Image"" src=""https://github.com/user-attachments/assets/7dcfcce9-bdbf-493d-9f5f-a48a880543c3"" />

### Expected behavior

Mysql appdbs should match postgres and h2 appdb behavior, should not include other users' personal items by default.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-12-04"",
      ""src_hash"": ""baccb62eb8ca1c3666a18784b134f709a4056fb9"",
      ""tag"": ""v1.57.1-SNAPSHOT"",
      ""hash"": ""ca49552""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql""
  }
}
```

### Severity

P3

### Additional context

_No response_",bpander,0,"Type:Bug, Priority:P3, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67465,2025-12-23T17:39:01Z,,negative,bug,high
3757969326,67462,Subscription emails failed to be sent on modular embeddings when dashboards has no data cards,open,"### Describe the bug

Even when the dashboard has no datacard, the subscription button is still visible, unlike in the core app. This will result in the email not sending.

<img width=""2457"" height=""1310"" alt=""Image"" src=""https://github.com/user-attachments/assets/128fee30-5700-43b9-adad-6b5fd3ad6fb3"" />

### To Reproduce

1. Create a dashboard without any cards
2. Set up SMTP server on admin settings > email
3. Click sharing icon > Embed
4. Select Metabase account (SSO)
5. Check ""Allow subscriptions""
6. The subscription button shouldn't be visible.

### Expected behavior

The subscription button shouldn't be visible like the internal use case because with no data cards, subscription seems to not work.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""pro-self-hosted"",
    ""version"": {
      ""date"": ""2025-12-05"",
      ""src_hash"": ""374b892ce9c512906eb510ddce991ff8cbf5bb72"",
      ""tag"": ""v1.57.1-SNAPSHOT"",
      ""hash"": ""908c174""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.2+13-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.2+13-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""26.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

This is confusing as the button shouldn't be there in the first place.

### Additional context

_No response_",WiNloSt,0,"Type:Bug, Priority:P3, .Frontend, .Team/Embedding, Embedding/EmbedJS",https://github.com/metabase/metabase/issues/67462,2025-12-23T16:55:24Z,,negative,bug,medium
3757782781,67456,Remote Sync BitBucket support,open,"**Is your feature request related to a problem? Please describe.**
Currently, we only support connecting to GitHub 

**Describe the solution you'd like**
Native BitBucket support

**Describe alternatives you've considered**
N/a

**How important is this feature to you?**
Requested by a customer, internal ticket [here](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=23134ab6-a284-4e07-8acd-f4f36dc38952)

**Additional context**
There's this relevant [internal convo](https://metaboat.slack.com/archives/C09LUUMAU1G/p1761322412962199) 
",ignacio-mb,0,"Type:New Feature, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67456,2025-12-23T15:48:58Z,,neutral,feature_request,medium
3757161400,67440,After Upgrading from 57 to 56 filtering on enum columns broke - 1 cloud instance effected,open,"### Describe the bug

After Upgrading from 57 to 56 filtering on enum columns broke. What is odd is that the customer shared with me the DDL and I created 

### To Reproduce

I was not able to replicate here and what is odd is that the customer shared with me the DDL:

```
CREATE TYPE public.source_enum AS ENUM (
    'UBEREATS',
    'UNKNOWN');

CREATE TABLE filter_enum_test_2
(
    enum_column public.source_enum NOT NULL
);
INSERT INTO filter_enum_test_2 (enum_column)
VALUES ('UBEREATS');
```

If you check the GUI interface on 56 you get this:

<img width=""1693"" height=""617"" alt=""Image"" src=""https://github.com/user-attachments/assets/5fd271bb-6afa-49c7-9b9d-472897edfdf1"" />

After the upgrade to 57 you got this:

<img width=""1728"" height=""531"" alt=""Image"" src=""https://github.com/user-attachments/assets/9dad5003-de51-4f3a-b216-4eb5fb1e1d33"" />

There is no CAST applied and it errors out. What is strange though is that I ran the same DDL and in 57 my local instance adds this CAST:

<img width=""1725"" height=""402"" alt=""Image"" src=""https://github.com/user-attachments/assets/99213226-7b21-4341-8a94-cf1dfc30a0d1"" />

Something during the upgrade caused these tables to drop the CAST on enum columns



### Expected behavior

Ability to filter on Enums

### Logs

[67a7776c-85cf-4752-9d9e-54d6c2a89ee6] 2025-12-23T13:06:16+01:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: ERROR: operator does not exist: source_enum = character varying
  Hint: No operator matches the given name and argument types. You might need to add explicit type casts.
  Position: 262
{:database_id 4,
 :parameterized false,
 :started_at #t ""2025-12-23T12:06:16.174540675Z[GMT]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error
   ""Error executing query: ERROR: operator does not exist: source_enum = character varying\n  Hint: No operator matches the given name and argument types. You might need to add explicit type casts.\n  Position: 262"",
   :stacktrace
   [""--> driver.sql_jdbc.execute$execute_reducible_query$fn__93745$fn__93746.invoke(execute.clj:770)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__93745.invoke(execute.clj:767)""
    ""driver.sql_jdbc.execute$fn__93520$fn__93521.invoke(execute.clj:422)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:347)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:327)""
    ""driver.sql_jdbc.execute$fn__93520.invokeStatic(execute.clj:416)""
    ""driver.sql_jdbc.execute$fn__93520.invoke(execute.clj:414)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:760)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:749)""
    ""driver.sql_jdbc$fn__98430.invokeStatic(sql_jdbc.clj:87)""
    ""driver.sql_jdbc$fn__98430.invoke(sql_jdbc.clj:85)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:59)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:44)""
    ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:119)""
    ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:108)""
    ""query_processor.execute$run.invokeStatic(execute.clj:72)""
    ""query_processor.execute$run.invoke(execute.clj:62)""
    ""metabase_enterprise.database_routing.middleware$fn__148132$swap_destination_db__148133$fn__148134.invoke(middleware.clj:32)""
    ""query_processor.middleware.enterprise$swap_destination_db_middleware$fn__79086.invoke(enterprise.clj:75)""
    ""metabase_enterprise.impersonation.middleware$fn__135088$apply_impersonation_postprocessing__135089$fn__135090.invoke(middleware.clj:35)""
    ""query_processor.middleware.enterprise$apply_impersonation_postprocessing_middleware$fn__79068.invoke(enterprise.clj:50)""
    ""query_processor.middleware.update_used_cards$update_used_cards_BANG_$fn__80877.invoke(update_used_cards.clj:67)""
    ""query_processor.execute$add_native_form_to_result_metadata$fn__80917.invoke(execute.clj:27)""
    ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__80924.invoke(execute.clj:39)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___80796.invoke(cache.clj:248)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__73758.invoke(permissions.clj:153)""
    ""metabase_enterprise.advanced_permissions.query_processor.middleware.permissions$fn__136848$oss_or_ee_fn__47432__auto____136849$fn__136850.invoke(permissions.clj:65)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__79096.invoke(enterprise.clj:92)""
    ""query_processor.execute$execute$fn__80956.invoke(execute.clj:99)""
    ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:232)""
    ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)""
    ""query_processor.execute$execute.invokeStatic(execute.clj:98)""
    ""query_processor.execute$execute.invoke(execute.clj:94)""
    ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:50)""
    ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:45)""
    ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__93964$handle_audit_app_internal_queries__93965$fn__93966.invoke(handle_audit_queries.clj:143)""
    ""query_processor.middleware.enterprise$handle_au...

### Information about your Metabase installation

```JSON
1.57.7.6
```

### Severity

Blocking an upgrade cause questions on dashboard all broke

### Additional context

_No response_",Tony-metabase,0,"Type:Bug, Priority:P1, Querying/Parameters & Variables, .Team/Querying, .Auto triaged, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/67440,2025-12-23T12:06:54Z,,negative,bug,high
3756649227,67432,Copy cells from table on dashboard after you sort re-orders rows on paste,open,"### Describe the bug

A little bit odd so it's easier to see what is going on:

https://github.com/user-attachments/assets/a4790d67-95c7-40f0-9fe3-47fea713845b

Notice how the copy paste works well when no sorting on the table is applied but after sorting is applied the pasted cells are reorderd

### To Reproduce

1. Go to New -> Question -> Products -> Save on Dashbaord
2. Copy a couple of cells from this table and paste them somewhere

<img width=""1166"" height=""427"" alt=""Image"" src=""https://github.com/user-attachments/assets/dc3b3825-1b97-40ab-b86e-dd6dc6451e79"" />

3. Now order on Vendor and do the same, notice the cells are re-ordered without a proper pattern:

<img width=""1233"" height=""504"" alt=""Image"" src=""https://github.com/user-attachments/assets/2c807bc5-d24a-463c-99de-9e854adca218"" />


### Expected behavior

The same order is kept after i paste the rows somewhere else

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
1.56 and 1.57
```

### Severity

annoying

### Additional context

_No response_",Tony-metabase,0,"Type:Bug, Priority:P3, Visualization/, Difficulty:Easy, Visualization/Tables, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67432,2025-12-23T09:05:41Z,,negative,bug,medium
3755807193,67427,date format add yyyy-mm-dd,open,"add yyyy-mm-dd date format
",bytepure,0,"Type:New Feature, Querying/Parameters & Variables, .Team/Querying, .Auto triaged",https://github.com/metabase/metabase/issues/67427,2025-12-23T02:34:14Z,,neutral,feature_request,medium
3755802687,67426,Provide more helpful row and column level security errors when there is a data type mismatch,open,"**Is your feature request related to a problem? Please describe.**
For example, if your table has a text column and you cast it to an int in the SQL query that you use as the table for row and column level security, that will cause an error because there is a mismatch in the data types. Today, that error looks like this 

<img width=""780"" height=""296"" alt=""Image"" src=""https://github.com/user-attachments/assets/51cfca79-c278-42ab-a074-a9043df8694e"" />

**Describe the solution you'd like**
From the words of the customer

> I wish the error message would make it more clear what the issue was, e.g. ""the table says the column A is X type, but your sandbox returns Y.""

**Describe alternatives you've considered**
Analyze the SQL query to see which column(s) were the culprit for the error. If you're doing lots of data manipulation in the query, this can be nontrivial.

**Additional context**
Customer request
",jessicaul,0,"Type:New Feature, Administration/Data Sandboxes, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67426,2025-12-23T02:31:06Z,,neutral,feature_request,medium
3755702968,67421,Multi-select cells on Table Viz cannot be copied.,open,"### Describe the bug

This feature can be used when deploying with Docker locally, but it cannot be used when deploying with JAR on a production server. Could you please tell me how to solve this?

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""zh-CN"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""sqlserver""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-12-15"",
      ""tag"": ""v0.57.6.3"",
      ""hash"": ""cb806c7""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.5""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""Java(TM) SE Runtime Environment"",
    ""java.runtime.version"": ""21.0.8+12-LTS-250"",
    ""java.vendor"": ""Oracle Corporation"",
    ""java.vendor.url"": ""https://java.oracle.com/"",
    ""java.version"": ""21.0.8"",
    ""java.vm.name"": ""Java HotSpot(TM) 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.8+12-LTS-250"",
    ""os.name"": ""Windows Server 2022"",
    ""os.version"": ""10.0"",
    ""user.language"": ""zh"",
    ""user.timezone"": ""Asia/Shanghai""
  }
}
```

### Severity

normal

### Additional context

_No response_",dhstime,0,"Type:Bug, Priority:P3, Visualization/, Visualization/Tables, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67421,2025-12-23T01:22:52Z,,negative,bug,medium
3755667734,67418,Collections in the trash won't let the user delete other collections even though it was permissions on the latter,open,"### Describe the bug

A combination of permissions that lead to a confusion (a dependent collection is in the trash so normal users have full permissions on the parents of those, but they can't delete any of these)


### To Reproduce

1) create a group and add a new user to that group
1) as an admin create collections 1,2,3,4,5,6 (each one is under the previous one)
<img width=""861"" height=""587"" alt=""Image"" src=""https://github.com/user-attachments/assets/d02f10ca-093e-412c-906a-6f5cc994ce8f"" />
3) Assign permissions like the following:
- curate to 1,2,3,4,6 for the group created on step 1
- set collection number 5 to ""No access"" (collection 6 still has curate!), and then delete as an admin collection number 5

now the normal user has curate on 1,2,3,4... and 6! but 6 is in the trash... so you can't delete anything as the normal user, since there's a collection in the trash that you can't recover (you dont' have permissions to see it)

### Expected behavior

This one is going to be tricky... Maybe alert the user that it can't delete stuff since dependant collections are in the trash?

### Logs

2025-12-23 00:58:32,262 WARN middleware.log :: PUT /api/collection/6 403 4ms (6 DB calls) {:metabase-user-id 2}
""You don't have permissions to do that.""

### Information about your Metabase installation

```JSON
it's been like that since forever
```

### Severity

P2

### Additional context

_No response_",dragonsahead,0,"Type:Bug, Priority:P2, Administration/Permissions, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67418,2025-12-23T00:58:52Z,,negative,bug,medium
3755335734,67409,Static/Interactive Embedding fails on sites with Cross-Origin-Embedder-Policy (COEP) enabled,open,"### Describe the bug

Metabase embedding (static and interactive) fails to load when the embedding page has `Cross-Origin-Embedder-Policy: credentialless` or `Cross-Origin-Embedder-Policy: require-corp` headers set. This affects customers using hosting platforms or applications that require COEP for security features like `SharedArrayBuffer`.

The root cause is that Metabase does not send the required `Cross-Origin-Embedder-Policy` and `Cross-Origin-Resource-Policy` headers in its responses. When a parent page has COEP enabled, browsers require embedded iframes to also send these headers.

### To Reproduce

### Prerequisites for local repro steps below
- Python 3.11+
- Node.js 18+
- A running Metabase instance with static embedding enabled

### Step 1: Create reproduction files

Create a new directory and add these three files:

**`server.py`** - Local server that adds COEP headers:
```python
#!/usr/bin/env python3
""""""
Minimal COEP server to reproduce Metabase embedding issue.

Usage:
    python server.py [port]

Then open http://localhost:8080 in your browser.
""""""

import http.server
import sys

PORT = int(sys.argv[1]) if len(sys.argv) > 1 else 8080

class COEPHandler(http.server.SimpleHTTPRequestHandler):
    def end_headers(self):
        # These headers enable cross-origin isolation (required for SharedArrayBuffer)
        # But they also require embedded iframes to send matching headers
        self.send_header('Cross-Origin-Embedder-Policy', 'credentialless')
        self.send_header('Cross-Origin-Opener-Policy', 'same-origin')
        super().end_headers()

print(f""""""
COEP Test Server
================
Serving on: http://localhost:{PORT}

Headers being sent:
  Cross-Origin-Embedder-Policy: credentialless
  Cross-Origin-Opener-Policy: same-origin

Edit index.html to add your Metabase embed URL
"""""")

with http.server.HTTPServer(("""", PORT), COEPHandler) as httpd:
    try:
        httpd.serve_forever()
    except KeyboardInterrupt:
        print(""\nShutting down..."")
```

**`index.html`** - Test page with COEP status and Metabase iframe:
```html
<!DOCTYPE html>
<html>
<head>
  <title>COEP/Metabase Embedding Test</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 20px; }
    .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    iframe { width: 100%; height: 400px; border: 1px solid #ccc; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>COEP + Metabase Static Embedding Test</h1>

  <div id=""coep-status"" class=""status""></div>
  <div id=""sab-status"" class=""status""></div>

  <h2>Metabase Embed (will fail if Metabase lacks COEP headers)</h2>

  <!-- Replace with your actual Metabase static embed URL -->
  <iframe
    id=""metabase-embed""
    src=""REPLACE_WITH_YOUR_METABASE_EMBED_URL""
    frameborder=""0""
    allowtransparency
  ></iframe>

  <script>
    // Check if cross-origin isolated (COEP enabled)
    const coepStatus = document.getElementById('coep-status');
    if (crossOriginIsolated) {
      coepStatus.className = 'status success';
      coepStatus.textContent = 'Cross-Origin Isolated: TRUE (COEP is working)';
    } else {
      coepStatus.className = 'status error';
      coepStatus.textContent = 'Cross-Origin Isolated: FALSE (COEP headers missing)';
    }

    // Test SharedArrayBuffer availability
    const sabStatus = document.getElementById('sab-status');
    try {
      const sab = new SharedArrayBuffer(1024);
      sabStatus.className = 'status success';
      sabStatus.textContent = 'SharedArrayBuffer: Available (' + sab.byteLength + ' bytes)';
    } catch (e) {
      sabStatus.className = 'status error';
      sabStatus.textContent = 'SharedArrayBuffer: ' + e.message;
    }

    // Log iframe load errors
    document.getElementById('metabase-embed').onerror = (e) => {
      console.error('Iframe load error:', e);
    };
  </script>
</body>
</html>
```

**`generate-embed-url.js`** - Generate Metabase static embed URL:
```javascript
#!/usr/bin/env node
/**
 * Generate Metabase static embed URL with JWT token
 *
 * Usage:
 *   npm install jsonwebtoken
 *   node generate-embed-url.js
 */

const jwt = require(""jsonwebtoken"");

// UPDATE THESE for your Metabase instance
const METABASE_SITE_URL = ""https://your-instance.metabaseapp.com"";  // or http://localhost:3000
const METABASE_SECRET_KEY = ""your-embedding-secret-key-from-admin-panel"";
const DASHBOARD_ID = 1;  // Change to your dashboard ID

const payload = {
  resource: { dashboard: DASHBOARD_ID },
  params: {},
  exp: Math.round(Date.now() / 1000) + (10 * 60) // 10 minute expiration
};

const token = jwt.sign(payload, METABASE_SECRET_KEY);
const iframeUrl = `${METABASE_SITE_URL}/embed/dashboard/${token}#bordered=true&titled=true`;

console.log(""\n=== Metabase Static Embed URL ===\n"");
console.log(iframeUrl);
console.log(""\n=== Copy this URL to index.html iframe src ===\n"");
```

### Step 2: Generate embed URL

```bash
npm install jsonwebtoken
node generate-embed-url.js
```

Copy the output URL.

### Step 3: Update index.html

Replace `REPLACE_WITH_YOUR_METABASE_EMBED_URL` with the URL from Step 2.

### Step 4: Start the COEP server

```bash
python server.py
```

### Step 5: Observe the bug

1. Open http://localhost:8080 in your browser
2. You should see:
   - **Cross-Origin Isolated: TRUE** (proves COEP is working)
   - **SharedArrayBuffer: Available** (proves the feature works)
   - **Metabase iframe: FAILS TO LOAD** (the bug)
3. Open DevTools Console - you may see (depending on browser, no error shown with Firefox):
   ```
   net::ERR_BLOCKED_BY_RESPONSE.NotSameOriginAfterDefaultedToSameOriginByCoep
   ```

### Real-world trigger scenarios
- Firebase Hosting with COOP/COEP headers configured
- Any application using `SharedArrayBuffer` (requires COEP)
- WebContainers (StackBlitz, CodeSandbox, etc.)


### Expected behavior

Metabase should include the following headers in responses to support embedding in COEP-enabled environments:

```
Cross-Origin-Embedder-Policy: credentialless
Cross-Origin-Resource-Policy: cross-origin
```

## Technical Analysis

### Current Implementation
File: `src/metabase/server/middleware/security.clj`

The `security-headers` function (lines 269-293) defines all security headers Metabase sends, but does NOT include:
- `Cross-Origin-Embedder-Policy`
- `Cross-Origin-Resource-Policy`



### Logs

No server-side errors - this is a browser-enforced security policy.

Browser console shows COEP-related blocking messages when attempting to load the iframe.

### Information about your Metabase installation

```JSON
- Version: v1.57.6 (Metabase Cloud)
- Embedding type: Static embedding (JWT)
- Hosting: Metabase Cloud (`*.metabaseapp.com`)
```

### Severity

**Blocking for affected customers** - There is no workaround for Metabase Cloud customers whose applications require COEP. Self-hosted customers can work around by adding headers via reverse proxy.

### Additional context

### Proposed Fix
Add these headers to the `security-headers` function when embedding is enabled:

```clojure
;; In security-headers function, add:
""Cross-Origin-Embedder-Policy""  ""credentialless""
""Cross-Origin-Resource-Policy""  ""cross-origin""
```

(Settable via env variable or when relevant embedding enabled if any risks associated with adding those headers or won't be backwards compatible.)

### Why This Matters
Per [MDN documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy), when a parent page uses `COEP: credentialless`, embedded iframes must also send COEP headers. This is a browser security requirement with no client-side workaround.

## Affected Environments

| Environment | COEP by default? |
|-------------|------------------|
| Firebase Hosting (with COOP/COEP configured) | Configurable |
| Apps using SharedArrayBuffer | Required |
| WebContainers (StackBlitz, etc.) | Required |

### Hosting providers where users may configure COEP:
- Firebase Hosting (via firebase.json headers config)
- Cloudflare (via Transform Rules or Workers)
- Any self-hosted with nginx/Apache header configuration

## Customer Impact

- Customer using Firebase Hosting for their application
- Static embedding with JWT works on self-hosted Metabase with nginx adding headers
- Same embedding fails on Metabase Cloud because headers are missing
- Customer had to deploy self-hosted Metabase as workaround

**Customer quote:** ""We were hoping that by paying metabase to host our instances, we wouldn't have to get involved with this sort of stuff.""

### Customer's Working Self-Hosted Configuration (nginx)
```nginx
add_header Cross-Origin-Resource-Policy cross-origin always;
add_header Cross-Origin-Embedder-Policy credentialless always;
```

### Related Resources
- [MDN: Cross-Origin-Embedder-Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy)
- [Chrome: Load cross-origin resources without CORP headers using COEP: credentialless](https://developer.chrome.com/blog/coep-credentialless-origin-trial)
- [web.dev: Making your website cross-origin isolated](https://web.dev/articles/coop-coep)
- [Captain Codeman: Cross-Origin-Isolation with SvelteKit, Vite, and Firebase](https://www.captaincodeman.com/cross-origin-isolation-with-sveltekit-vite-and-firebase)
",likeshumidity,1,"Type:Bug, Priority:P1, Embedding/Static, .Escalation, .Team/Embedding, .Auto triaged",https://github.com/metabase/metabase/issues/67409,2025-12-22T21:54:52Z,,negative,bug,high
3755273529,67404,Joining two tables generates SQL that lists all columns of the second table,open,"### Describe the bug

When joining 2 tables, we list all of the columns in the second table, even if we are only grabbing a couple in the select statement.

<img width=""1701"" height=""864"" alt=""Image"" src=""https://github.com/user-attachments/assets/26cb8f7f-3d7f-40b5-8f27-47111dd69c10"" />

The customer mentioned that we changed this behavior (it didn't used to be like this), and now the experience of using GUI questions as a starting point to then convert to SQL is worse. The customer would like us to return to a cleaner code experience. 

### To Reproduce

1. Create a new GUI question and use the Products table from the sample database.
2. Join Products to Orders.
3. View the SQL that was generated for this query.
4. See that all columns of the Orders table is listed. 


### Expected behavior

Just like the first table, we should only select the columns that are needed for the output. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
occurs in v56 and v57 (in v55 it was a nice neat query)
```

### Severity

Annoying, makes the Convert to SQL experience a lot worse

### Additional context

_No response_",jessicaul,0,"Type:Bug, Priority:P3, Querying/Notebook, .Team/Querying",https://github.com/metabase/metabase/issues/67404,2025-12-22T21:27:59Z,,negative,bug,medium
3755000294,67399,Embedded metabot preview doesn't scroll independently of query results,open,"### Describe the bug

https://www.loom.com/share/4d3bb9296a694f73978a3006a4604784

The embedded Metabot preview window includes an area to see visualizations & a Metabot chat sidebar. If the chat gets long enough to overflow vertically, it creates a scrollbar for the entire window, rather than just for the chat.

A secondary, less important issue is the fact that the chat box clears focus after each message, which is a bit annoying.

Unsure if these are issues with the actual embedded Metabot; I haven't tested.

### To Reproduce

1. Run Metabase with Metabot enabled 
2. Enable ""modular embedding"" and click ""New embed""
3. Select Metabot and start a conversation
4. Once the conversation text overflows the chat window vertically, try scrolling

### Expected behavior

Only the chat sidebar contents should scroll

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:146.0) Gecko/20100101 Firefox/146.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-11-07"",
      ""src_hash"": ""cc2928caac13ff25138b219362af2e631212f3f5"",
      ""tag"": ""v1.57.1-SNAPSHOT"",
      ""hash"": ""393ae2f""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

P3

### Additional context

_No response_",noahmoss,0,"Type:Bug, Priority:P3, .Team/Embedding, Embedding/SDK, Metabot/UX",https://github.com/metabase/metabase/issues/67399,2025-12-22T19:45:37Z,,negative,bug,medium
3754871901,67395,Metabase should give an option to shut down if premium features are removed - Token Expiry or Grace Period,open,"**Is your feature request related to a problem? Please describe.**

Metabase should shut down if premium features are removed (in any circumstance). Even if someone goes in the Billing and by mistake removes it.

The AWS outage caused a lot of issues around this. And yes we fail close on sandboxing and perms etc. but what if you're embedding mb? Now the color palette and fonts we customized won't work and makes the whole app experience weird. To list a few other concerns:

1. It may be open to some sort of leakage or exploit. It may be that the case witnessed in October can never recur, but there may be other cases that we are unaware of. E.g. data routing or impersonation or some new future feature
2. It will cause errors for our end users.
3. It will generate a spike in errors that may affect the application and/or monitoring infrastructure.


**Describe the solution you'd like**
 An option to force Metabase to shut down if it loses its premium state.  An ENV variable like `MB_SHUTDOWN_ON_NO_FEATURES=true` so it only impact users that opt for it in cases where security is of paramount concern.

So people can decide themself the threshold if metabase should revert to OSS or simply shutdown.

**Describe alternatives you've considered**
To monitor the logs so that we can shut it down manually. Monitoring is hard because there is no single log entry that we can check for. This creates uncertainty now, and brittleness in the future because the risk is that the log messages will change


",Tony-metabase,0,"Type:New Feature, Administration/Settings, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67395,2025-12-22T18:59:05Z,,negative,feature_request,high
3754843357,67394,Allow people to ask questions to Metabot AI in Slack,open,"**Is your feature request related to a problem? Please describe.**
It'd be convenient ask questions to Metabot AI from within Slack.

**Describe the solution you'd like**
You ask a question from Slack and Metabot returns a link or text + image with the answer. 

**Describe alternatives you've considered**
There are native Slack apps for AI-powered insights but they don't leverage your metadata and models from Metabase. Another alternative would be to build a chat feature within Metabase (e.g. dashboard comments) so that people can talk about insights. This chat feature might remove the need for a Slack integration. 

**Additional context**
Would need to figure out how integration would work with permissions 
",afleming9796,0,"Type:New Feature, Metabot/Tools, .Team/Metabot, .Auto triaged",https://github.com/metabase/metabase/issues/67394,2025-12-22T18:48:45Z,,positive,feature_request,medium
3754580081,67388,Remote sync: Include Table metadata in the sync,open,"**Describe the solution you'd like**
Include the Table Metadata in the data that is synced via Remote Sync. 

**Describe alternatives you've considered**
Build a pipeline using export / import

**How important is this feature to you?**
Requested by a user",psalinasy,0,"Type:New Feature, Operation/Serialization, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67388,2025-12-22T17:21:58Z,,neutral,feature_request,medium
3754025467,67372,Advanced SQL RLS hides columns and then randomly shows them up - upgrade to 57 caused this,open,"### Describe the bug

Hard to explain but when you use Advanced SQL RLS the Table that you apply this to loses all columns. The columns would show in the results but you cannot filter and if you have this table joined with some other table it will of course fail cause no columns show up

### To Reproduce

1. Go to New ->SQL -> Sample DB -> Copy the below and save the variable as Text -> This is your RLS SQL Query

```
SELECT * FROM products where id = {{id}}
```
2. Go to Create User -> Add an ID attribute and give it a value of 1

<img width=""601"" height=""625"" alt=""Image"" src=""https://github.com/user-attachments/assets/230b5360-300b-402f-80ad-25900bc3ab61"" />

3. Now go to permissions -> All users -> Products -> RLS and setup the query we created above:

<img width=""662"" height=""764"" alt=""Image"" src=""https://github.com/user-attachments/assets/dd7d67de-8ed4-4fd9-87e1-8e6fa57dfd76"" />

4. Now login as the user above -> and go to the Products table -> Notice the data loads as expected:

<img width=""1728"" height=""215"" alt=""Image"" src=""https://github.com/user-attachments/assets/9df28a9e-b35b-4b67-b8a4-e2447c52b914"" />

5. Now try to pick a column or filter, no column show up:

<img width=""1544"" height=""336"" alt=""Image"" src=""https://github.com/user-attachments/assets/f460f62c-82a8-46b7-9361-b8e880c16062"" />

This is a bigger issue if you used this table as a join to another table cause the results won't even show up in that case and error cause it will join to an ""unknown field""


NOTE: That after some time the columns then load on my case:

<img width=""1728"" height=""348"" alt=""Image"" src=""https://github.com/user-attachments/assets/e0cc628c-906c-4778-a948-476dbbfa0552"" />

To make them vanish again just go to the SQL RLS query do a small change and save and they will vanish again.

https://github.com/user-attachments/assets/ff0dc814-0280-4e87-8cd4-652595e451ce

### Expected behavior

I get the filters available the moment i log in not after some random time

### Logs

None that seem relevant

### Information about your Metabase installation

```JSON
1.57.7
```

### Severity

For me the columns come after some sec but for a customer they never show up probably because queries are long and large ... They also have these tables used as joins to question so the question loads broken cause there are no columns to join with

### Additional context

_No response_",Tony-metabase,0,"Type:Bug, Priority:P1, Difficulty:Medium, Administration/Data Sandboxes, .Escalation, .Team/UXWest, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/67372,2025-12-22T14:34:37Z,,negative,bug,high
3753861311,67365,Metabase enters an unrecoverable high-CPU unresponsive state since version 1.57,open,"**Describe the bug**
Fore some mysterious reasons Metabase enters a degraded state where it becomes unresponsive, while CPU usage reaches and remains at 80%. The application does not recover without a restart. This state happens randomly during the week, mostly during business hour.

We started to face this behaviour only after upgrade from v1.56.6.1 to v1.57.3.3. 
We deploy metabase-enterprise image with docker compose.

**Logs**
You'll find the server logs : [metabase_20251222.log](https://github.com/user-attachments/files/24292203/metabase_20251222.log), from 15 minutes before the metabase restart until 15 minutes after (from 10:15 to 10:45).

**To Reproduce**
Unfortunately, we are unable to reliably reproduce this behavior.

**Expected behavior**
Temporary performance degradation under high load is acceptable. However, Metabase should recover automatically once resource usage returns to normal.

**Severity**
This is disruptive in production, as it requires manual restarts and results in user complaints.

**Monitoring**
Host server CPU (the server is hosting metabase and its postgresl app db as well)
<img width=""1254"" height=""514"" alt=""Image"" src=""https://github.com/user-attachments/assets/4c1e45be-08c9-4efd-b23e-1d476e639a7f"" />

Restarts was manually performed at 10:30.

Metabase metrics :

<img width=""2546"" height=""1054"" alt=""Image"" src=""https://github.com/user-attachments/assets/e180d5f8-94a8-4221-a3f9-b83f52c7c91d"" />

<img width=""2536"" height=""1058"" alt=""Image"" src=""https://github.com/user-attachments/assets/89f29196-7672-4e10-a312-5cec97d41ebe"" />
The red part is just datadog finding sth unusual (the JVM RAM usage has dropped after restart).


**What we have tried so far**
We changed the syncronisation frequency of all databases from hourly to daily (and at night).
We also tried to vary MB_APPLICATION_DB_MAX_CONNECTION_POOL_SIZE with higher and lower values, in vain.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2025-11-24"",
      ""tag"": ""v1.57.3.3"",
      ""hash"": ""b08483c""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.3 (Ubuntu 14.3-1.pgdg20.04+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-211-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```",etiennecallies,2,,https://github.com/metabase/metabase/issues/67365,2025-12-22T13:47:39Z,,negative,bug,high
3753825141,67364,"Pivot table only shows ""running time"" of its last SQL query",open,"### Describe the bug

Pivot tables fire many queries, but the running time returned through API and shown in the UI is just the runtime of the last query

### To Reproduce

1. Start a postgres
2. Create this SQL question:
```sql
select 1 as a, pg_sleep(1) union all
select 2 as a, pg_sleep(0)
```
It will always take 1 second and respond this:

<img width=""187"" height=""112"" alt=""Image"" src=""https://github.com/user-attachments/assets/d070aec6-4429-4a4f-beb7-aa8998dfff5c"" />

3. Create a new question on top of the previous, pivot table > group by ""a""
Took 2s, but says 1s on the running time:

<img width=""920"" height=""62"" alt=""Image"" src=""https://github.com/user-attachments/assets/b9b268a6-ed29-44c3-808e-4f60ddb80e4c"" />

<img width=""1710"" height=""543"" alt=""Image"" src=""https://github.com/user-attachments/assets/a4f6f342-79fe-4199-a1e1-56d86b874636"" />

### Expected behavior

Should show the total time

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57.4
```

### Severity

P3

### Additional context

Poking some fun logs in these two functions:

https://github.com/metabase/metabase/blob/30c82bc82fbba995b2ede2946a289d6fb8f904e3/src/metabase/query_processor/middleware/process_userland_query.clj#L122

https://github.com/metabase/metabase/blob/30c82bc82fbba995b2ede2946a289d6fb8f904e3/src/metabase/query_processor/middleware/process_userland_query.clj#L87

I can see it's only adding the running_time to the second one:

<img width=""930"" height=""117"" alt=""Image"" src=""https://github.com/user-attachments/assets/684908f0-2959-4d21-8c33-4989e20448c4"" />

<img width=""208"" height=""57"" alt=""Image"" src=""https://github.com/user-attachments/assets/14e5dff1-f00b-4a0d-b078-e3ff4e040e6e"" />",ghostframe,0,"Type:Bug, Priority:P3, .Team/Querying, Querying/Pivot",https://github.com/metabase/metabase/issues/67364,2025-12-22T13:34:04Z,,negative,bug,medium
3753169197,67359,Clickhouse query errors not shown,open,"### Describe the bug

When executing a SQL query against a Clickhouse database with incorrect syntax, the interface doesn't show a descriptive message about the error. Instead we see:

<img width=""650"" height=""223"" alt=""Image"" src=""https://github.com/user-attachments/assets/82cd022c-00cd-4c30-829d-e7738818db24"" />

### To Reproduce

Assuming a Clickhouse connection with a table named mytable

1. Go to 'New' -> 'SQL Query'
2. Enter ""select * fromd mytable limit 5""
3. Run the query
4. See error


### Expected behavior

Ideally, the error message would contain the errro information from Clickhouse which points out the typo in the 'from' section of the query 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""clickhouse""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-10-29"",
      ""tag"": ""v0.56.12"",
      ""hash"": ""eb56003""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.1""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.8+9-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.8"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.8+9-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.12.55-74.119.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""US/Pacific""
  }
}
```

### Severity

it's annoying, but also makes it hard/impossible for non-technical users to use metabase

### Additional context

_No response_",mvanderkroon,0,"Type:Bug, Priority:P2, .Team/Querying, Database/Clickhouse",https://github.com/metabase/metabase/issues/67359,2025-12-22T10:08:30Z,,negative,bug,medium
3752992971,67357,Dark mode - honor user theme preference on the login screen (post sign-out),open,"**Is your feature request related to a problem? Please describe.**
The login screen shown after signing out currently does not honor the userâ€™s configured theme preference. Instead, it falls back to the browser/OS dark-mode preference, which creates an unexpected, inconsistent experience after the user logs out.

**Describe the solution you'd like**
When a user signs out, the app should continue to display the login screen using the last known user-selected Theme preference (e.g., â€œLightâ€) rather than reverting to browser/OS preference (â€œDarkâ€).

**Describe alternatives you've considered**
I believe previously local storage was also used for the setting, that would have solved this, but this no longer seems to be the case.

Being able to globally set a specific theme for Metabase might help ensuring a consistent theme experience.
We already have a FR https://github.com/metabase/metabase/issues/66341  for that.

**How important is this feature to you?**
Customer request",zbodi74,0,"Type:New Feature, Administration/Settings, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67357,2025-12-22T09:23:08Z,,neutral,feature_request,medium
3752944015,67356,After 57 upgrade instance OOM increased in frequency (for a specific cloud instance),open,"### Describe the bug

There is more context here for the [instance in question](https://tools.metabase.com/instances/16f36951-5b35-4b89-ab07-9218b8f5d9e9)

https://metaboat.slack.com/archives/C05MPF0TM3L/p1766161042367689

There was always a restart here and there but after the 18th (the 57 upgrade) the frequency increased a lot:

<img width=""575"" height=""313"" alt=""Image"" src=""https://github.com/user-attachments/assets/87216416-5e48-4c18-a74e-7c17b7347f36"" />

### To Reproduce

None right now


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.57
```

### Severity

instance keeps restarting

### Additional context

_No response_",Tony-metabase,0,"Type:Bug, Priority:P1, .Performance, Querying/MBQL, Querying/, .Team/Querying, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/67356,2025-12-22T09:12:08Z,,negative,bug,high
3751458606,67341,Feature Request: Export & Copy Options in Record Detail View,open,"**Is your feature request related to a problem? Please describe.**
When viewing a record in the **detail view**, there is currently no reliable way to copy all the displayed data.
Using *Select All* (Cmd/Ctrl + A) does not select every field (especially structured or embedded content like JSON blocks), making it frustrating and error-prone to reuse the data elsewhere.

This becomes a real limitation when working with analytics, debugging, documentation, or passing full records to external tools (e.g. Large Language Models).

<img width=""1897"" height=""993"" alt=""Image"" src=""https://github.com/user-attachments/assets/9c904c13-2e74-4ec2-9f76-574d8f1b764d"" />

---

**Describe the solution you'd like**
Add explicit actions in the record detail view, such as:

* **Copy all (plain text)**
* **Copy as JSON**
* **Export as JSON**
* **Export as CSV**

These buttons should capture **all visible fields and values**, including nested or structured content, exactly as shown in the UI.

---

**Describe alternatives you've considered**

* Manually selecting fields one by one
* Switching to SQL queries just to export a single record
* Using browser dev tools or APIs to reconstruct the data

All of these are slow, unintuitive, and break the otherwise excellent UX Metabase provides.

---

**How important is this feature to you?**
**High.**
This would significantly improve daily workflows for analysts, engineers, and anyone working with structured data or AI tools.

---

**Additional context**
Modern workflows increasingly involve copying structured data to tools like LLMs, documentation systems, or external pipelines.
Having first-class **copy/export controls at the record level** would make Metabase much more efficient and future-proof.",robertocommit,0,"Type:New Feature, Visualization/Download, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67341,2025-12-21T18:33:19Z,,positive,feature_request,high
3751137254,67340,Filter by clicking on the titles of the columns on dashboards,open,"**Is your feature request related to a problem? Please describe.**
Users need to keep filtering on table cards on dashboards by clicking on the title column, as they can't add, for example, 15 filters for a table that has 15 columns

**Describe the solution you'd like**
Make the table card in dashboards filterable by clicking on their column

**Describe alternatives you've considered**
None

**How important is this feature to you?**
Requested by a customer as their customers are demanding it

**Additional context**
NA
",dragonsahead,0,"Reporting/Dashboards, Type:New Feature, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67340,2025-12-21T13:17:51Z,,positive,feature_request,high
3750501502,67338,Remapping no longer shows remapped values (only on filters),closed,"### Describe the bug

If you enable remapping we'll no longer show the remapped values on the table, but rather only on the filters

### To Reproduce

1) go to settings->table metadata->feedback table->Rating column
2) change ""display values"" to custom mapping
3) add anything to the values, doesn't matter
4) now go to the feedback table and see the rating column, the remapping is not there...
5) filtering on the column does show the remapped values

### Expected behavior

We should show the remapped values on the table as well?

### Logs

NA

### Information about your Metabase installation

```JSON
57.7
```

### Severity

P2

### Additional context

we got an enterprise customer coming from an older version saying that we supported this before",dragonsahead,7,"Type:Bug, Priority:P2, Administration/Table Metadata, .Team/Querying, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/67338,2025-12-20T22:57:03Z,2025-12-23T16:31:43Z,negative,bug,medium
3749296977,67336,Ability for users to save pre-set filters that can be applied across dashboards,open,"**Is your feature request related to a problem? Please describe.**
If a user likes to have many different dashboard filter configurations specific to that user, it would be cool if you could favorite sets of filter selections so that you don't have to manually re-apply them. 

For example, you could be an account manager for 10 customers, and you typically like to look at customer 1's data for the past 30 days and customer 2's data for the past 90 days. When looking at a dashboard, you'll have to toggle both filters each time you want to view customer 1 vs customer 2's data in the specific way that you'd like. It'd be much easier if you could just select pre-set filters to switch between your customer 1 vs customer 2 view with two clicks.  

**Describe the solution you'd like**
From the words of the customer: 

> having ability to save filter selections, that could be then used across many dashboards, ex. users selects many categories, saves them to favourite filter and can reapply them on the same or different dashboards (that have the same filters available).

**Additional context**
Customer request",jessicaul,0,"Reporting/Dashboards, Type:New Feature, Reporting/Dashboards/Filters & Parameters, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67336,2025-12-20T00:22:40Z,,positive,feature_request,medium
3748980893,67321,Be able to always show the latest numbers on charts,open,"**Is your feature request related to a problem? Please describe.**
A big use case for subscriptions is sending them out to stakeholders and execs who either don't have a Metabase login or don't have the time to navigate to Metabase to view data and reports. In that case, it's really important that the email subscription contains all of the high-level data a stakeholder would need. 

Currently, sometimes charts in subscriptions do not have values for the latest data points, which can hinder understanding of the presented data. 

This is also sometimes true for charts in Metabase dashboards, but the main pain point here is with subscriptions, since the user can't just hover over the bar to get the value.

From the customer

>  It would be great to display just some numbers for reference, but always show the latest 2-3, as they are usually the most important ones

<img width=""933"" height=""699"" alt=""Image"" src=""https://github.com/user-attachments/assets/6e5703f1-f370-4f85-91cc-babf652b0335"" />


**Describe the solution you'd like**
When only showing some of the data points on a chart, be able to always show the latest 2-3 values. The customer would like this in both subscriptions and in Metabase in general. 

**Describe alternatives you've considered**
Always show all values on data points, but this can potentially make the chart feel too busy.

**Additional context**
Customer request
",jessicaul,0,"Type:New Feature, .Team/UXEast, .Auto triaged",https://github.com/metabase/metabase/issues/67321,2025-12-19T21:44:48Z,,neutral,feature_request,medium
3748894467,67309,Be able to customize dashboard email subscription width,open,"**Is your feature request related to a problem? Please describe.**
From the words of a customer

> seems that subscriptions are tailored for mobile use, where content from bigger tables is not visible and needs to be scrolled to the side

<img width=""920"" height=""399"" alt=""Image"" src=""https://github.com/user-attachments/assets/18a4f7dc-f650-4f4f-90bb-d95ffdff0579"" />

Similarly, sometimes dashboards are designed a certain way to have charts side-by-side. When they are collapsed to be one after another in a subscription, that breaks the design of the dashboard and the way that the dashboard creator intended for the data to be consumed.

For example, one customer displays number charts in a 3x2 format on a dashboard, with text card labels on each column and row, creating a pseudo-pivot table to display information more aesthetically for the end user. When that dashboard is sent as a subscription, that layout breaks in the email as the charts and labels come one after another, incomprehensibly. 

> subscriptions are one of the most important parts in my opinion as they allow to deliver required data to stakeholders that have no time to go through Metabase, understand how to do use it or even check through various dashboards, execs expect to just get the data via email

Therefore, it's extra crucial that the information is displayed 1) in an easy-to-read manner and 2) as intended by the dashboard creator. 

**Describe the solution you'd like**
Allow the option to increase the width of dashboards in email subscriptions so that more columns in wide dashboards can be seen, and certain elements of the dashboard are not cut off or jumbled in the email. 
- The latter could maybe be addressed if https://github.com/metabase/metabase/issues/51710 is implemented -- that way the user can customize what is sent and redesign the email content in a way that makes sense.

**Describe alternatives you've considered**
1. Create a simplified version of the dashboard to send via subscriptions. 
2. Don't use subscriptions. Download the dashboard as a PDF and manually (or programmatically) send that out.

**Additional context**
Customer request

Related: https://github.com/metabase/metabase/issues/51710 (my interpretation of that issue is that it's more about the content of the notification, whereas this issue is about how the entire notification is displayed in an email)
",jessicaul,0,"Reporting/Pulses, Type:New Feature, .Team/UXEast, .Auto triaged",https://github.com/metabase/metabase/issues/67309,2025-12-19T21:11:39Z,,negative,feature_request,medium
3748838710,67306,Model info modal has horizontal scrollbar,open,"### Describe the bug

<img width=""787"" height=""596"" alt=""Image"" src=""https://github.com/user-attachments/assets/202a1e2e-d794-46a0-a1c0-beb16e21e6d0"" />

### To Reproduce

1. Create a model on a new instance
2. View it and see the modal

### Expected behavior

Should not have a horizontal scrollbar

### Logs

_No response_

### Information about your Metabase installation

```JSON
dcc3b198cfa on release-x.58.x, repro'ed on Firefox
```

### Severity

P3

### Additional context

_No response_",noahmoss,0,"Type:Bug, Priority:P3, Type:New Feature, Difficulty:Easy, Querying/Models, .Team/Querying",https://github.com/metabase/metabase/issues/67306,2025-12-19T20:52:48Z,,negative,bug,medium
3748593054,67295,Support creating SQL questions using SDK / modular embedding,open,"**Is your feature request related to a problem? Please describe.**
(the closest component to what we want seems to be InteractiveQuestion, which we'll use but we also want to give our users the ability to edit SQL directly

**Describe the solution you'd like**


**Describe alternatives you've considered**
We've started exploring building our own component using the Metabase API, but we'd prefer not to go down that path if there's a suitable alternative or a feature drop is right around the corner.

**How important is this feature to you?**

**Additional context**
Requested by a customer",albertoperdomo,0,"Type:New Feature, .Team/Embedding, Embedding/SDK, Embedding/EmbedJS",https://github.com/metabase/metabase/issues/67295,2025-12-19T19:30:02Z,,neutral,feature_request,medium
3748386736,67293,Row total disappear when Pivot table is added to a Dashboard,open,"### Describe the bug

Row totals fail to render in a Pivot table at dashboard level sometimes, but work well when they the pivot is at card level. This happened after upgrading from 56 to 57

Internal thread with Query responses and more context [here](https://metaboat.slack.com/archives/C05MPF0TM3L/p1766166091138289)

### To Reproduce

No deterministic repro steps, unfortunately, but it was reported by a customer [here](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=e856f6bf-02ca-4f18-9fc8-e36e1c3c0426) 


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
-v1.57.7
```

### Severity

p2

### Additional context

_No response_",ignacio-mb,1,"Type:Bug, Priority:P2, .Regression, Visualization/Pivot, .Team/UXWest",https://github.com/metabase/metabase/issues/67293,2025-12-19T18:20:14Z,,negative,bug,medium
3747752919,67275,Sync Fails with Duplicate Key Constraint,open,"### Describe the bug

A table synced into Metabase with no fields. When you try to force a resync you're met with the error:

```
ERROR: duplicate key value violates unique constraint ""idx_unique_field""
  Detail: Key (name, table_id, unique_field_helper)=(desired_daily_rate (cf), 35934, 0) already exists.
```

### To Reproduce

No repro yet. Unsure if it's relevant but looks to be a Redshift DB. Context:
https://metaboat.slack.com/archives/C05MPF0TM3L/p1766152259975039

### Expected behavior

Sync should work

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57.7.4
```

### Severity

blocking use of table 

### Additional context

_No response_",ixipixi,0,"Type:Bug, Priority:P1, Administration/Metadata & Sync, .Backend, .Team/Querying, .Auto triaged",https://github.com/metabase/metabase/issues/67275,2025-12-19T14:39:49Z,,negative,bug,high
3747193535,67261,[Epic] Title,closed,"### Links

- [product doc](LINK_TO_PRODUCT_DOC)
- [technical design doc](LINK_TO_TECHNICAL_DESIGN_DOC)
- [testing plan](LINK_TO_TESTING_PLAN)
- feature branch: `BRANCH_NAME`
- issue links: _related issues, if any_

### Implementation Plan

```[tasklist]
#### Milestone 1
- [ ] _Add tasks here_
```
",ryu0406nkmrykey-bit,0,.Epic,https://github.com/metabase/metabase/issues/67261,2025-12-19T11:33:55Z,2025-12-19T11:34:16Z,neutral,feature_request,medium
3745144590,67228,"""Break out"" drillthrough fails on questions with group by implicitly joined column and filter after aggregation",open,"### Describe the bug

A lot of things need to happen to see this one, but bad news is that those things happen in our Examples dashboard, so we have broken drillthrough in Examples again:

If you have a question with:
- A summary by an implicitly joined column (like Product -> Category on the orders table)
- A filter after summary

then ""break out by"" drill-through will fail. **This is a regression: it works in v56 but not in v57+**
 
If the summary by a column in the same table, or there's no filter after summary, then everything's fine.

The error on h2 sample DB is:
```
Column ""source.PRODUCTS__via__PRODUCT_ID__CATEGORY"" not found; SQL statement:
-- Metabase:: userID: 3 queryType: MBQL queryHash: 934fb7fd8cb15f200c2eb9e94a1d21ba8052583408f80f43a40af03592fe123e
SELECT ""source"".""PRODUCTS__via__PRODUCT_ID__CATEGORY"" AS ""PRODUCTS__via__PRODUCT_ID__CATEGORY"", ""source"".""PEOPLE__via__USER_ID__SOURCE"" AS ""PEOPLE__via__USER_ID__SOURCE"", ""source"".""count"" AS ""count"" FROM (SELECT ""PRODUCTS__via__PRODUCT_ID"".""CATEGORY"" AS ""PRODUCTS__via__PRODUCT_ID__CATEGORY"", ""PEOPLE__via__USER_ID"".""SOURCE"" AS ""PEOPLE__via__USER_ID__SOURCE"", COUNT(*) AS ""count"" FROM ""PUBLIC"".""ORDERS"" LEFT JOIN ""PUBLIC"".""PRODUCTS"" AS ""PRODUCTS__via__PRODUCT_ID"" ON ""PUBLIC"".""ORDERS"".""PRODUCT_ID"" = ""PRODUCTS__via__PRODUCT_ID"".""ID"" LEFT JOIN ""PUBLIC"".""PEOPLE"" AS ""PEOPLE__via__USER_ID"" ON ""PUBLIC"".""ORDERS"".""USER_ID"" = ""PEOPLE__via__USER_ID"".""ID"" WHERE ""source"".""PRODUCTS__via__PRODUCT_ID__CATEGORY"" = ? GROUP BY ""PRODUCTS__via__PRODUCT_ID"".""CATEGORY"", ""PEOPLE__via__USER_ID"".""SOURCE"" ORDER BY ""PRODUCTS__via__PRODUCT_ID"".""CATEGORY"" ASC, ""PEOPLE__via__USER_ID"".""SOURCE"" ASC) AS ""source"" WHERE ""source"".""count"" >= 1 LIMIT 2000 [42122-214]
```

The error on postgres sample DB is:
```
ERROR: missing FROM-clause entry for table ""source""
  Position: 771
```



### To Reproduce

You can observe it on the Examples dashboard on a new instance: go to ""Portfolio performance"" tab and use the ""Product breakdown"" sunburst chart.

<img width=""1276"" height=""1258"" alt=""Image"" src=""https://github.com/user-attachments/assets/7f7da1bb-eaa6-46da-ac95-5abf08286ab5"" />

**To make your own:**
1. Create a GUI question on the sample database: Count of Orders by Product Category, filtered by Count > 1

<img width=""2732"" height=""1326"" alt=""Image"" src=""https://github.com/user-attachments/assets/cbf34b04-06ed-4a2b-9f40-52864048371a"" />

2. Visualize. 
3. Click on any count and select ""Break out by"" in the action menu

<img width=""1046"" height=""842"" alt=""Image"" src=""https://github.com/user-attachments/assets/e369ef3f-ac06-4e44-8669-44debd074113"" />

4. Select Category > User: Source (it actually doesn't matter what you select here)
5. Error

<img width=""2756"" height=""1336"" alt=""Image"" src=""https://github.com/user-attachments/assets/16166e86-2e12-4505-aa16-1519260226c3"" />

Note the new filter on ""Products Via Product ID Category"" added.

Optional: go back to the original question before drill-through, remove the filter Count > 1 filter, repeat the steps -  see that drill-through works.

### Expected behavior

Drill-though works: instead of filter on ""Products Via Product ID Category"", the filter on ""Category "" is added like in v56

<img width=""1638"" height=""920"" alt=""Image"" src=""https://github.com/user-attachments/assets/f58fa0f9-432d-4bcf-9158-014c06dfa874"" />

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57+, master
```

### Severity

P2, it's a regression

### Additional context

_No response_",alexyarosh,0,"Type:Bug, Priority:P1, Querying/Drill Thrus, .Team/Querying, .Auto triaged",https://github.com/metabase/metabase/issues/67228,2025-12-18T22:57:45Z,,negative,bug,high
3744878358,67221,Detect repeated permissions errors and suggest refresh,open,"Let's create a little api middleware that detects if we've gotten N permissions errors in the last M seconds, and show a little toast that suggests you might want to refresh your browser (likely permissions changes, see https://github.com/metabase/metabase/issues/12294).

Should also add a nice long cooldown on it so we don't flood you with toasts

see: https://metaboat.slack.com/archives/C0A1MAKBA2E/p1766092175068059?thread_ts=1766092100.487419&cid=C0A1MAKBA2E",iethree,0,"Type:UX, Priority:P3, Type:New Feature, Administration/Permissions, .Frontend",https://github.com/metabase/metabase/issues/67221,2025-12-18T21:13:51Z,,positive,feature_request,medium
3744773838,67211,Add query hash to Usage Analytics Query log table,open,"**Is your feature request related to a problem? Please describe.**
You might want to map queries in your db to Metabase questions so you can better monitor usage/performance.

**Describe the solution you'd like**
Add Query hash to Query log table

**Describe alternatives you've considered**
For Cloud users, this is a hard thing to do.

**How important is this feature to you?**
Requested by a customer, internal ticket [here](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=d0d3ffe4-23c4-4034-a20d-4091fda90a1b)

**Additional context**
Add any other context or screenshots about the feature request here.
",ignacio-mb,0,"Type:New Feature, Administration/Usage analytics, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67211,2025-12-18T20:40:31Z,,neutral,feature_request,medium
3744720962,67209,Visualization Drop in Embedding Preview overflows the popover,open,"### Describe the bug

The visualization options in the popover in the embedding preview mode extend outside the canvas of the popover 

<img width=""213"" height=""735"" alt=""Image"" src=""https://github.com/user-attachments/assets/b4b17aab-f4de-47b6-ad92-3c356db147d6"" />

### To Reproduce

1. Create a question
2. Save the question
3. Go to sharing -> embed
5. Click the dropdown 
### Expected behavior

The text should scroll or the popover should grow. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-12-09"",
      ""tag"": ""v1.57.1-SNAPSHOT"",
      ""hash"": ""b050245""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

Annoying 

### Additional context

_No response_",edpaget,0,"Type:Bug, Priority:P3, .Frontend, Embedding/Static, .Team/Embedding, .Auto triaged",https://github.com/metabase/metabase/issues/67209,2025-12-18T20:22:42Z,,negative,bug,medium
3743307587,67163,Search box on field selector on GUI queries,closed,"**Is your feature request related to a problem? Please describe.**
There's no way to search for a field in the gui question builder

**Describe the solution you'd like**
A search box right there when the amount of fields are higher than a certain threshold

**Describe alternatives you've considered**
None

**How important is this feature to you?**
If you have hundreds of columns, scrolling through these might be problematic

**Additional context**

<img width=""1419"" height=""1049"" alt=""Image"" src=""https://github.com/user-attachments/assets/1adbaeec-f8e1-42e2-958c-7f77baf0da6c"" />
",dragonsahead,1,"Querying/MBQL, Type:New Feature, Querying/GUI, Querying/Notebook, .Team/Querying, .Auto triaged",https://github.com/metabase/metabase/issues/67163,2025-12-18T14:06:37Z,2025-12-18T22:28:01Z,neutral,feature_request,medium
3743244884,67160,Issues selecting text in 0.57,open,"57 Release makes it difficult to copy text from table cells. 

Examples:
1. Try to select a value from a cell.
2. Selecting SQL query from a question editor. It was previously possible to use Cmd+A to select the whole snippet, or double-click or triple-click to select the full snippet. Now you have to drag a cursor to select the text",timuric,1,"Type:Bug, Priority:P2, .Frontend, .Regression, .Team/UXWest",https://github.com/metabase/metabase/issues/67160,2025-12-18T13:48:46Z,,negative,bug,medium
3740856666,67143,SQL preview panel shouldn't automatically disappear when I'm resizing my viewport,closed,"### Describe the bug

We don't do this with other sidebars/panels in the product, and this behavior feels undesirable and unpredictable. It also means that if your viewport is narrower than 1270px or so, the View SQL button appears to do nothing.

https://www.loom.com/share/9f92a623d5b04b75bee79e3d18bb61ac

### To Reproduce

1. Create a new GUI question
2. Open the ""View the SQL"" side panel
3. Make your viewport narrower and see how the panel disappears unexpectedly
4. Mash on the View SQL button fruitlessly 


### Expected behavior

It should just stay open until I actively close it.

### Logs

_No response_

### Information about your Metabase installation

```JSON
On our Stats instance.
```

### Severity

P3

### Additional context

_No response_",mazameli,0,"Type:Bug, Priority:P3, Querying/Native, .Frontend, .Team/Querying, .Auto triaged",https://github.com/metabase/metabase/issues/67143,2025-12-17T23:46:20Z,2025-12-18T12:09:04Z,negative,bug,medium
3740711225,67137,Allow wider dashboard layouts,open,"**Is your feature request related to a problem? Please describe.**
When you have a dashboard with multiple wide tables or pivot tables (such as with time series data), it would be nice if the dashboard layout were wider and you could scroll left and right. 
That way, you only need to scroll once to see the latest data for multiple tables, rather than needing to scroll to the right of each individual table and line up the time series. Ideally, the whole dashboard page would be scrollable horizontally, not just vertically.

Another use case for this is when you ""want to place two tables side by side for comparison, but the dashboard's width is too limited to accommodate this layout effectively."" (quote from the customer)


**Describe the solution you'd like**
Allow dashboard layouts to not be restricted to (24 x n) tiles, such that wider dashboard layouts are possible. Also, allow scrolling horizontally if the dashboard is wider.

**Describe alternatives you've considered**
The ""Full-width"" setting for a dashboard does help to some extent, but not in all cases, according to the customer. 

**Additional context**
Customer request

Related https://github.com/metabase/metabase/issues/66489
",jessicaul,0,"Reporting/Dashboards, Type:New Feature, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67137,2025-12-17T22:22:17Z,,neutral,feature_request,medium
3740441280,67128,Internal remapping triggers externally remapped columns to appear via models,open,"### Describe the bug

When remapping field values using custom values (internal remapping), there are unexpected columns returned for models.

### To Reproduce

1. Table metadata -> Orders -> Quantity -> Display values -> Custom mapping -> Enter A, B, C etc
2. Models -> New -> Orders -> Save as M1
3. New -> Question -> M1 -> Count
4. Open the column picker for breakouts. See there are unexpected columns (Product -> Title, User -> Name)

<img width=""1287"" height=""733"" alt=""Image"" src=""https://github.com/user-attachments/assets/8512f626-6d62-4c38-96af-df4eeb09b9f9"" />

### Expected behavior

There should be no such columns in this case as in v56

### Logs

_No response_

### Information about your Metabase installation

```JSON
master `9a96a65abf8ead0364bc7dc356b0b5baf951b27c`
```

### Severity

P1

### Additional context

_No response_",ranquild,2,"Type:Bug, Priority:P1, Querying/MBQL, .Backend, .Team/Querying, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/67128,2025-12-17T20:56:39Z,,negative,bug,high
3739917960,67110,Tooltips break on row charts when using two columns on Y axis but leaving one out,open,"### Describe the bug

Tooltip stops working and shows a console error when a row chart is grouped a certain way over specific data

### To Reproduce

1. Create a SQL question against the sample DB, with some mock data:
```sql
select 'Production' as stage, 'App1' as application, 'Finished' as status, 2000000 as x 
union
(select 'Development', 'App2', 'Finished', 2000000)
```

2. Configure a row chart this way

<img width=""384"" height=""469"" alt=""Image"" src=""https://github.com/user-attachments/assets/df9b9280-4c01-49b7-8cac-a1f5d5d251df"" />

3. Hover on the top row, works

<img width=""1304"" height=""426"" alt=""Image"" src=""https://github.com/user-attachments/assets/c59e45bd-4ffd-4eac-a29b-1dd16659c348"" />

4. Hover on the bottom row, now there's no tooltip and an error is printed in the console

<img width=""1702"" height=""402"" alt=""Image"" src=""https://github.com/user-attachments/assets/15114950-b8b6-4186-ad1d-6a4fd69449a0"" />

If you remove the column ""status"" from the query, it works ðŸ˜µâ€ðŸ’«

### Expected behavior

It should show the tooltip

### Logs

```

ï»¿
6
react-dom.production.min.js:106 Uncaught TypeError: Cannot read properties of undefined (reading '2')
    at events.ts:78:43
    at Array.map (<anonymous>)
    at sH (events.ts:65:6)
    at events.ts:314:18
    at onHover (events.ts:339:1)
    at onMouseEnter (RowChartView.tsx:193:44)
    at Object.eN (react-dom.production.min.js:54:317)
    at e$ (react-dom.production.min.js:54:471)
    at react-dom.production.min.js:55:35
    at rt (react-dom.production.min.js:55:136)
```

### Information about your Metabase installation

```JSON
57.7.1
```

### Severity

P2

### Additional context

Workarounds are to either set the rows to stack, or removing the extra column that isn't part of the breakouts (or if this is a GUI version that groups by 3 things but there are two breakouts, not including the grouping that *isn't a breakout*)",ghostframe,0,"Type:Bug, Priority:P2, Visualization/, Difficulty:Easy, .Frontend, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67110,2025-12-17T18:06:44Z,,negative,bug,high
3739171781,67087,Color range on table crashes it if values span a large scale,open,"### Describe the bug

If you use a color range conditional formatting that **has white on one end**, and the values have **different orders of magnitude** and there's values too close together on the **white end**, it crashes the table

### To Reproduce

1. Start a SQL question with this on the Sample DB
```sql
select 0 as a union 
select 1 union
select 1000000
```
2. Set this conditional formatting, white -> any color and see error

<img width=""1136"" height=""677"" alt=""Image"" src=""https://github.com/user-attachments/assets/4efd3eac-30f4-476b-9d26-68eebb9877eb"" />

### Expected behavior

Should not crash the table

### Logs

```
console.js:13 Error: Unable to parse color from string: rgba(136, 191, 77, 7.5e-7)
    at new l (index.js:49:14)
    at l (index.js:24:10)
    at g (palette.ts:121:10)
    at BaseCell.tsx:45:25
    at Object.useMemo (react-dom.production.min.js:184:189)
    at t.useMemo (react.production.min.js:25:208)
    at BaseCell.tsx:28:21
    at iA (react-dom.production.min.js:167:137)
    at ag (react-dom.production.min.js:197:258)
    at ah (react-dom.production.min.js:195:204)
```

### Information about your Metabase installation

```JSON
v57.7.1
```

### Severity

P2

### Additional context

_No response_",ghostframe,2,"Type:Bug, Priority:P2, Visualization/, Visualization/Tables, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67087,2025-12-17T14:36:36Z,,negative,bug,high
3738852079,67080,Native Auto-refresh support for EmbedJS,open,"**Is your feature request related to a problem? Please describe.**
Customers might want to refresh data in embedded dashboards to customers 

**Describe the solution you'd like**
The current auto refresh feature that exists for dashboards but for Embedded Analytics JS

**Describe alternatives you've considered**
It's really easy to make this possible with some JS functions, but when embedding a dashboard you will be refreshing the whole embedded iframe and not each chart silently and in a subtle way as the auto-refresh feature currently does

**How important is this feature to you?**
Requested by a customer, internal ticket [here](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=44ee602d-319f-4871-94dc-e087a097d1de)

**Additional context**
N/A
",ignacio-mb,0,"Type:New Feature, .Team/Embedding, Embedding/EmbedJS, .Auto triaged",https://github.com/metabase/metabase/issues/67080,2025-12-17T13:11:31Z,,neutral,feature_request,medium
3738839427,67079,Row Chart Drilldowns on empty values return no results.,open,"### Describe the bug

When you Drilldown on empty values inside a Row Chart the filter uses `is (empty)` instead of `is empty` like it does on bar charts:

<img width=""1333"" height=""695"" alt=""Image"" src=""https://github.com/user-attachments/assets/0e4378b9-1f73-420e-a4a3-5171e6ba33af"" />

### To Reproduce

1. Go to New -> Question -> Analytics Events -> Count and group by Button Label and timestamp Quarter

<img width=""1343"" height=""324"" alt=""Image"" src=""https://github.com/user-attachments/assets/83d2e510-b7d5-4981-bdb4-1ed5eb67cdd1"" />

2. Plot as a stacked barchart:

<img width=""1712"" height=""690"" alt=""Image"" src=""https://github.com/user-attachments/assets/d2d1dba3-28b6-416a-b298-d348bed3c9a6"" />

3. On the empty stack click on it and click See these analytics events -> Nothing shows up filter uses is `(empty)`:

<img width=""1728"" height=""559"" alt=""Image"" src=""https://github.com/user-attachments/assets/e38a5786-b23b-4586-85df-a5cb62377ba5"" />

If you do the same on a bar chart the filter works cause it uses `is empty` :

<img width=""788"" height=""109"" alt=""Image"" src=""https://github.com/user-attachments/assets/79e1bb57-4050-4ef4-97d9-f331101e84f2"" />


BONUS issue if you remove the Timestamp group by so it's not a stack anymore the row chart shows empty as null:

<img width=""1714"" height=""803"" alt=""Image"" src=""https://github.com/user-attachments/assets/7c348654-f7ec-418e-8e66-01a269c8fbd4"" />

and if you drill through the null you get the same issue

<img width=""1539"" height=""578"" alt=""Image"" src=""https://github.com/user-attachments/assets/c9f1358f-dd58-4b86-9f40-6d4cab769b00"" />

### Expected behavior

Drill through works 

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
1.57 and master
```

### Severity

Annoying 

### Additional context

I created a question on stats so it's faster to replicate. Just drill down on the empty tag:

https://stats.metabase.com/question/32939-row-chart-failing-drill-down",Tony-metabase,0,"Type:Bug, Priority:P2, Difficulty:Easy, .Backend, Querying/Drill Thrus, .Team/Querying",https://github.com/metabase/metabase/issues/67079,2025-12-17T13:08:00Z,,negative,bug,medium
3738260480,67075,Filtering for a backslash on a Text field with contains doesn't show results,open,"### Describe the bug

Filtering for a backslash on a Text field with the contains option doesn't show results

### To Reproduce

You need to create some sample data that has a `\` value ... For example:

```
Create VIEW my_view AS 
(Select 'This/is' AS col
       UNION
Select 'This\is' AS col)
```

1. Go to New Question -> Select my_view -> Filter col is ""This\is"" and notice it loads

<img width=""912"" height=""441"" alt=""Image"" src=""https://github.com/user-attachments/assets/f61b9924-6290-4852-ba9f-883537ec1782"" />

2. Now change the `is` to `contains` and notice nothing loads:

<img width=""872"" height=""450"" alt=""Image"" src=""https://github.com/user-attachments/assets/5145ef4c-8d0a-486b-9509-43baa424ae90"" />

3. Same for filtering with contains `\`:

<img width=""872"" height=""469"" alt=""Image"" src=""https://github.com/user-attachments/assets/56b4dfff-bd80-459e-9cb9-30428f73ae8e"" />

4. It works if you pass double backslash `\\`

<img width=""876"" height=""436"" alt=""Image"" src=""https://github.com/user-attachments/assets/4d007546-edf3-4167-bff4-215714bc30cc"" />

Note it works for any forward slash combination `/`

### Expected behavior

Able to filter for a backward slash in a contains filter

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
1.57 but also happens on 1.56 - I think we always had this issue
```

### Severity

Not a big issue cause there is a workaround and I doubt many people have text filtering needs for backward slash

### Additional context

It works if you pass double backslash `\\`",Tony-metabase,1,"Type:Bug, Priority:P2, Querying/Parameters & Variables, Difficulty:Easy, .Backend, .Team/Querying, .Has Repro Steps, .Auto triaged, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/67075,2025-12-17T10:20:56Z,,neutral,bug,medium
3738030466,67067,Notifications debugging improvement,open,"**Is your feature request related to a problem? Please describe.**
We've done a lot, but this hasn't improved to a point that the user can help themselves without us. There are many issues open here for reference about what has been created in the past but it's not enough:
https://github.com/metabase/metabase/issues/34519
https://github.com/metabase/metabase/issues/47995
https://github.com/metabase/metabase/issues/51701

**Describe the solution you'd like**
A place in the logs exclusively to see notifications with:
- subscription/alert
- recipient
- time it took
- was it sent
- log lines about that if there was any error
- task that was used for this (the id of the task and the run)

**Describe alternatives you've considered**
None

**How important is this feature to you?**
Important since we're getting a ton of emails about subscriptions not arriving or not working anymore, and we're blind

**Additional context**
NA
",dragonsahead,0,"Type:New Feature, Operation/Logging, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67067,2025-12-17T09:14:52Z,,negative,feature_request,high
3737785374,67065,Metabase Upgrade Failure from 0.49 to 0.56.15 || Migrations are Failing,closed,"We are upgrading Metabase from 0.49 to 0.56.15, facing Migration Issues
Deployed using docker image via Kubernetes

metabase-clone-db=> SHOW statement_timeout;
 statement_timeout 
-------------------
 0

metabase-clone-db=> SHOW idle_in_transaction_session_timeout;
 idle_in_transaction_session_timeout 
-------------------------------------
 0

~$ kubectl top pod -n <namespace> <pod-name>
NAME                              CPU(cores)   MEMORY(bytes)   
<pod_name>                          4m           861Mi

SELECT 
  (SELECT COUNT(*) FROM report_dashboard) as dashboards,
  (SELECT COUNT(*) FROM report_card) as questions,
  (SELECT COUNT(*) FROM collection) as collections,
  (SELECT COUNT(*) FROM core_user) as users,
  (SELECT COUNT(*) FROM report_dashboard WHERE enable_embedding = true) as embedded_dashboards;
 dashboards | questions | collections | users | embedded_dashboards 
------------+-----------+-------------+-------+---------------------
       1471 |      8373 |        1386 |   706 |                 292

metabase-clone-db=> SELECT * FROM databasechangeloglock;
 id | locked | lockgranted | lockedby 
----+--------+-------------+----------
  1 | f      |             | 

metabase-clone-db=> select * FROM permissions WHERE object LIKE '/application/%' OR object LIKE '/collection/namespace/%';
  id  |           object           | group_id | perm_value | perm_type | collection_id 
------+----------------------------+----------+------------+-----------+---------------
 3532 | /application/subscription/ |        1 |            |           |    

SELECT * FROM databasechangelog WHERE exectype != 'EXECUTED'  limit 2;
id  | author  |               filename                |        dateexecuted        | orderexecuted | exectype |               md5sum               | description |   comments   | tag | liquibase | contexts | labels | deployment_id 
-----+---------+---------------------------------------+----------------------------+---------------+----------+------------------------------------+-------------+--------------+-----+-----------+----------+--------+---------------
 119 | camsaul | migrations/000_legacy_migrations.yaml | 2020-08-06 19:37:36.981336 |           115 | MARK_RAN | 8:195cf171ac1d5531e455baf44d9d6561 | sql         | Added 0.34.2 |     | 3.6.3     |          |        | 6722854362
 160 | camsaul | migrations/000_legacy_migrations.yaml | 2020-08-06 19:37:37.11137  |           156 | MARK_RAN | 8:1441c71af662abb809cba3b3b360ce81 | sql         | Added 0.34.2 |     | 3.6.3     |          |        | 6722854362


metabase-clone-db=> SELECT * FROM databasechangelog 
WHERE id LIKE '%view%count%' 
   OR id = 'v50.2024-04-25T16:29:32';
 id | author | filename | dateexecuted | orderexecuted | exectype | md5sum | description | comments | tag | liquibase | contexts | labels | deployment_id 
----+--------+----------+--------------+---------------+----------+--------+-------------+----------+-----+-----------+----------+--------+---------------

metabase-clone-db=> SELECT 
  COUNT(*) as total_cards,
  COUNT(view_count) as cards_with_view_count,
  MAX(view_count) as max_views
FROM report_card;
 total_cards | cards_with_view_count | max_views 
-------------+-----------------------+-----------
        8373 |                  8373 |         0

metabase-clone-db=> SELECT id, dateexecuted, exectype, description
FROM databasechangelog 
WHERE dateexecuted > '2025-12-16'
ORDER BY orderexecuted DESC 
LIMIT 20;
           id            |        dateexecuted        | exectype |                                       description                                        
-------------------------+----------------------------+----------+------------------------------------------------------------------------------------------
 v50.2024-04-25T16:29:31 | 2025-12-16 10:49:09.307685 | EXECUTED | addColumn tableName=report_card
 v50.2024-04-25T03:15:02 | 2025-12-16 10:49:09.299983 | EXECUTED | addColumn tableName=permissions_group
 v50.2024-04-25T03:15:01 | 2025-12-16 10:49:09.287129 | EXECUTED | addColumn tableName=core_user
 v50.2024-04-25T01:04:07 | 2025-12-16 10:49:09.268389 | EXECUTED | customChange
 v50.2024-04-25T01:04:06 | 2025-12-16 10:49:09.261826 | EXECUTED | customChange
 v50.2024-04-25T01:04:05 | 2025-12-16 10:49:09.254468 | EXECUTED | customChange
 v50.2024-04-19T17:04:04 | 2025-12-16 10:49:09.134644 | EXECUTED | sql
 v50.2024-04-15T16:30:35 | 2025-12-16 10:49:09.122894 | EXECUTED | addColumn tableName=report_card
 v50.2024-04-09T15:55:19 | 2025-12-16 10:49:09.11504  | EXECUTED | addColumn tableName=collection
 v50.2024-03-29T10:00:00 | 2025-12-16 10:49:09.107881 | EXECUTED | addColumn tableName=report_card
 v50.2024-03-28T16:30:35 | 2025-12-16 10:49:09.100721 | EXECUTED | customChange
 v50.2024-03-25T14:53:00 | 2025-12-16 10:49:08.960762 | EXECUTED | addColumn tableName=query_field
 v50.2024-03-24T19:34:11 | 2025-12-16 10:49:08.950676 | EXECUTED | sql
 v50.2024-03-22T00:39:28 | 2025-12-16 10:49:08.922222 | EXECUTED | createIndex indexName=idx_field_usage_field_id, tableName=field_usage
 v50.2024-03-22T00:38:28 | 2025-12-16 10:49:08.91196  | EXECUTED | createTable tableName=field_usage
 v50.2024-03-21T17:41:00 | 2025-12-16 10:49:08.889908 | EXECUTED | addColumn tableName=metabase_table
 v50.2024-03-18T16:00:01 | 2025-12-16 10:49:08.881131 | EXECUTED | addUniqueConstraint constraintName=idx_cache_config_unique_model, tableName=cache_config
 v50.2024-03-18T16:00:00 | 2025-12-16 10:49:08.869095 | EXECUTED | createTable tableName=cache_config
 v50.2024-03-12T17:16:38 | 2025-12-16 10:49:08.838433 | EXECUTED | dropTable tableName=activity
 v50.2024-02-29T15:08:43 | 2025-12-16 10:49:08.816209 | EXECUTED | createIndex indexName=idx_query_field_field_id, tableName=query_field

metabase-clone-db=> EXPLAIN ANALYZE
SELECT c.id, COUNT(*)
FROM report_card c
LEFT JOIN view_log v ON v.model = 'card' AND v.model_id = c.id
GROUP BY c.id
LIMIT 100;
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=0.72..366588.74 rows=100 width=12) (actual time=13.071..12929.520 rows=100 loops=1)
   ->  GroupAggregate  (cost=0.72..30694415.83 rows=8373 width=12) (actual time=13.070..12929.458 rows=100 loops=1)
         Group Key: c.id
         ->  Merge Left Join  (cost=0.72..30573086.33 rows=24249155 width=4) (actual time=1.123..12924.726 rows=23319 loops=1)
               Merge Cond: (c.id = v.model_id)
               ->  Index Only Scan using report_card_pkey on report_card c  (cost=0.29..321.88 rows=8373 width=4) (actual time=0.007..0.142 rows=101 loops=1)
                     Heap Fetches: 4
               ->  Index Scan using idx_view_log_model_id on view_log v  (cost=0.44..30269629.08 rows=24249155 width=4) (actual time=0.573..12918.858 rows=23359 loops=1)
                     Filter: ((model)::text = 'card'::text)
                     Rows Removed by Filter: 300340
 Planning Time: 9.489 ms
 Execution Time: 12929.712 ms
(12 rows)

metabase-clone-db=> SELECT COUNT(*) FROM view_log WHERE model = 'card';
  count   
----------
 24209123


[metabase_logs.txt](https://github.com/user-attachments/files/24207380/metabase_logs.txt)",jayjain123,8,,https://github.com/metabase/metabase/issues/67065,2025-12-17T07:57:47Z,2025-12-17T09:33:55Z,negative,bug,high
3736515603,67054,Be able to use conditional formatting on enum columns,open,"**Is your feature request related to a problem? Please describe.**
As of right now, conditional formatting in tables only works on number and text columns. If I'm using Postgres, for example, and have a data column that is an enum data type, then I cannot select that column for conditional formatting.

**Describe the solution you'd like**
Be able to select columns that have the enum data type for conditional formatting. 

**Describe alternatives you've considered**
Casting those enum columns to text, whether that be on the database level, using a SQL query, or creating a custom column. 

**Additional context**
Customer request ",jessicaul,0,"Visualization/, Type:New Feature, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67054,2025-12-16T22:12:44Z,,neutral,feature_request,medium
3736043478,67040,Ability to Customize options in Filter widgets,open,"**Is your feature request related to a problem? Please describe.**
In the customer's words:

> this UX is strange and causes unnecessary friction. the main filter use cases are today, yesterday, this week, this month, and he would like the ability to put these at the very top to minimize the number of clicks

<img width=""384"" height=""595"" alt=""Image"" src=""https://github.com/user-attachments/assets/bb9b7c9b-33ce-4662-baab-54a598d33569"" />


**Describe the solution you'd like**
Ability to customize the options you give in the filter widget to users with different skills.

> Is there a way to customize how the date widget displays the options? To do current week or current month I would have to click relative date range -> current -> current week/month. I'd like to just surface these at the top of the dropdown so it's Today, yesterday, current week, current month

and

> would be nice if there is a way to customize the widget so what the user uses the most is surfaced at the top




**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket [here](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=86a740d2-2b3e-47d7-bc4b-f73cb8402bc2)

**Additional context**
Weird that this hasn't been requested in the past - couldn't find an existing open fr for this
",ignacio-mb,0,"Reporting/Dashboards, Type:New Feature, Reporting/Dashboards/Filters & Parameters, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/67040,2025-12-16T19:26:25Z,,negative,feature_request,medium
3735973709,67035,Reactivate table without creating a new one after 14 days,open,"**Is your feature request related to a problem? Please describe.**
After https://github.com/metabase/metabase/pull/61592, if a table was archived after 14 days and the table comes up again, we will create a new one. If the user had created questions and dashboards they'll have to do that again

**Describe the solution you'd like**
If this setting is enabled, we should look for the archived tables and restore it with the old name/id

**Describe alternatives you've considered**
None

**How important is this feature to you?**
A customer lost all the questions and dashboards that were created with an old table that dissapeared for 30 days

**Additional context**
Created https://github.com/metabase/metabase/issues/67032 before, but with this issue it should be enough",dragonsahead,1,"Type:New Feature, Querying/Models, .Team/Querying, Semantic Layer/Models, .Auto triaged, Querying/Models/Persistence",https://github.com/metabase/metabase/issues/67035,2025-12-16T18:59:48Z,,negative,feature_request,high
3735928416,67032,Make archiving period of the tables configurable,open,"**Is your feature request related to a problem? Please describe.**
In https://github.com/metabase/metabase/pull/61592 we made the tables to be archived in 14 days, but we need to do this configurable, as people might have other ""archiving"" policies

**Describe the solution you'd like**
Make the archiving period configurable (env var?)

**Describe alternatives you've considered**
None actually

**How important is this feature to you?**
This might make the users to recreate entire questions and dashboards that fail due to auto archiving of tables

**Additional context**
NA
",dragonsahead,0,"Administration/Metadata & Sync, Type:New Feature, .Team/Querying, Semantic Layer/Sync, .Auto triaged",https://github.com/metabase/metabase/issues/67032,2025-12-16T18:42:01Z,,neutral,feature_request,high
3735491591,67027,Some custom expressions vanish when upgrade from 56 to 57,closed,"### Describe the bug

Custom expressions don't get migrated to 57 and vanish from card

### To Reproduce

Run version 56 first

Go to New -> Question -> Orders -> Custom Expression -> Save

```
concat(
  text(floor(Average([Tax]) / 60)),
  "":"",
  substring(
    concat(
      ""0"",
      text(
        floor(
          Average([Tax]) -
            floor(Average([Tax]) / 60) * 60
        )
      )
    ),
    1 +
      length(
        concat(
          ""0"",
          text(
            floor(
              Average([Tax]) -
                floor(Average([Tax]) / 60) * 60
            )
          )
        )
      ) -
      2,
    2
  )
)
```

<img width=""1405"" height=""744"" alt=""Image"" src=""https://github.com/user-attachments/assets/f1cc4c65-1745-416a-b96f-464a1f016c9a"" />

Upgrade to 57 and notice it's not there anymore

<img width=""1728"" height=""596"" alt=""Image"" src=""https://github.com/user-attachments/assets/c6f823b6-0792-487d-8fa6-7c8af505e2f1"" />

### Expected behavior

My custom expression remains

### Logs

I see a lot of warnings in the logs:

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/invalid-type:
{:aggregation
 [[nil
   [""text"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] {""name"" ""test"", ""display-name"" ""test""}]
   "":""
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/end-of-input:
{:aggregation [[:concat]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/invalid-type:
{:aggregation
 [[nil
   "":""
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/invalid-type:
{:aggregation
 [[nil
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation] due to error :malli.core/limits:
{:aggregation []}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1 :lib/uuid] due to error :malli.core/missing-key:
{:aggregation
 [[nil
   {}
   [""text"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] {""name"" ""test"", ""display-name"" ""test""}]
   "":""
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/invalid-type:
{:aggregation
 [[nil
   "":""
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/invalid-type:
{:aggregation
 [[nil
   [""text"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] {""name"" ""test"", ""display-name"" ""test""}]
   "":""
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/end-of-input:
{:aggregation [[:concat]]}

[fbc96ce4-b029-40e9-81c8-d51537e46187] 2025-12-16T17:25:07+01:00 WARN metabase.lib.convert Clean: Removing bad clause in [:aggregation 0 1] due to error :malli.core/invalid-type:
{:aggregation
 [[nil
   [""substring""
    [""concat""
     ""0""
     [""text""
      [""floor""
       [""-""
        [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
        [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]
    [""-""
     [""+""
      1
      [""length""
       [""concat""
        ""0""
        [""text""
         [""floor""
          [""-""
           [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]]
           [""*"" [""floor"" [""/"" [""avg"" [""field"" 6 {""base-type"" ""type/Float""}]] 60]] 60]]]]]]]
     2]
    2]]]}

### Information about your Metabase installation

```JSON
1.57.7
```

### Severity

breaks questions

### Additional context

_No response_",Tony-metabase,0,"Type:Bug, Priority:P1, Querying/Notebook/Custom Expression, .Team/Querying, .Auto triaged, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/67027,2025-12-16T16:26:22Z,2025-12-17T03:21:36Z,negative,bug,high
3735485411,67026,Metabase 0.57.6 ClickHouse driver fails to parse host when Connection String is used together with UI fields,open,"## Describe the bug

When adding a ClickHouse database in **Metabase v0.57.6**, using a valid JDBC connection string causes the connection test to fail with the following error:

java.lang.IllegalArgumentException: Host cannot be null or empty string

This happens even though:

- The same host and port work correctly via `curl` and ClickHouse CLI
- DNS resolution and network connectivity inside the Metabase container are verified
- The same credentials succeed using ClickHouse HTTP API (`/ping`, `SELECT 1`)
- ClickHouse itself is healthy and reachable

It appears that **Metabase UI incorrectly parses or mutates the ClickHouse JDBC connection string**, resulting in an empty or missing host being passed to the ClickHouse JDBC driver.

---

## Logs

### Metabase server logs (during â€œTest connectionâ€)

```text
ERROR driver.util :: Failed to connect to Database
java.sql.SQLException: Failed to create connection
    at com.clickhouse.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:104)
    at com.clickhouse.jdbc.Driver.connect(Driver.java:123)
Caused by: java.lang.IllegalArgumentException: Host cannot be null or empty string
    at com.clickhouse.data.ClickHouseChecker.nonEmpty(ClickHouseChecker.java:250)
    at com.clickhouse.client.ClickHouseNode.<init>(ClickHouseNode.java:892)

This error is reproducible on every connection attempt.

â¸»

To Reproduce
	1.	Go to Admin â†’ Databases â†’ Add database
	2.	Select ClickHouse
	3.	Paste a valid JDBC connection string, for example:

jdbc:clickhouse://plausible_events_db:8123/plausible_events_db?user=metabase&password=***&ssl=false


	4.	Observe that Metabase automatically fills Host / Port / Username / Password
	5.	Click Test connection
	6.	Connection fails with Host cannot be null or empty string

This happens regardless of:
	â€¢	Whether UI fields are auto-filled or manually edited
	â€¢	SSL enabled or disabled
	â€¢	Multiple databases enabled or disabled

â¸»

Expected behavior

Metabase should:
	â€¢	Correctly parse the ClickHouse JDBC connection string, or
	â€¢	Use the connection string as-is without overriding host information

The ClickHouse JDBC driver should receive a non-empty host value, and the connection test should succeed.

â¸»

Screenshots

(Attached screenshots show connection string pasted, UI auto-filled fields, and connection test failure.)

â¸»

Severity

Blocking

This issue completely blocks using ClickHouse with Metabase v0.57.6, even though:
	â€¢	Network connectivity is confirmed
	â€¢	Credentials are correct
	â€¢	ClickHouse is reachable and operational

There is currently no working workaround via the UI.

â¸»

Additional context
	â€¢	The issue does not appear to be ClickHouse-side
	â€¢	The JDBC driver is loaded successfully
	â€¢	The error strongly suggests a UI â†’ driver handoff bug
	â€¢	Disabling SSL, proxies, and advanced settings does not resolve the issue

â¸»

Metabase Diagnostic Info

{
  ""browser-info"": {
    ""language"": ""zh-CN"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-12-11"",
      ""tag"": ""v0.57.6"",
      ""hash"": ""e9e9771""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-46-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}",blowxian,1,"Type:Bug, Priority:P2, .Backend, .Team/Querying, Database/Clickhouse",https://github.com/metabase/metabase/issues/67026,2025-12-16T16:24:28Z,,negative,bug,high
3734273073,67002,Questions with joined models fail with invalid SQL after v57 upgrade,open,"### Describe the bug

After upgrading from v 56 to v57, some queries that used to work are now failing with a 
`""ERROR: column source. Table Name - Column__name_ef701e16 does not exist Position: 249""`

These questions used to work well before upgrade.

The bug seems to be on queries with a combination of Join and Summarize.
- When I do a join between two tables
- Then a first Summarize that select columns from both tables
- And in the final summarize, i cannot select the column from the second table (after the first left join) !!

### To Reproduce

I cannot reproduce on a healthy environment


### Expected behavior

The queries with joins and summarize work as they worked before

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-12-12"",
      ""tag"": ""v0.57.6.2"",
      ""hash"": ""07f85e3""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.12""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.14.322-244.536.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Blocking ! A lot of our dashboards are impacted

### Additional context

_No response_",MarieSophieRichard,14,"Type:Bug, Priority:P1, Querying/Processor, Querying/MBQL, Difficulty:Hard, .Backend, .Team/Querying, .Auto triaged, Cloud-Blocker:57, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/67002,2025-12-16T10:55:43Z,,negative,bug,high
3732791940,66995,Hope to add the function of copying multiple selected cells,closed,"Whenever I need to copy the content from a table, I can only do it by downloading Excel or by single-clicking and then double-clicking. However, in many other scenarios, I would select multiple cells in a specific column and then copy them. I hope to add this function.",dhstime,2,"Visualization/, Type:New Feature, Visualization/Tables, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66995,2025-12-16T02:03:31Z,2025-12-16T13:18:11Z,positive,feature_request,medium
3732764608,66994,"Number Viz Dashcard settings can be set from both ""Viz Options"" and ""Visualizer"" Rendering the Card Uneditable",open,"### Describe the bug

I'm not sure if it's even a valid state that ""Visualization Options"" and ""Visualize another way"" should both be available on any dashcard at once. For number viz they are both available. You can set a title on both and end up in a pretty weird state.

### To Reproduce

1. Add a number viz to a dashboard
2. Go to ""Visualization Options"" and rename the card
3. Got to ""Visualize another way"" and set the title there as well
4. Note that the card has multiple titles and it's no longer clickable so you can't navigate to it easily

For most users this feels pretty unrecoverable. Particularly if the card is saved to the dashabord.

Loom: https://www.loom.com/share/f63b8bcf5d254aa98b88242296579543

### Expected behavior

It's the visualizer so I'm not sure anyone could possibly know what to expect here. But I'm sure it's not this!

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-12-11"",
      ""tag"": ""v1.57.6"",
      ""hash"": ""e9e9771""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

You can recover from this state a few ways but none of them are simple or intuitive for users.",ixipixi,0,"Type:Bug, Priority:P2, Reporting/Dashboards, .Team/UXWest, .visualizeanotherway-ux-regression, .Auto triaged, Visualizer",https://github.com/metabase/metabase/issues/66994,2025-12-16T01:47:50Z,,negative,bug,high
3732723062,66991,Assert failed: (map? session) when I try to login,closed,"### Describe the bug

```
2025-12-15 20:43:39,274 ERROR session.api :: Authentication endpoint error 
java.lang.AssertionError: Assert failed: (map? session)
        at metabase.session.models.session$fn__105058$f__14653__auto____105059.invoke(session.clj:91)
        at metabase.session.models.session$fn__105065$f__14653__auto____105066.invoke(session.clj:106)
        at clojure.lang.MultiFn.invoke(MultiFn.java:239)
        at metabase.session.api$email_login.invokeStatic(api.clj:88)
        at metabase.session.api$email_login.invoke(api.clj:80)
        at metabase.session.api$login.invokeStatic(api.clj:113)
        at metabase.session.api$login.invoke(api.clj:105)
        at metabase.session.api$fn__123549$fn__123555$do_login__123557.invoke(api.clj:145)
        at metabase.session.api$fn__123549$fn__123555$fn__123560$fn__123561$fn__123562.invoke(api.clj:153)
        at throttle.core$do_with_throttling.invokeStatic(core.clj:93)
        at throttle.core$do_with_throttling.invoke(core.clj:87)
        at metabase.session.api$fn__123549$fn__123555$fn__123560$fn__123561.invoke(api.clj:151)
        at throttle.core$do_with_throttling.invokeStatic(core.clj:93)
        at throttle.core$do_with_throttling.invoke(core.clj:87)
        at metabase.session.api$fn__123549$fn__123555$fn__123560.invoke(api.clj:151)
        at metabase.session.api$do_http_401_on_error.invokeStatic(api.clj:123)
        at metabase.session.api$do_http_401_on_error.invoke(api.clj:121)
        at metabase.session.api$fn__123549$fn__123555.invoke(api.clj:150)
        at metabase.api.macros$_core_fn$core_fn__88078.invoke(macros.clj:427)
        at metabase.api.macros$endpoint_handler_STAR_$handler__88120.invoke(macros.clj:623)
        at metabase.api.macros$build_ns_handler$ns_handler_STAR___88146.invoke(macros.clj:687)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at metabase.session.api$_PLUS_log_all_request_failures$fn__123715.invoke(api.clj:334)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at metabase.api.util.handlers$_route_map_handler$fn__99601.invoke(handlers.clj:23)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at metabase.api_routes.routes$fn__123970.invokeStatic(routes.clj:99)
        at metabase.api_routes.routes$fn__123970.invoke(routes.clj:98)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538.invoke(core.clj:200)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at clojure.lang.Var.invoke(Var.java:395)
        at metabase.server.routes$api_handler$api_handler_STAR___100331.invoke(routes.clj:88)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538.invoke(core.clj:200)
        at compojure.core$make_context$handler__99566.invoke(core.clj:290)
        at compojure.core$make_context$fn__99570.invoke(core.clj:300)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__99519.invoke(core.clj:153)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540.invoke(core.clj:197)
        at metabase.api.util.handlers$_route_map_handler$fn__99601.invoke(handlers.clj:24)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at metabase.api.util.handlers$_route_map_handler$fn__99601.invoke(handlers.clj:23)
        at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
        at compojure.core$routes$fn__99538$f__99539.invoke(core.clj:198)
        at compojure.core$routes$fn__99538.invoke(core.clj:200)
        at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__117635.invoke(exceptions.clj:84)
        at metabase.server.middleware.exceptions$catch_api_exceptions$fn__117632.invoke(exceptions.clj:73)
        at metabase.server.middleware.log$log_api_call$fn__110835$fn__110836$fn__110837.invoke(log.clj:225)
        at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)
        at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)
        at metabase.server.middleware.log$log_api_call$fn__110835$fn__110836.invoke(log.clj:216)
        at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)
        at toucan2.execute$do_with_call_counts.invoke(execute.clj:103)
        at metabase.server.middleware.log$log_api_call$fn__110835.invoke(log.clj:215)
        at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__125061.invoke(browser_cookie.clj:40)
        at metabase.server.middleware.security$add_security_headers$fn__117602.invoke(security.clj:321)
        at metabase.server.middleware.json$wrap_json_body$fn__116893.invoke(json.clj:128)
        at metabase.server.middleware.offset_paging$handle_paging$fn__119596.invoke(offset_paging.clj:48)
        at metabase.server.middleware.json$wrap_streamed_json_response$fn__116881.invoke(json.clj:83)
        at metabase.server.middleware.metadata_provider_cache$wrap_metadata_provider_cache$fn__125071.invoke(metadata_provider_cache.clj:11)
        at ring.middleware.keyword_params$wrap_keyword_params$fn__125336.invoke(keyword_params.clj:55)
        at ring.middleware.params$wrap_params$fn__125355.invoke(params.clj:77)
        at metabase.server.middleware.misc$maybe_set_site_url$fn__109937.invoke(misc.clj:78)
        at metabase.server.middleware.session$reset_session_timeout$fn__125049.invoke(session.clj:290)
        at metabase.server.middleware.session$bind_current_user$fn__125042$fn__125043.invoke(session.clj:265)
        at metabase.request.session$do_with_current_user$fn__80437.invoke(session.clj:60)
        at metabase.request.session$do_with_current_user$do_with_user_local_values__80432.invoke(session.clj:56)
        at metabase.request.session$do_with_current_user.invokeStatic(session.clj:57)
        at metabase.request.session$do_with_current_user.invoke(session.clj:38)
        at metabase.server.middleware.session$bind_current_user$fn__125042.invoke(session.clj:264)
        at metabase.server.middleware.session$wrap_current_user_info$fn__125038.invoke(session.clj:240)
        at metabase.server.middleware.settings_cache$wrap_settings_cache_check$fn__117933.invoke(settings_cache.clj:50)
        at metabase.analytics.sdk$embedding_mw$embedding_mw_fn__55855.invoke(sdk.clj:68)
        at metabase.server.middleware.session$wrap_session_key$fn__124996.invoke(session.clj:89)
        at metabase.server.middleware.auth$wrap_static_api_key$fn__111498.invoke(auth.clj:17)
        at ring.middleware.cookies$wrap_cookies$fn__125256.invoke(cookies.clj:200)
        at metabase.server.middleware.misc$add_version$fn__109908.invoke(misc.clj:29)
        at metabase.server.middleware.misc$add_content_type$fn__109916.invoke(misc.clj:47)
        at metabase.server.middleware.misc$disable_streaming_buffering$fn__109945.invoke(misc.clj:94)
        at ring.middleware.gzip$wrap_gzip$fn__125298.invoke(gzip.clj:86)
        at metabase.server.middleware.request_id$wrap_request_id$fn__100996.invoke(request_id.clj:10)
        at metabase.server.middleware.misc$bind_request$fn__109948$fn__109949.invoke(misc.clj:106)
        at metabase.request.current$do_with_current_request.invokeStatic(current.clj:19)
        at metabase.request.current$do_with_current_request.invoke(current.clj:15)
        at metabase.server.middleware.misc$bind_request$fn__109948.invoke(misc.clj:105)
        at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__125085.invoke(ssl.clj:52)
        at metabase.server.instance$async_proxy_handler$fn__110567.invoke(instance.clj:82)
        at metabase.server.instance.proxy$org.eclipse.jetty.ee9.servlet.ServletHandler$ff19274a.doHandle(Unknown Source)
        at org.eclipse.jetty.ee9.nested.ScopedHandler.handle(ScopedHandler.java:127)
        at metabase.server.statistics_handler$new_handler$fn__98714.invoke(statistics_handler.clj:105)
        at metabase.server.statistics_handler.proxy$org.eclipse.jetty.ee9.nested.HandlerWrapper$ff19274a.handle(Unknown Source)
        at org.eclipse.jetty.ee9.nested.HandlerWrapper.handle(HandlerWrapper.java:124)
        at org.eclipse.jetty.ee9.nested.ScopedHandler.nextHandle(ScopedHandler.java:197)
        at org.eclipse.jetty.ee9.nested.ContextHandler.doHandle(ContextHandler.java:1045)
        at org.eclipse.jetty.ee9.nested.ScopedHandler.nextScope(ScopedHandler.java:164)
        at org.eclipse.jetty.ee9.servlet.ServletHandler.doScope(ServletHandler.java:483)
        at metabase.server.instance.proxy$org.eclipse.jetty.ee9.servlet.ServletHandler$ff19274a.doScope(Unknown Source)
        at org.eclipse.jetty.ee9.nested.ScopedHandler.nextScope(ScopedHandler.java:162)
        at org.eclipse.jetty.ee9.nested.ContextHandler.doScope(ContextHandler.java:966)
        at org.eclipse.jetty.ee9.nested.ScopedHandler.handle(ScopedHandler.java:125)
        at org.eclipse.jetty.ee9.nested.ContextHandler.handle(ContextHandler.java:1719)
        at org.eclipse.jetty.ee9.nested.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1565)
        at org.eclipse.jetty.ee9.nested.HttpChannel.dispatch(HttpChannel.java:724)
        at org.eclipse.jetty.ee9.nested.HttpChannel.handle(HttpChannel.java:512)
        at org.eclipse.jetty.ee9.nested.ContextHandler$CoreContextHandler$CoreToNestedHandler.handle(ContextHandler.java:3029)
        at org.eclipse.jetty.server.handler.ContextHandler.handle(ContextHandler.java:1071)
        at org.eclipse.jetty.server.Server.handle(Server.java:182)
        at org.eclipse.jetty.server.internal.HttpChannelState$HandlerInvoker.run(HttpChannelState.java:677)
        at org.eclipse.jetty.server.internal.HttpConnection.onFillable(HttpConnection.java:416)
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:322)
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:99)
        at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:480)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:443)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:293)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:201)
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:311)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:981)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1211)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1166)
        at java.base/java.lang.Thread.run(Unknown Source)
2025-12-15 20:43:39,320 ERROR middleware.log :: POST /api/session 500 153ms (3 DB calls) {:metabase-user-id nil} 
{:via
 [{:type java.lang.AssertionError,
   :message ""Assert failed: (map? session)"",
   :at [metabase.session.models.session$fn__105058$f__14653__auto____105059 invoke ""session.clj"" 91]}],
 :trace
 [[metabase.session.models.session$fn__105058$f__14653__auto____105059 invoke ""session.clj"" 91]
  [metabase.session.models.session$fn__105065$f__14653__auto____105066 invoke ""session.clj"" 106]
  [clojure.lang.MultiFn invoke ""MultiFn.java"" 239]
  [metabase.session.api$email_login invokeStatic ""api.clj"" 88]
  [metabase.session.api$email_login invoke ""api.clj"" 80]
  [metabase.session.api$login invokeStatic ""api.clj"" 113]
  [metabase.session.api$login invoke ""api.clj"" 105]
  [metabase.session.api$fn__123549$fn__123555$do_login__123557 invoke ""api.clj"" 145]
  [metabase.session.api$fn__123549$fn__123555$fn__123560$fn__123561$fn__123562 invoke ""api.clj"" 153]
  [throttle.core$do_with_throttling invokeStatic ""core.clj"" 93]
  [throttle.core$do_with_throttling invoke ""core.clj"" 87]
  [metabase.session.api$fn__123549$fn__123555$fn__123560$fn__123561 invoke ""api.clj"" 151]
  [throttle.core$do_with_throttling invokeStatic ""core.clj"" 93]
  [throttle.core$do_with_throttling invoke ""core.clj"" 87]
  [metabase.session.api$fn__123549$fn__123555$fn__123560 invoke ""api.clj"" 151]
  [metabase.session.api$do_http_401_on_error invokeStatic ""api.clj"" 123]
  [metabase.session.api$do_http_401_on_error invoke ""api.clj"" 121]
  [metabase.session.api$fn__123549$fn__123555 invoke ""api.clj"" 150]
  [metabase.api.macros$_core_fn$core_fn__88078 invoke ""macros.clj"" 427]
  [metabase.api.macros$endpoint_handler_STAR_$handler__88120 invoke ""macros.clj"" 623]
  [metabase.api.macros$build_ns_handler$ns_handler_STAR___88146 invoke ""macros.clj"" 687]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [metabase.session.api$_PLUS_log_all_request_failures$fn__123715 invoke ""api.clj"" 334]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [metabase.api.util.handlers$_route_map_handler$fn__99601 invoke ""handlers.clj"" 23]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [metabase.api_routes.routes$fn__123970 invokeStatic ""routes.clj"" 99]
  [metabase.api_routes.routes$fn__123970 invoke ""routes.clj"" 98]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538 invoke ""core.clj"" 200]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [clojure.lang.Var invoke ""Var.java"" 395]
  [metabase.server.routes$api_handler$api_handler_STAR___100331 invoke ""routes.clj"" 88]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__99566 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__99570 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__99519 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538$f__99539$respond_SINGLEQUOTE___99540 invoke ""core.clj"" 197]
  [metabase.api.util.handlers$_route_map_handler$fn__99601 invoke ""handlers.clj"" 24]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [metabase.api.util.handlers$_route_map_handler$fn__99601 invoke ""handlers.clj"" 23]
  [metabase.api.open_api.HandlerWithOpenAPISpec invoke ""open_api.clj"" 42]
  [compojure.core$routes$fn__99538$f__99539 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__99538 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__117635 invoke ""exceptions.clj"" 84]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__117632 invoke ""exceptions.clj"" 73]
  [metabase.server.middleware.log$log_api_call$fn__110835$fn__110836$fn__110837 invoke ""log.clj"" 225]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 17]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__110835$fn__110836 invoke ""log.clj"" 216]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__110835 invoke ""log.clj"" 215]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__125061 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__117602 invoke ""security.clj"" 321]
  [metabase.server.middleware.json$wrap_json_body$fn__116893 invoke ""json.clj"" 128]
  [metabase.server.middleware.offset_paging$handle_paging$fn__119596 invoke ""offset_paging.clj"" 48]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__116881 invoke ""json.clj"" 83]
  [metabase.server.middleware.metadata_provider_cache$wrap_metadata_provider_cache$fn__125071
   invoke
   ""metadata_provider_cache.clj""
   11]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__125336 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__125355 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__109937 invoke ""misc.clj"" 78]
  [metabase.server.middleware.session$reset_session_timeout$fn__125049 invoke ""session.clj"" 290]
  [metabase.server.middleware.session$bind_current_user$fn__125042$fn__125043 invoke ""session.clj"" 265]
  [metabase.request.session$do_with_current_user$fn__80437 invoke ""session.clj"" 60]
  [metabase.request.session$do_with_current_user$do_with_user_local_values__80432 invoke ""session.clj"" 56]
  [metabase.request.session$do_with_current_user invokeStatic ""session.clj"" 57]
  [metabase.request.session$do_with_current_user invoke ""session.clj"" 38]
  [metabase.server.middleware.session$bind_current_user$fn__125042 invoke ""session.clj"" 264]
  [metabase.server.middleware.session$wrap_current_user_info$fn__125038 invoke ""session.clj"" 240]
  [metabase.server.middleware.settings_cache$wrap_settings_cache_check$fn__117933 invoke ""settings_cache.clj"" 50]
  [metabase.analytics.sdk$embedding_mw$embedding_mw_fn__55855 invoke ""sdk.clj"" 68]
  [metabase.server.middleware.session$wrap_session_key$fn__124996 invoke ""session.clj"" 89]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__111498 invoke ""auth.clj"" 17]
  [ring.middleware.cookies$wrap_cookies$fn__125256 invoke ""cookies.clj"" 200]
  [metabase.server.middleware.misc$add_version$fn__109908 invoke ""misc.clj"" 29]
  [metabase.server.middleware.misc$add_content_type$fn__109916 invoke ""misc.clj"" 47]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__109945 invoke ""misc.clj"" 94]
  [ring.middleware.gzip$wrap_gzip$fn__125298 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.request_id$wrap_request_id$fn__100996 invoke ""request_id.clj"" 10]
  [metabase.server.middleware.misc$bind_request$fn__109948$fn__109949 invoke ""misc.clj"" 106]
  [metabase.request.current$do_with_current_request invokeStatic ""current.clj"" 19]
  [metabase.request.current$do_with_current_request invoke ""current.clj"" 15]
  [metabase.server.middleware.misc$bind_request$fn__109948 invoke ""misc.clj"" 105]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__125085 invoke ""ssl.clj"" 52]
  [metabase.server.instance$async_proxy_handler$fn__110567 invoke ""instance.clj"" 82]
  [metabase.server.instance.proxy$org.eclipse.jetty.ee9.servlet.ServletHandler$ff19274a doHandle nil -1]
  [org.eclipse.jetty.ee9.nested.ScopedHandler handle ""ScopedHandler.java"" 127]
  [metabase.server.statistics_handler$new_handler$fn__98714 invoke ""statistics_handler.clj"" 105]
  [metabase.server.statistics_handler.proxy$org.eclipse.jetty.ee9.nested.HandlerWrapper$ff19274a handle nil -1]
  [org.eclipse.jetty.ee9.nested.HandlerWrapper handle ""HandlerWrapper.java"" 124]
  [org.eclipse.jetty.ee9.nested.ScopedHandler nextHandle ""ScopedHandler.java"" 197]
  [org.eclipse.jetty.ee9.nested.ContextHandler doHandle ""ContextHandler.java"" 1045]
  [org.eclipse.jetty.ee9.nested.ScopedHandler nextScope ""ScopedHandler.java"" 164]
  [org.eclipse.jetty.ee9.servlet.ServletHandler doScope ""ServletHandler.java"" 483]
  [metabase.server.instance.proxy$org.eclipse.jetty.ee9.servlet.ServletHandler$ff19274a doScope nil -1]
  [org.eclipse.jetty.ee9.nested.ScopedHandler nextScope ""ScopedHandler.java"" 162]
  [org.eclipse.jetty.ee9.nested.ContextHandler doScope ""ContextHandler.java"" 966]
  [org.eclipse.jetty.ee9.nested.ScopedHandler handle ""ScopedHandler.java"" 125]
  [org.eclipse.jetty.ee9.nested.ContextHandler handle ""ContextHandler.java"" 1719]
  [org.eclipse.jetty.ee9.nested.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1565]
  [org.eclipse.jetty.ee9.nested.HttpChannel dispatch ""HttpChannel.java"" 724]
  [org.eclipse.jetty.ee9.nested.HttpChannel handle ""HttpChannel.java"" 512]
  [org.eclipse.jetty.ee9.nested.ContextHandler$CoreContextHandler$CoreToNestedHandler handle ""ContextHandler.java"" 3029]
  [org.eclipse.jetty.server.handler.ContextHandler handle ""ContextHandler.java"" 1071]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 182]
  [org.eclipse.jetty.server.internal.HttpChannelState$HandlerInvoker run ""HttpChannelState.java"" 677]
  [org.eclipse.jetty.server.internal.HttpConnection onFillable ""HttpConnection.java"" 416]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 322]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 99]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 480]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 443]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 293]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 201]
  [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 311]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 981]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1211]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1166]
  [java.lang.Thread run nil -1]],
 :cause ""Assert failed: (map? session)"",
 :message ""Assert failed: (map? session)""}
```

after I fix my h2 database from this method https://github.com/metabase/metabase/issues/63002

### To Reproduce

1. Fix broken db https://github.com/metabase/metabase/issues/63002
2. Fix broken data
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
}
```

### Severity

1

### Additional context

_No response_",tkizm1,1,"Type:Bug, Priority:P1, Administration/, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66991,2025-12-16T01:28:14Z,2025-12-16T01:32:47Z,negative,bug,high
3732650373,66990,Collections in the sidebar do not show the true hierarchy of the folders,open,"**Is your feature request related to a problem? Please describe.**
The ""Our Analytics"" collection encompasses all of the collections below it, but is shown at the same level as the top-level folders *inside* of ""Our Analytics"".

From a customer

>  I find it strange that the folders (collections) are hierarchical (in reality), but when I look at the left navigation, they all appear in a flat list, rather than only seeing the top level of folders, and then being able to drill down into them to see their sub-folders.

<img width=""310"" height=""283"" alt=""Image"" src=""https://github.com/user-attachments/assets/11d5cf87-6439-4af8-a030-54dd4922fee5"" /><br>


**Describe the solution you'd like**
Maybe some visual distinction that ""Our Analytics"" encompasses all of the other ""top-level"" folders. 

Doesn't directly address the presented problem, but being able to create more than than one top-level public collection and being able to re-name it to something other than ""Our Analytics"" is something of interest to the customer. (Yes, they understand that they can do that inside of ""Our Analytics"" but would like the flexibility to not have to do it that way.)

**Additional context**
Customer request

Related: https://github.com/metabase/metabase/issues/38759
",jessicaul,0,"Type:New Feature, Organization/Collections, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66990,2025-12-16T00:47:31Z,,neutral,feature_request,medium
3731976915,66966,Allow searching within a specific collection through API,open,"**Is your feature request related to a problem? Please describe.**
Right now, search looks everywhere, and can't search inside a specific collection.
If, for example, someone wants to build a UI that shows everything inside a collection, and there are many elements, if they want to allow searching **within that collection**, this is not directly possible.

**Describe the solution you'd like**
Having a way to use text search within a specific collection with the API

**Describe alternatives you've considered**
Either adding a filter param to `/api/collection/{id}/items` or adding something like a collection_id to `/api/search`

**Additional context**
Workaround is to do frontend filtering on `/api/collection/{id}/items`, making sure to have fetched all items
",ghostframe,0,"Type:New Feature, Organization/Search, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66966,2025-12-15T20:21:58Z,,neutral,feature_request,medium
3731744078,66961,Issue in `perf/mapv`,open,"### Describe the bug

```clojure
(mapv (comp first vector)
      [1 2]
      (concat (range 1000)
              (for [_ (range 10)]
                (throw (ex-info ""you should not be here"" {})))))
[1 2]
performance-test=> 
(perf/mapv (comp first vector)
           [1 2]
           (concat (range 1000)
                   (for [_ (range 10)]
                     (throw (ex-info ""you should not be here"" {})))))
Execution error (ExceptionInfo) at metabase.util.performance-test/eval2368416$iter$fn$fn (REPL:604).
you should not be here
```

This is a succinct demo of the bug. And the following will be an infinite loop:

```clojure
(mapv (comp first vector)
      [1 2]
      (range))
[1 2]
```

if you use perf/mapv

Issue: it uses count to determine if it's under chunking limits at <= 32 for optimizations. But will try to count infinite sequences or large sequences.

A trivial adaptation to use bounded-count has to update a helper 

```clojure
#?(:clj
   (defn- smallest-count
     (^long [c1 c2] (min (count c1) (count c2)))
     (^long [c1 c2 c3] (min (count c1) (count c2) (count c3)))
     (^long [c1 c2 c3 c4] (min (count c1) (count c2) (count c3) (count c4)))))
```

and then if you put a `bound` parameter to each of these you run into one more issue:

```clojure
performance-test=> (:clj
                    (defn- smallest-count
                      (^long [bound c1 c2] (min (bounded-count bound c1) (bounded-count bound c2)))
                      (^long [bound c1 c2 c3] (min (bounded-count bound c1) (bounded-count bound c2) (bounded-count bound c3)))
                      (^long [bound c1 c2 c3 c4] (min (bounded-count bound c1) (bounded-count bound c2) (bounded-count bound c3) (bounded-count bound c4)))))
Syntax error (IllegalArgumentException) compiling fn* at (REPL:609:21).
fns taking primitives support only 4 or fewer args
```

At this point i kinda backed away.

```diff
diff --git a/src/metabase/util/performance.cljc b/src/metabase/util/performance.cljc
index 7e837d40a97..a201d8ff7a2 100644
--- a/src/metabase/util/performance.cljc
+++ b/src/metabase/util/performance.cljc
@@ -193,22 +193,22 @@
 
 #?(:clj
    (defn- smallest-count
-     (^long [c1 c2] (min (count c1) (count c2)))
-     (^long [c1 c2 c3] (min (count c1) (count c2) (count c3)))
-     (^long [c1 c2 c3 c4] (min (count c1) (count c2) (count c3) (count c4)))))
+     (^long [bound c1 c2] (min (bounded-count bound c1) (bounded-count bound c2)))
+     (^long [bound c1 c2 c3] (min (bounded-count bound c1) (bounded-count bound c2) (bounded-count bound c3)))
+     (^long [bound c1 c2 c3 c4] (min (bounded-count bound c1) (bounded-count bound c2) (bounded-count bound c3) (bounded-count bound c4)))))
 
 (defn mapv
   ""Drop-in replacement for `clojure.core/mapv`.
   Iterates multiple collections more efficiently and uses Java iterators under the hood (the CLJ version). CLJS
   version is only optimized for a single collection arity.""
   ([f coll1]
-   (let [n (count coll1)]
+   (let [n (bounded-count 33 coll1)]
      (cond (= n 0) []
            (<= n 32) (small-persistent! (reduce apply-and-small-conj! (small-transient n f) coll1))
            :else (persistent! (reduce #(conj! %1 (f %2)) (transient []) coll1)))))
   ([f coll1 coll2]
    #?(:clj
-      (let [n (smallest-count coll1 coll2)]
+      (let [n (smallest-count 33 coll1 coll2)]
         (cond (= n 0) []
               (<= n 32) (small-persistent! (reduce apply-and-small-conj! (small-transient n f) coll1 coll2))
               :else (persistent! (reduce #(conj! %1 (f %2 %3)) (transient []) coll1 coll2))))
@@ -216,7 +216,7 @@
       (core/mapv f coll1 coll2)))
   ([f coll1 coll2 coll3]
    #?(:clj
-      (let [n (smallest-count coll1 coll2 coll3)]
+      (let [n (smallest-count 33 coll1 coll2 coll3)]
         (cond (= n 0) []
               (<= n 32) (small-persistent! (reduce apply-and-small-conj! (small-transient n f) coll1 coll2 coll3))
               :else (persistent! (reduce #(conj! %1 (f %2 %3 %4)) (transient []) coll1 coll2 coll3))))
@@ -224,7 +224,7 @@
       (core/mapv f coll1 coll2 coll3)))
   ([f coll1 coll2 coll3 coll4]
    #?(:clj
-      (let [n (smallest-count coll1 coll2 coll3 coll4)]
+      (let [n (smallest-count 33 coll1 coll2 coll3 coll4)]
         (cond (= n 0) []
               (<= n 32) (small-persistent! (reduce apply-and-small-conj! (small-transient n f) coll1 coll2 coll3 coll4))
               :else (persistent! (reduce #(conj! %1 (f %2 %3 %4 %5)) (transient []) coll1 coll2 coll3 coll4))))
diff --git a/test/metabase/util/performance_test.cljc b/test/metabase/util/performance_test.cljc
index f438f2e58fe..5c2df7dff00 100644
--- a/test/metabase/util/performance_test.cljc
+++ b/test/metabase/util/performance_test.cljc
@@ -27,6 +27,15 @@
                                      (= r 2) vec)))))]
       (is (= (apply concat inputs) (apply perf/concat inputs))))))
 
+(deftest mapv-test
+  (testing ""Does not realize long or infinite sequences""
+    (is (= [1 2]
+           (perf/mapv (comp first vector)
+                      [1 2]
+                      (concat (range 1000)
+                              (for [_ (range 10)]
+                                (throw (ex-info ""you should not be here"" {})))))))))
+
 (defn- mapv-via-run! [f coll]
   (let [v (volatile! [])]
     (perf/run! #(vswap! v conj (f %)) coll)
```

### To Reproduce

see above

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```

### Severity

p2

### Additional context

bad footgun",dpsutton,0,"Type:Bug, Priority:P2, .Team/Querying",https://github.com/metabase/metabase/issues/66961,2025-12-15T19:07:02Z,,negative,bug,high
3731530220,66957,Filter breaks when Row Detail Window Open,closed,"### Describe the bug

After filtering a column with a value and then selecting a row which opens the side window with the row details, if you use the same filter again, it causes an issue which results in no results being shown and the side window closing.

### To Reproduce

1. Open on table from a connected database.
2. Click on a column header
3. Select `filter by this column`
4. Use `IS` and enter a valid value and submit
5. Once data is filtered click on a row, which will open the side window with the row details.
6. Click the same column header
7. Select `filter by this column`
8. Use `IS` and enter another valid value (so in theory you should see 2 results)
9. Once submitted the side window closes and no results are shown, you will need to refresh or re-navigate to the page to see data again.

### Expected behavior

This should add to the current filter so it's filtering by two values, this works fine with the row detail window closed.

### Logs

No logs, UI related.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-12-02"",
      ""tag"": ""v0.57.5"",
      ""hash"": ""ec54fec""
    },
    ""settings"": {
      ""report-timezone"": ""Australia/Sydney""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.17""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.245-243.979.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Australia/Sydney""
  }
}
```

### Severity

Annoying

### Additional context

_No response_",JPNZ4,3,"Type:Bug, Priority:P2, Difficulty:Easy, .Frontend, Querying/Drill Thrus, .Team/Querying, .Auto triaged, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66957,2025-12-15T17:57:10Z,2025-12-22T02:31:53Z,negative,bug,high
3731038119,66948,Ability to disable password auth for tenant users,open,"**Is your feature request related to a problem? Please describe.**
When using tenants for embedding, it is most likely that tenant users are signing in using SSO and [it would make sense to disable password login](https://www.metabase.com/docs/latest/people-and-groups/authenticating-with-jwt#disabling-password-logins). However, this can be disabled instance-wide. 

**Describe the solution you'd like**
Specify which auth methods tenant users can use to sign in
Or at least be able to disable password auth for tenant users.

**Describe alternatives you've considered**
You can disable password auth entirely if you are also using SSO for internal users, e.g. Google Auth. However, when disabling password auth entirely it's also easy to be locked out of the instance.

**How important is this feature to you?**
Let's have customers tell us.

**Additional context**",albertoperdomo,0,"Type:New Feature, Administration/Auth, .Team/Embedding, Administration/Tenants, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66948,2025-12-15T15:44:32Z,,neutral,feature_request,medium
3730590387,66945,Column value reference in custom URL destination is replaced by series breakout title,open,"### Describe the bug

Since upgrading to v1.57.5, column values in URL destinations are included as their series' title instead of the actual value.

We have several questions for which we have configured series titles that function as end user friendly names. For example `Non-eco` <-> `HARSH_ACCELERATION`:

<img width=""669"" height=""480"" alt=""Image"" src=""https://github.com/user-attachments/assets/46683c9f-b461-437b-a8ba-581bb0482e45"" />


> You can insert the value of a column or dashboard filter using its name, like this: {{some_column}}


We reference the column value via `{{event_type}}`.
Following the upgrade, our resulting URLs now contain `Non-eco` instead of `HARSH_ACCELERATION` and it breaks all of our click behavior.

### To Reproduce

1. Create a question that has a series breakout
2. Configure titles for the values in the series
3. Add ""Go to a custom destination"" click behaviour to the question
4. Enter a URL referencing the column value for which you have configured `{{some_column}}`
5. Click the question


### Expected behavior

> You can insert the **value of a column** or dashboard filter using its name, like this: {{some_column}}

Column values should end up in the URL instead of their series' titles.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:146.0) Gecko/20100101 Firefox/146.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2025-12-02"",
      ""tag"": ""v1.57.5"",
      ""hash"": ""ec54fec""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.17""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.158-178.288.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Breaks our use of custom click destinations are broken

### Additional context

_No response_",YvesBos,1,"Type:Bug, Priority:P2, Reporting/Dashboards, Reporting/Dashboards/Click Behavior, .Team/Querying, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66945,2025-12-15T14:02:58Z,,negative,bug,high
3730496018,66943,Param Filter no longer work on dashcard,closed,"
### Description
The customer meetings question viz broke. Appears to be because a filter param is pointing to a field that doesn't exist on the question. The field it should be pointing to is the result of an aggregation

### Links
- Slack File: https://metaboat.slack.com/files/U02T6V8MXN2/F0A3ELJ4Y92/diagnostic-info.json
- Stats: [Bug Report] Issue - https://stats.metabase.com/dashboard/3466-success-productivity?daily_date_filter=past7days&monthly_date_filter=past3months~&tab=1728-monthly&ticket_status=&time_grouping=week&user=
",npfitz,1,"Type:Bug, Priority:P2, .Team/Querying, Reporting/Dashboards/Filters & Parameters",https://github.com/metabase/metabase/issues/66943,2025-12-15T13:37:12Z,2025-12-18T20:02:49Z,negative,bug,high
3730439549,66942,Alert form not allowing save when only a slack user is specified,closed,"### Describe the bug

https://metaboat.slack.com/archives/C05NXACAG1G/p1765544139700999

### To Reproduce

1. Create slack and email integrations
2. go to a question
3. set up a new alert to send to a direct message in slack
4. hitting the test button will send the alert, but in the modal the ""done"" button is disabled


### Expected behavior

Should be able to save the alert

### Logs

_No response_

### Information about your Metabase installation

```JSON
Current Master - 57.6
```

### Severity

p2

### Additional context

_No response_",npfitz,0,"Type:Bug, Reporting/Alerts, .Frontend, Notifications/Slack, .Team/Gadget",https://github.com/metabase/metabase/issues/66942,2025-12-15T13:23:41Z,2025-12-18T03:46:05Z,negative,bug,medium
3730419519,66941,Support filtering on computed/CTE fields in SQL queries,open,"**Is your feature request related to a problem? Please describe.**
For SQL queries, field filters must map to an existing database column. If the filterable field is created on the fly (e.g. CTE), it canâ€™t be mapped as a Field Filter. This forces use of SQL variables, where dropdown options must be maintained manually (custom list) or sourced from separate helper questions/models, which is cumbersome.

**Describe the solution you'd like**
- Allow field filters to map to computed/CTE columns
- Allow SQL parameter dropdown to populate options dynamically from the query results.

**Describe alternatives you've considered**
Using custom lists, separate questions/models for dropdowns. 

**How important is this feature to you?**
Customer ask
",Raka1104,2,"Type:New Feature, Querying/Parameters & Variables, .Team/Querying, .Auto triaged",https://github.com/metabase/metabase/issues/66941,2025-12-15T13:18:38Z,,neutral,feature_request,medium
3724895003,66905,Group membership removal from custom groups is not recorded in activity log,open,"### Describe the bug

When a user is removed from a group, an event like this is created in the [activity log](https://www.metabase.com/docs/latest/usage-and-performance-tools/usage-analytics#activity-log-model):

<img width=""657"" height=""489"" alt=""Image"" src=""https://github.com/user-attachments/assets/13a1ecb7-550d-4e44-95f3-ca4ff649e74c"" />

When a user is removed from a custom group, no activity log entry is created.

Note that this only happens for custom groups. Removing a user's admin permissions does create a log entry as expected.

https://github.com/user-attachments/assets/0c472dc5-87d7-4929-a48a-4f249bde784c

### To Reproduce

1. Add a user to a custom group
2. Observe in the activity log that a `group-membership-create` topic entry is created
3. Remove the user from the group
4. No `group-membership-delete` entry is created


### Expected behavior

Create activity log entries when a user is removed from a custom group.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2"",
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-12-10"",
      ""tag"": ""v1.57.5.8"",
      ""hash"": ""b88ce88""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

Can cause false alarms during permission audits

### Additional context

_No response_",rolodato,1,"Type:Bug, .Security related, Priority:P2, .Backend, .Reproduced, Administration/Usage analytics, .Team/UXWest, Claude Bug Fix, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66905,2025-12-12T21:33:13Z,,negative,bug,medium
3724862074,66902,All text on a Document chart is highlighted when clicking anywhere on the chart in Firefox,closed,"### Describe the bug

In firefox (but not in chrome), when interacting with a chart in a document in any way (clicking anywhere on the chart, clicking on three docs menu, trying to drill through) will highlight all the text on the chart.

https://github.com/user-attachments/assets/ae406890-a81e-47fb-84ea-8f8504065f43

### To Reproduce

1. Open Metabase in Firefox
2. Create a document
3. Add any chart
4. Click anywhere on the chart (e.g. on the the ""three dots"" menu)

<img width=""2054"" height=""984"" alt=""Image"" src=""https://github.com/user-attachments/assets/73510976-63ce-4562-beaf-cfede24e5e9a"" />

### Expected behavior

Not highlight text unless I'm literally selecting it

### Logs

_No response_

### Information about your Metabase installation

```JSON
57.5
```

### Severity

This is driving me INSANE (but probably P3)

### Additional context

_No response_",alexyarosh,0,"Type:Bug, Priority:P3, .Team/UXWest, Claude Bug Fix, Organization/Documents, .Auto triaged",https://github.com/metabase/metabase/issues/66902,2025-12-12T21:19:28Z,2025-12-15T13:37:31Z,negative,bug,high
3724448128,66891,"Notify affected users of changes to questions, dashboards, etc.",open,"**Is your feature request related to a problem? Please describe.**
If Iâ€™m about to change or break a table, or if a dashboard/question is causing performance issues, thereâ€™s no way to notify all the users dependent on it.

**Describe the solution you'd like**
- Email all users and display a notification to everyone who has interacted with a given table/question/dashboard in the last N days.
- Add a formal owner / owning group field for content when a query is slow/failing.

**How important is this feature to you?**
Customer ask

**Additional context**
Related to #49221",Raka1104,0,"Type:New Feature, .Team/UXWest, .Team/UXEast, .Auto triaged",https://github.com/metabase/metabase/issues/66891,2025-12-12T18:41:53Z,,neutral,feature_request,medium
3724342454,66888,Field filter alias doesn't work on MongoDB,closed,"### Describe the bug

Field filter alias does not apply on MongoDB

### To Reproduce

1. Create a new native question on MongoDB, e.g. I have a People collection:
```
[
  {
    ""$project"": {
      ""_id"": ""$_id"",
      ""name"": ""$name"",
      ""age"": ""$age""
    }
  },
  {
    ""$match"": {{test}}
  }
  {
    ""$limit"": 1048575
  }
]
```
2. Set up the field filter to point to a field, then set anything to its alias
<img width=""1698"" height=""487"" alt=""Image"" src=""https://github.com/user-attachments/assets/9d452f73-4940-440c-ae89-5e4b21509522"" />

3. Set a value to the filter and preview its output - the alias is not applied


### Expected behavior

It should either apply the alias or not show the option to do it

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57.5.1
```

### Severity

P2

### Additional context

_No response_",ghostframe,2,"Type:Bug, Priority:P2, Querying/Parameters & Variables, .Team/Querying, Triaged Manually",https://github.com/metabase/metabase/issues/66888,2025-12-12T18:03:17Z,2025-12-17T19:45:27Z,negative,bug,medium
3724313418,66887,Granular permissions for Admin Settings,open,"**Is your feature request related to a problem? Please describe.**
Metabase Admin role is all or nothing. Anyone who needs to perform a specific administrative task (like creating users, managing permissons, administering databases, etc.) must be given full admin access, even though they don't need access to many parts of Admin panel.

**Describe the solution you'd like**
Support granular admin roles that allow limiting access to specific areas of admin settings. For example:
- A User Admin can manage users and groups but don't need access to all databases.
- A Permissions Admin can manage permissions but cannot create users or change database connections
- A Data Admin who can manage databases but cannot change overall instance settings.

**How important is this feature to you?**
Customer ask

**Additional context**
Related to #43368",Raka1104,0,"Type:New Feature, Administration/Settings, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66887,2025-12-12T17:52:59Z,,neutral,feature_request,medium
3724292053,66886,"Output of ""Preview the query"" on MongoDB native questions is hard to read",closed,"### Describe the bug

Includes lots of backward slashes and newlines

### To Reproduce

1. Create any native question on Mongo
2. Add any field filter
3. Preview the SQL
<img width=""620"" height=""161"" alt=""Image"" src=""https://github.com/user-attachments/assets/d6e0bfd7-b624-4b25-a39c-c6a4903950f7"" />


### Expected behavior

Should print it in a readable way to debug issues with the query

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57.5.1
```

### Severity

P3

### Additional context

_No response_",ghostframe,0,"Type:Bug, Priority:P3, Querying/Native, .Team/Querying, Claude Bug Fix",https://github.com/metabase/metabase/issues/66886,2025-12-12T17:45:12Z,2025-12-15T21:24:12Z,negative,bug,medium
3724278182,66885,Database Routing: Clickhouse support,open,"Is your feature request related to a problem? Please describe.
Support Database Routing with Clickhouse

Describe the solution you'd like
Support Database Routing with Clickhouse

Describe alternatives you've considered
n/a

How important is this feature to you?
Clickhouse currently doesn't work with Database Routing. Requested by users/customers

Additional context
n/a
",psalinasy,0,"Type:New Feature, Administration/Databases, .Team/Querying, Database/Clickhouse, .Auto triaged",https://github.com/metabase/metabase/issues/66885,2025-12-12T17:39:23Z,,neutral,feature_request,high
3723730948,66880,"Invalid BigQuery syntax `No matching signature for function TIMESTAMP Argument types: TIMESTAMP, STRING`",closed,"### Describe the bug

### Bug
The following error occurs because `TIMESTAMP(timestamp_column, 'Europe/Amsterdam')` is not valid in BigQuery.

### Error message
```
400 Bad Request GET https://bigquery.googleapis.com/bigquery/v2/projects/gynzy-analytics/queries/b4e5f4a7-a1d8-442c-91de-66caed28d50a?location=EU&maxResults=0&prettyPrint=false { ""code"": 400, ""errors"": [ { ""domain"": ""global"", ""location"": ""q"", ""locationType"": ""parameter"", ""message"": ""No matching signature for function TIMESTAMP\n Argument types: TIMESTAMP, STRING\n Signature: TIMESTAMP(STRING, [STRING])\n Argument 1: Unable to coerce type TIMESTAMP to expected type STRING\n Signature: TIMESTAMP(DATE, [STRING])\n Argument 1: Unable to coerce type TIMESTAMP to expected type DATE\n Signature: TIMESTAMP(DATETIME, [STRING])\n Argument 1: Unable to coerce type TIMESTAMP to expected type DATETIME\n Signature: TIMESTAMP(TIMESTAMP)\n Signature accepts at most 1 argument, found 2 arguments at [1:52]"", ""reason"": ""invalidQuery"" } ], ""message"": ""No matching signature for function TIMESTAMP\n Argument types: TIMESTAMP, STRING\n Signature: TIMESTAMP(STRING, [STRING])\n Argument 1: Unable to coerce type TIMESTAMP to expected type STRING\n Signature: TIMESTAMP(DATE, [STRING])\n Argument 1: Unable to coerce type TIMESTAMP to expected type DATE\n Signature: TIMESTAMP(DATETIME, [STRING])\n Argument 1: Unable to coerce type TIMESTAMP to expected type DATETIME\n Signature: TIMESTAMP(TIMESTAMP)\n Signature accepts at most 1 argument, found 2 arguments at [1:52]"", ""status"": ""INVALID_ARGUMENT"" }
```


### To Reproduce

<img width=""2452"" height=""694"" alt=""Image"" src=""https://github.com/user-attachments/assets/08442f55-e1dd-4dbb-bfc2-380eaccf9ea3"" />

Start with a table with the columns:
- created_at TIMESTAMP
- user_id INTEGER

Create a question:
1. Custom column `year([created_at])` named `Yearr`
2. Summarize:
- `Distinct([user_id])` name `Unique Users`
- `created_at: Week of year`, `Yearr`

### Incorrect query

Compiled query:
```
SELECT
  CEIL(
    EXTRACT(
      dayofyear
     
FROM
        TIMESTAMP_TRUNC(
          TIMESTAMP(`source`.`created_at`, 'Europe/Amsterdam'),
          week(monday),
          'Europe/Amsterdam'
        ) AT TIME ZONE 'Europe/Amsterdam'
    ) / 7.0
  ) AS `created_at`,
  `source`.`Yearr` AS `Yearr`,
  count(distinct `source`.`user_id`) AS `Unique_Users`
FROM
  (
    SELECT
      `REDACTED`.`user_id` AS `user_id`,
      `REDACTED`.`created_at` AS `created_at`,
      EXTRACT(
        year
        FROM
          `REDACTED`.`created_at` AT TIME ZONE 'Europe/Amsterdam'
      ) AS `Yearr`
    FROM
      `REDACTED`
  ) AS `source`
GROUP BY
  `created_at`,
  `Yearr`
ORDER BY
  `created_at` ASC,
  `Yearr` ASC
```

```
TIMESTAMP(`source`.`created_at`, 'Europe/Amsterdam'), -- is invalid BigQuery syntax.
```



### Expected behavior

That a valid query is generated.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2025-12-11"",
      ""tag"": ""v1.57.6.1"",
      ""hash"": ""7b1a438""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Amsterdam""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.6.105+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Breaks already existing questions. Blocking some users who depend on these questions.

### Additional context

When setting the project timezone to ""Database default"" a valid query is generated.",nicklubbers,6,"Type:Bug, Priority:P1, Database/Postgres, Database/BigQuery, .Team/Querying",https://github.com/metabase/metabase/issues/66880,2025-12-12T15:00:05Z,2025-12-18T22:42:56Z,negative,bug,high
3723443757,66877,Provide text alignment,closed,"**Is your feature request related to a problem? Please describe.**
Allow text alignment on text cards / documents

**Describe the solution you'd like**
Provide a way to align every line of a text card or a document, much like you do on a word processor

**Describe alternatives you've considered**
None

**How important is this feature to you?**
Requested by a customer, they wanted to align text to the middle to probably focus the user to a specific card

**Additional context**
NA
",dragonsahead,2,"Reporting/Dashboards, Type:New Feature, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66877,2025-12-12T13:31:44Z,2025-12-12T23:26:47Z,positive,feature_request,medium
3723270273,66875,Docker Hub latest tag is outdated and does not match the newest release,closed,"### Describe the bug

The latest Docker image tag on Docker Hub is outdated.
Even though the newest Metabase release is correctly marked as Latest on GitHub, pulling metabase/metabase:latest still retrieves an older version. This causes deployments relying on latest to run outdated Metabase versions.

### To Reproduce

Remove any local Metabase images:
docker image rm metabase/metabase:latest

Pull the image again:
docker pull metabase/metabase:latest

Check the image version or digest.

Compare it with the most recent GitHub release version.

Result: Docker Hub returns an older image than the newest GitHub release.

### Expected behavior

The metabase/metabase:latest tag on Docker Hub should point to the newest stable release that is marked as Latest on GitHub.

### Logs

No runtime logs â€” this is about the Docker Hub image tag.

### Information about your Metabase installation

```JSON
N/A
```

### Severity

Low to Medium â€” Metabase still runs, but the outdated latest tag causes:  incorrect versions in CI/CD flows  confusion for users expecting the newest release  deployments accidentally running older builds

### Additional context

_No response_",searchjaunt,5,"Type:Bug, Priority:P3, Administration/Settings, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66875,2025-12-12T12:33:48Z,2025-12-15T01:14:52Z,negative,bug,medium
3723162433,66874,Dark mode - Account Settings / Theme preference resets to â€œUse system defaultâ€ after logout/login,closed,"### Describe the bug

After changing the preference in Account Settings â†’ Theme (Dark / Light / Use system default), the selection is not persisted across logout/login. 

After logging out, the UI falls back to the system/browser theme (e.g., Dark). 
After logging back in, the theme continue to follows the system theme and the saved preference in Account Settings is reset to Use system default.


### To Reproduce

1. Set your OS/browser theme to Dark (system-level dark mode enabled).
2. Sign in
3. Go to Account Settings â†’ Theme.
4. Select Light, and see the UI switches to Light immediately.
5. Log out.
6. The logged-out UI appears dark again (system default).
7(!). Sign back in, and see the UI continues to be dark.
8(!). In Account Settings â†’ Theme observe it is reset to Use system default.


### Expected behavior

The pereference should be kept across logouts / logins.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk"",
      ""athena"",
      ""h2"",
      ""clickhouse""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-12-11"",
      ""tag"": ""v1.57.6.1"",
      ""hash"": ""7b1a438""
    },
    ""settings"": {
      ""report-timezone"": ""Australia/Melbourne""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

Sever, affects a widely visible feature.

### Additional context

_No response_",zbodi74,0,"Type:Bug, Priority:P2, Administration/Settings, .Escalation, .Team/UXWest, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/66874,2025-12-12T11:58:47Z,2025-12-15T17:55:42Z,negative,bug,high
3721005489,66844,No useful warning when SQL question filters become invalid after database change (save and run buttons disabled),open,"### Describe the bug

## Describe the bug

When changing the database for a SQL question that has field filters (template tags), if the filters reference fields that don't exist in the new database, the play/save buttons become greyed out with no error message or warning explaining why.

The user is left to figure out through trial and error that the filters need to be updated to point to fields in the new database. This is more severe if the user has multiple filters.

### To Reproduce

1. Create a SQL question with field filters (e.g., `{{my_filter}}`) connected to a specific database (like Filtering on State in People table from Sample Database)
2. Save the question
3. Edit the question and change the database to a different one
4. Observe: The play button and save button are greyed out/disabled
5. No error message or warning is displayed explaining why

### Expected behavior

When changing databases for a SQL question with field filters:

1. **Option A (Preferred):** Display a warning message explaining that field filters need to be reconfigured for the new database, with a list of affected filters
2. **Option B:** Display an error message near the disabled buttons explaining why they are disabled (e.g., ""Cannot run query: Field filters are not configured for the selected database"")
3. **Option C:** Automatically clear/reset the field filter mappings when the database changes, allowing the user to reconfigure them (prefer not to do this, as the user may have multiple filters and then wouldn't have a way to reference the new ones they need to create because they would all be cleared)

Currently, the UI provides no feedback, leaving users confused about why they cannot save or run their query.

### Logs

## Logs

No specific logs available since no warnings/errors currently produced. The issue is a UX/frontend problem - the buttons are disabled without explanation.

### Information about your Metabase installation

```JSON
v1.56.x, 1.57.x, and master as of `c32c99e`
```

### Severity

P3: Annoying - Users can work around this by manually updating filters, but the lack of feedback makes troubleshooting difficult and can take time.

### Additional context

- Reported by a customer who was migrating questions between databases
- Customer discovered the fix through trial and error
- This is a UX friction point when field filter configurations become invalid",likeshumidity,1,"Type:Bug, Priority:P3, Querying/Native, .Frontend, .Team/Querying, .Has Repro Steps, Triaged Manually, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66844,2025-12-11T21:24:52Z,,negative,bug,high
3720886272,66843,Breakout on a joined model shows the wrong column - specifc after changes to the model definition and similar field names,open,"### Describe the bug

Choosing implicitly joined columns with the same names as the ones that exist in the initial model brings incorrect fields to the summarization.



 Don't know if this happens for all fields or only keys.

In a customer scenario, a model has subsequent and placed next to each other ""name"" fields (thus they are named as follows: `52: ""name"", 53: ""name_2"", 54: ""name_3""`). Name_2 is the one being brought in the question instead of a field from a table in a question being joined to the model, which is incorrect.


### To Reproduce

1. Create a model joining Accounts + Analytics Events + Invoices from the Sample database
2. Do a count by the IDs from the model and the IDs from the implicitly joined tables
3. See that the fields being brought are incorrect for the implicitly joined tables
<img width=""1048"" height=""828"" alt=""Image"" src=""https://github.com/user-attachments/assets/e6175c52-5a1e-4864-94de-38616eeab691"" />


### Expected behavior
Should bring the correct breakout

### Logs

_No response_

### Information about your Metabase installation

```JSON
-v1.57.4
```

### Severity
p1
",ignacio-mb,4,"Type:Bug, Priority:P1, Querying/MBQL, Difficulty:Hard, .Backend, Querying/Models, .Team/Querying, .Possibly Already Fixed, .Has Repro Steps, Cloud-Blocker:57, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66843,2025-12-11T20:42:03Z,,negative,bug,high
3720566888,66834,Unable to get public link with `enable-public-sharing` enabled,open,"### Describe the bug

The database has `enable-public-sharing` set to `true`:
<img width=""366"" height=""113"" alt=""Image"" src=""https://github.com/user-attachments/assets/eedc390a-5fc2-47c4-b39d-de13abe85094"" />

But the ""Public link"" is grayed out:
<img width=""259"" height=""150"" alt=""Image"" src=""https://github.com/user-attachments/assets/f77465a8-5b8a-4716-b006-39bd9128a6f3"" />

And the admin page shows that it's disabled:
<img width=""214"" height=""115"" alt=""Image"" src=""https://github.com/user-attachments/assets/8313140c-f9e4-4f9a-8e97-c88f78a92670"" />

I can set it to 'Enabled' and refresh the page and it reverts back to 'Disabled' even though it's enabled in the database. I can 'Disable' it again in the Admin UI and it changes the flag in the database so it's able to write to the database fine.

I see the same issue for all settings in my admin panel. The settings have values in the database but the UI shows as blank:
<img width=""752"" height=""342"" alt=""Image"" src=""https://github.com/user-attachments/assets/ffe95321-9459-4a93-84b8-988144ff03ae"" />


Looking at the `https://metabasedash.renderbetter.net/api/setting` API call I see that the settings value is returning as `null`:

```JSON
 {
        ""key"": ""enable-public-sharing"",
        ""value"": null,
        ""is_env_setting"": false,
        ""env_name"": ""MB_ENABLE_PUBLIC_SHARING"",
        ""description"": ""Enable admins to create publicly viewable links (and embeddable iframes) for Questions and Dashboards?"",
        ""default"": true
    },
```



### To Reproduce

1. Go to 'Admin Settings'
2. Change any value
3. Refresh the page
4. See that the UI doesn't show the values but the database is updated


### Expected behavior

The database settings values should affect the front end. 

### Logs

2025-12-11T11:43:00-07:00 DEBUG metabase.server.middleware.log GET /api/setting 200 162ms (15 DB calls) App DB connections: 1/15 Jetty threads: 6/50 (3 idle, 0 queued) (136 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}


### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk"",
      ""h2"",
      ""clickhouse""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-11-19"",
      ""tag"": ""v0.57.3"",
      ""hash"": ""6b828bd""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.19""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.0-1041-azure"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Blocking use for new queries. Old queries that are already public shared are still working

### Additional context

_No response_",LukePammant,4,"Type:Bug, Priority:P2, .Unable to Reproduce, .Frontend, Administration/Settings, .Product Input Needed, Sharing/Public, .Team/UXWest, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66834,2025-12-11T18:47:11Z,,negative,bug,high
3720566225,66833,Conditional Formatting affected rows with dark colors are unreadable in Subscriptions,open,"### Describe the bug

Conditional Formatting affected rows with dark colors are unreadable in Subscriptions. 

<img width=""887"" height=""598"" alt=""Image"" src=""https://github.com/user-attachments/assets/dfb64b51-78e9-41b7-9773-6b648a7adbeb"" />

### To Reproduce

1. Go to Admin settings > General > Appeareance > change default colors to dark colors for the purpose of the reproduction of the bug
2. Set up a dashboard with a card, give that card conditional formatting with dark colors
3. Send via email. See that rows are unreadable

### Expected behavior

Color of values should be set to a lighter color for better contrast

### Logs

_No response_

### Information about your Metabase installation

```JSON
- v.1.57.4
```

### Severity

p3

### Additional context

_No response_",ignacio-mb,0,"Type:Bug, Priority:P3, Reporting/Pulses, .Frontend, .Backend, Visualization/Static, .Team/UXWest",https://github.com/metabase/metabase/issues/66833,2025-12-11T18:47:03Z,,negative,bug,medium
3720417436,66829,Show path to collection while looking at a collection,open,"**Is your feature request related to a problem? Please describe.**
I'm frustrated when I cannot see the path to the collection that I'm in. It makes it difficult to step back one collection. This is painful when collections are nested. 

**Describe the solution you'd like**
To see the path to the collection that I'm on, similar to how I can see the path to the dashboard that I'm on. 

**Describe alternatives you've considered**
Bookmarking your most used collections helps. Alternatively, you can avoid highly nested collections. 

**How important is this feature to you?**
It'd be nice! 
",afleming9796,0,"Type:New Feature, Organization/Collections, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66829,2025-12-11T18:00:55Z,,negative,feature_request,medium
3719084175,66810,Serialization export produces empty directories in v1.56.17 (Enterprise Edition),closed,"# Metabase Serialization Export Produces Empty Directories (v1.56.17)

## Summary
The `metabase.jar export` command completes successfully with ""Export complete! ðŸš›ðŸ’¨ ðŸ“¦"" message but produces empty directories with no files, regardless of export parameters. This affects all export modes: specific collections, all collections, and exports with/without filters.

## Environment

### Metabase Version
- **Version**: v1.56.17 (1d4f18f)
- **Build Date**: 2025-11-26
- **Edition**: Enterprise Edition
- **Deployment**: Docker (`metabase/metabase-enterprise:v1.56.17`)

### System Information
- **OS**: Linux 6.14.0-1016-aws amd64 (Amazon EC2)
- **Java**: OpenJDK 64-Bit Server VM 21.0.9 (Temurin-21.0.9+10)
- **Application Database**: PostgreSQL 17.4 (Debian 17.4-1.pgdg120+2)
- **Memory**: 8GB allocated (`-Xmx8g`)

### Metabase Content
- **Collections**: 101 total (39 non-personal, 62 personal)
- **Cards/Questions**: 1,268
- **Dashboards**: 181
- **Connected Databases**:
  - SQL Server
  - PostgreSQL (internal)
  - Amazon Redshift

## Issue Description

All export commands complete without errors but create empty directories. The export process logs warnings about circular dependencies and cards from personal collections, but even exports without those dependencies produce zero files.

### Last Known Working Export
- **Date**: April 17, 2025 (timestamp: 1744877001)
- **Files**: 20,781 files successfully exported
- **Format**: YAML files in proper directory structure
- **Metabase Version**: v1.56.x (likely earlier patch version)

## Reproduction Steps

### Attempt 1: Export All Content
```bash
docker exec metabase java --add-opens java.base/java.nio=ALL-UNNAMED \
  -jar /app/metabase.jar export /app/db/metabase_export_all \
  --include-database-secrets
```

**Result**: Empty directory (0 files)

### Attempt 2: Export Specific Collections
```bash
docker exec metabase java --add-opens java.base/java.nio=ALL-UNNAMED \
  -jar /app/metabase.jar export /app/db/metabase_export_selected \
  --collection 147 --collection 108 --collection 224 \
  --collection 120 --collection 148 \
  --include-database-secrets --include-field-values
```

**Result**: Empty directory (0 files)

### Attempt 3: Export with Dependencies
```bash
docker exec metabase java --add-opens java.base/java.nio=ALL-UNNAMED \
  -jar /app/metabase.jar export /app/db/metabase_export_with_deps \
  --collection 147 --collection 109 --collection 101 \
  --include-database-secrets --include-field-values
```

**Result**: Empty directory (0 files)

### Attempt 4: Export Single Collection
```bash
docker exec metabase java --add-opens java.base/java.nio=ALL-UNNAMED \
  -jar /app/metabase.jar export /app/db/export_147_only \
  --collection 147 --include-database-secrets
```

**Result**: Empty directory (0 files)

### Attempt 5: Export Without Collections Flag
```bash
docker exec metabase java --add-opens java.base/java.nio=ALL-UNNAMED \
  -jar /app/metabase.jar export /app/db/test_export \
  --no-collections
```

**Result**: Directory not created at all (exit code 2)

## Expected Behavior

Export should create a directory structure containing:
- `collections/` directory with subdirectories for each collection
- `databases/` directory with database metadata
- `settings.yaml` file with Metabase settings
- YAML files for dashboards, questions, models, metrics, segments

Example of expected structure from working April 2025 export:
```
export_1744877001/
â”œâ”€â”€ settings.yaml
â”œâ”€â”€ collections/
â”‚   â”œâ”€â”€ 2E4S72mchT4meo3Yz4ONB_models/
â”‚   â”‚   â”œâ”€â”€ 2E4S72mchT4meo3Yz4ONB_models.yaml
â”‚   â”‚   â””â”€â”€ cards/
â”‚   â”‚       â”œâ”€â”€ 1AfVcN_vQETi2js0eybyw_proactive_outreach_diagnosis_list.yaml
â”‚   â”‚       â””â”€â”€ ... (more cards)
â””â”€â”€ databases/
    â””â”€â”€ VBA SQL Server/
        â”œâ”€â”€ VBA SQL Server.yaml
        â””â”€â”€ schemas/
            â””â”€â”€ ... (more files)
```

## Actual Behavior

All exports produce empty directories:
```bash
$ find metabase/metabase_export_all -type f | wc -l
0

$ ls -la metabase/metabase_export_all/
total 8
drwxr-xr-x  2 root   root   4096 Dec 11 11:47 .
drwxrwxr-x 12 ubuntu ubuntu 4096 Dec 11 11:47 ..
```

The export process reports success:
```
2025-12-11 11:47:25,769 INFO serialization.cmd :: Export to '/app/db/metabase_export_all' complete! ðŸš›ðŸ’¨ ðŸ“¦
```

## Warnings in Export Logs

The export process generates warnings about:

1. **Dashboards with cards from outside requested collections**:
```
2025-12-11 11:47:25,643 WARN v2.extract :: Failed to export Dashboard 69 (Person overview) 
containing Card saved outside requested collections: Card 637 (Last downloads from collection 69: 
Usage analytics), Card 233 (Last viewed tables from collection 69: Usage analytics), ...
```

2. **Cards based on questions outside requested collections**:
```
2025-12-11 11:47:25,757 WARN v2.extract :: Failed to export Cards based on questions outside 
requested collections: Card 254 (Member of from collection 69: Usage analytics) -> 
Card 205 (Group Members from collection 69: Usage analytics), ...
```

3. **Redshift driver loading error** (appears to be non-fatal):
```
Caused by: java.io.FileNotFoundException: Could not locate metabase/driver/redshift__init.class, 
metabase/driver/redshift.clj or metabase/driver/redshift.cljc on classpath.
```

## Additional Context

### Collection Dependencies
Collection 147 (Dashboards) has complex dependencies:
- Contains 35 dashboards
- Dashboards reference cards from collection 109 (Questions)
- Questions reference models from collection 101 (Models)
- Some cards depend on collection 225 (v0)

Even when exporting all dependency collections together (147, 109, 101, 225), the export still produces zero files with only 1 warning:
```
2025-12-11 11:54:26,933 WARN v2.extract :: Failed to export Cards based on questions outside 
requested collections: Card 1194 (Claim Summary Model from collection 101: Models) -> 
Card 848 (Claim Summary from collection 109: Questions)
```

### Docker Volume Mounts
```yaml
volumes:
  - ~/databases/:/databases/
  - ~/metabase/:/app/db/
  - ~/metabase/plugins:/plugins
```

Export paths like `/app/db/metabase_export_*` map to `~/metabase/metabase_export_*` on the host, which are confirmed to be empty directories.

### Export File Verification
```bash
# Check inside container
$ docker exec metabase ls -la /app/db/metabase_export_20251211_110227/
total 8
drwxr-xr-x 2 root root 4096 Dec 11 11:02 .
drwxrwxr-x 8 1000 1000 4096 Dec 11 11:02 ..

# Check on host
$ ls -la ~/metabase/metabase_export_20251211_110227/
total 8
drwxr-xr-x  2 root   root   4096 Dec 11 11:02 .
drwxrwxr-x  7 ubuntu ubuntu 4096 Dec 11 11:02 ..

# Find files
$ find ~/metabase/metabase_export_20251211_110227 -type f | wc -l
0
```

## Impact

- **Severity**: High - Serialization feature is completely non-functional
- **Affected Use Cases**:
  - Version control of Metabase content
  - Staging-to-production workflows
  - Backup and disaster recovery
  - Content migration between instances
- **Workarounds Attempted**:
  - API endpoint export (not tested yet)
  - Direct PostgreSQL database export (has circular foreign key constraints)
  - Manual JSON extraction from database (requires custom tooling)

## Regression Evidence

The same Metabase instance successfully exported 20,781 files in April 2025 using (presumably) an earlier v1.56.x patch version. The export structure and format were correct:

```bash
$ tar -tzf export_1744877001.tar.gz | wc -l
20781

$ tar -tzf export_1744877001.tar.gz | head -10
export_1744877001/
export_1744877001/settings.yaml
export_1744877001/databases/
export_1744877001/databases/VBA SQL Server/
export_1744877001/databases/VBA SQL Server/VBA SQL Server.yaml
export_1744877001/databases/VBA SQL Server/schemas/
export_1744877001/databases/VBA SQL Server/schemas/dbo/
export_1744877001/databases/VBA SQL Server/schemas/dbo/tables/
...
```

This suggests the issue was introduced between April 2025 and the current v1.56.17 release (November 26, 2025).

## Questions

1. Are there any known issues with serialization in v1.56.17?
2. Could the Redshift driver loading error affect the export process?
3. Are there any additional flags or configuration required for exports to work with PostgreSQL application database?
4. Is there a way to enable debug logging for the serialization process?
5. Should we consider downgrading to an earlier v1.56.x version?

## Related Documentation

- [Metabase Serialization Docs](https://www.metabase.com/docs/latest/installation-and-operation/serialization)
- [Export CLI Command](https://www.metabase.com/docs/latest/installation-and-operation/serialization#serialization-with-cli-commands)

## Request

Please investigate why exports are producing empty directories despite successful completion messages. This is blocking our ability to version control Metabase content and maintain proper staging workflows.
",maksimf,0,"Type:Bug, Priority:P2, .Regression, Operation/Serialization, .Team/UXWest",https://github.com/metabase/metabase/issues/66810,2025-12-11T11:58:33Z,2025-12-12T22:12:25Z,negative,bug,high
3719014852,66809,METABSE DATA CONNECTION ISSUE,closed,"**Describe the bug**
I AM UNABLE TO CONNECT MY NEW DATASOURCES AFTER THE METABASE IS UPDATED, ITS ONLY SYSNCING AND SYNCING NO MOVING FOREWARD

**Logs**
[dfa38aec-e8c1-4718-a8e2-b79c0e27a696] 2025-12-11T16:51:09+05:30 INFO metabase.sync.util STARTING: Sync metadata for mysql Database 91 ''Indus Towers-ANALYTICS'' (free: 0.64G, total: 1.15G, ratio: 0.56)
[dfa38aec-e8c1-4718-a8e2-b79c0e27a696] 2025-12-11T16:51:09+05:30 WARN metabase.sync.util Error in sync step Sync metadata for mysql Database 91 ''Indus Towers-ANALYTICS'',java.sql.SQLTransientConnectionException: (conn=16777222) Getting syntax error at line 1, column 16. Detail message: No viable statement for input 'SHOW GRANTS FOR CURRENT_USER'.,	at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:79),	at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.create(ExceptionFactory.java:158),	at org.mariadb.jdbc.MariaDbStatement.executeExceptionEpilogue(MariaDbStatement.java:262),	at org.mariadb.jdbc.ClientSidePreparedStatement.executeInternal(ClientSidePreparedStatement.java:229),	at org.mariadb.jdbc.ClientSidePreparedStatement.execute(ClientSidePreparedStatement.java:149),	at org.mariadb.jdbc.ClientSidePreparedStatement.executeQuery(ClientSidePreparedStatement.java:163),	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:1185),	at clojure.java.jdbc$execute_query_with_params.invokeStatic(jdbc.clj:1090),	at clojure.java.jdbc$execute_query_with_params.invoke(jdbc.clj:1084),	at clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1106),	at clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093),	at clojure.java.jdbc$query.invokeStatic(jdbc.clj:1182),	at clojure.java.jdbc$query.invoke(jdbc.clj:1144),	at metabase.driver.mysql$privilege_grants_for_user$query__118533.invoke(mysql.clj:1017),	at metabase.driver.mysql$privilege_grants_for_user.invokeStatic(mysql.clj:1020),	at metabase.driver.mysql$privilege_grants_for_user.invoke(mysql.clj:1011),	at metabase.driver.mysql$fn__118190.invokeStatic(mysql.clj:205),	at metabase.driver.mysql$fn__118190.doInvoke(mysql.clj:197),	at clojure.lang.RestFn.invoke(RestFn.java:428)
[dfa38aec-e8c1-4718-a8e2-b79c0e27a696] 2025-12-11T16:51:09+05:30 INFO metabase.sync.util FINISHED: Sync metadata for mysql Database 91 ''Indus Towers-ANALYTICS'' (185.5 ms) (free: 0.64G, total: 1.15G, ratio: 0.56)

**To Reproduce**
Steps to reproduce the behavior:
1. Go to DATASOURCE
2. Click on ADD DATASOURCE
3. TRY ADDING A DATA SOURCE OR SYNCING THE OLDER DATASOURCE THROUGH THE METABASE ADMIN

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Severity**
SERIOUS BUG

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk"",
      ""h2"",
      ""clickhouse"",
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-11-19"",
      ""tag"": ""v0.57.3"",
      ""hash"": ""6b828bd""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.14""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.7""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.9+10-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.9"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.9+10-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.6.105+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Asia/Kolkata""
  }
}
```",faran-alam11,3,,https://github.com/metabase/metabase/issues/66809,2025-12-11T11:39:12Z,2025-12-11T22:55:41Z,negative,bug,high
3718871300,66808,Automatically connect dashbaord filters when changing the visualization and Saving as new,open,"**Is your feature request related to a problem? Please describe.**
When I open an existing question on a dashboard connected to dashboard filters, change its visualization and save as new on the dashboard, the new question is not automatically connected to the dashboard filters. 

**Describe the solution you'd like**
When saving a visualization as a new question, automatically copy over the existing dashboard filter mappings.

**Describe alternatives you've considered**
Manually reconnecting each dashboard filter to the new card.

**Additional context**
Customer ask
",Raka1104,0,"Reporting/Dashboards, Type:New Feature, Reporting/Dashboards/Filters & Parameters, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66808,2025-12-11T10:56:55Z,,neutral,feature_request,medium
3718770757,66807,[SDK] Embedded InteractiveDashboard/InteractiveQuestion with numeric ID passed as string doesn't drill down,closed,"### Describe the bug

Drill-down doesn't work when you you use a Numeric ID as string:

I.e. passing a `<InteractiveDashboard dashboardId=""1"" />` instead of  `<InteractiveDashboard dashboardId=1 />`

### To Reproduce

Setup the SDK and pass a Dashboard ID as a string to the InteractiveDashboard or InteractiveQuestion component

`<InteractiveDashboard dashboardId=""1"" />`

Drill down stops working

### Expected behavior

Drill down works for both ID when passed as numeric or string

### Logs

None that relevant

### Information about your Metabase installation

```JSON
1.57 but works on 56
```

### Severity

Breaks 56 to 57 SDK upgrades

### Additional context

More context here https://metaboat.slack.com/archives/C06FCQT0KMZ/p1765273966672359",Tony-metabase,3,"Type:Bug, Priority:P1, .Team/Embedding, Embedding/SDK, sdk_quality",https://github.com/metabase/metabase/issues/66807,2025-12-11T10:29:07Z,2025-12-12T09:27:40Z,negative,bug,high
3718648280,66805,Custom Size/Layout Filter,open,"**Is your feature request related to a problem? Please describe.**
It would be great if we can adjust the layout and size of the filters. So user can have a clear way to find the filter quickly. We always have more than 10 filters due to the business nature. All the filters just stick together and the position would be changed along with the screen size is a bit annoying (sometimes the filter would be on line 1 in a 27"" screen but would be on the second even third line on a 14"" laoptop screen.)

**Describe the solution you'd like**
Like the filters in Looker Studio, we can adjust the size freely. 
<img width=""1209"" height=""327"" alt=""Image"" src=""https://github.com/user-attachments/assets/a1d3fa83-be09-4211-b16f-f843aaa23ec2"" />

**Describe alternatives you've considered**
Able to break to a new line before there are enough filters to take up all the space, or able to add divider between filters would be a good starting point.

**How important is this feature to you?**
User always complain dashboard on metabase looks too complicated but not on Looker Studio even they have the same amount of filters.

",moonbug-car,0,"Reporting/Dashboards, Type:New Feature, Reporting/Dashboards/Filters & Parameters, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66805,2025-12-11T09:55:55Z,,negative,feature_request,medium
3717529575,66798,Type errors are appearing on Scalar viz,closed,"Link to [Stats](https://stats.metabase.com/dashboard/4246-hosting-insights-instance-summary-all-tables?active_records%253F=true&instance_domain=&tab=2146-app-db&text=running&text=creating)

### Description
getting these errors when the dashboard loads:

71
app-main.ac0abc18001â€¦8d.js:sourcemap:462 Error getting setting scalar.field TypeError: Cannot read properties of undefined (reading 'name')
    at Object.getDefault (app-main.ac0abc18001â€¦sourcemap:522:53935)
    at e (app-main.ac0abc18001â€¦ourcemap:462:135130)
    at W (app-main.ac0abc18001â€¦ourcemap:462:135271)
    at m (app-main.ac0abc18001â€¦ourcemap:462:158993)
    at app-main.ac0abc18001â€¦sourcemap:128:21557
    at a5 (app-main.ac0abc18001â€¦sourcemap:128:21543)
74
app-main.ac0abc18001â€¦8d.js:sourcemap:462 Error getting setting scalar.field TypeError: Cannot read properties of undefined (reading 'name')
    at Object.getDefault (app-main.ac0abc18001â€¦sourcemap:522:53935)
    at e (app-main.ac0abc18001â€¦ourcemap:462:135130)
    at W (app-main.ac0abc18001â€¦ourcemap:462:135271)
    at m (app-main.ac0abc18001â€¦ourcemap:462:158993)
    at app-main.ac0abc18001â€¦sourcemap:128:21557
    at a5 (app-main.ac0abc18001â€¦sourcemap:128:21543)



### Links
- Slack File: https://metaboat.slack.com/files/U02T6V8MXN2/F0A2G8LLD1C/diagnostic-info.json
",npfitz,0,"Type:Bug, Priority:P2, Visualization/Scalars, .Team/UXWest",https://github.com/metabase/metabase/issues/66798,2025-12-11T02:58:25Z,2025-12-17T21:22:18Z,negative,bug,high
3716685679,66781,Query fails when using a field from a different table which has CLS,closed,"### Describe the bug

Metabase seems to be building the query with all the fields on an inner query, and not the ones that are configured on the CLS

### To Reproduce

As an admin
1) create 2 questions: orders cls (remove the total field) and people cls (remove the email field)
2) create a new group named ""CLS"" and create a user as well, add this user to the ""CLS"" group and add an attribute to this user named user_id = 1
3) now go to the permissions setting and configure column level security on orders using the ""orders cls"" table AND use the user_id parameter to filter on the orders of the user. Also configure column level security on people using the ""people cls"" question (also use the user_id param to filter on these user id)
4) create a question based on the orders table, just do a sum of quantity. save it

as the user you created on step 2:
1) go to the question you created on step 4 before, see the error

```
2025-12-10 20:30:54.273 UTC [3968] ERROR:  column source.email does not exist at character 525
2025-12-10 20:30:54.273 UTC [3968] STATEMENT:  -- Metabase:: userID: 2 queryType: MBQL queryHash: 4eb6cb6b9896f3cdbddf983ed223328f193ee9b00ecbb8f6a5f235bb210b9bc7
        SELECT SUM(""source"".""quantity"") AS ""sum"" FROM (SELECT ""public"".""orders"".""id"" AS ""id"", ""public"".""orders"".""user_id"" AS ""user_id"", ""public"".""orders"".""product_id"" AS ""product_id"", ""public"".""orders"".""subtotal"" AS ""subtotal"", ""public"".""orders"".""created_at"" AS ""created_at"", ""public"".""orders"".""quantity"" AS ""quantity"" FROM ""public"".""orders"" LEFT JOIN (SELECT ""source"".""id"" AS ""id"", ""source"".""address"" AS ""address"", ""source"".""email"" AS ""email"", ""source"".""password"" AS ""password"", ""source"".""name"" AS ""name"", ""source"".""city"" AS ""city"", ""source"".""longitude"" AS ""longitude"", ""source"".""state"" AS ""state"", ""source"".""source"" AS ""source"", ""source"".""birth_date"" AS ""birth_date"", ""source"".""zip"" AS ""zip"", ""source"".""latitude"" AS ""latitude"", ""source"".""created_at"" AS ""created_at"" FROM (SELECT ""public"".""people"".""id"" AS ""id"", ""public"".""people"".""address"" AS ""address"", ""public"".""people"".""password"" AS ""password"", ""public"".""people"".""city"" AS ""city"", ""public"".""people"".""longitude"" AS ""longitude"", ""public"".""people"".""state"" AS ""state"", ""public"".""people"".""source"" AS ""source"", ""public"".""people"".""birth_date"" AS ""birth_date"", ""public"".""people"".""zip"" AS ""zip"", ""public"".""people"".""latitude"" AS ""latitude"", ""public"".""people"".""created_at"" AS ""created_at"" FROM ""public"".""people"" WHERE ""public"".""people"".""id"" = 1) AS ""source"") AS ""people__via__user_id"" ON ""public"".""orders"".""user_id"" = ""people__via__user_id"".""id"" WHERE ""people__via__user_id"".""id"" = 1) AS ""source""
```

### Expected behavior

We should compile the query correctly either bringing only the fields that are needed for the query to run?

### Logs

```
2025-12-10 20:30:54,349 ERROR middleware.catch-exceptions :: Error processing query: ERROR: column source.email does not exist
  Position: 525
{:database_id 1,
 :parameterized false,
 :started_at #t ""2025-12-10T20:30:54.172224992Z[GMT]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""Error executing query: ERROR: column source.email does not exist\n  Position: 525"",
   :stacktrace
   [""--> driver.sql_jdbc.execute$execute_reducible_query$fn__93569$fn__93570.invoke(execute.clj:770)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__93569.invoke(execute.clj:767)""
    ""driver.sql_jdbc.execute$fn__93344$fn__93345.invoke(execute.clj:422)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:347)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:327)""
    ""driver.sql_jdbc.execute$fn__93344.invokeStatic(execute.clj:416)""
    ""driver.sql_jdbc.execute$fn__93344.invoke(execute.clj:414)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:760)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:749)""
    ""driver.sql_jdbc$fn__98254.invokeStatic(sql_jdbc.clj:87)""
    ""driver.sql_jdbc$fn__98254.invoke(sql_jdbc.clj:85)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:59)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:44)""
    ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:119)""
    ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:108)""
    ""query_processor.execute$run.invokeStatic(execute.clj:72)""
    ""query_processor.execute$run.invoke(execute.clj:62)""
    ""metabase_enterprise.database_routing.middleware$fn__147568$swap_destination_db__147569$fn__147570.invoke(middleware.clj:32)""
    ""query_processor.middleware.enterprise$swap_destination_db_middleware$fn__78963.invoke(enterprise.clj:75)""
    ""metabase_enterprise.impersonation.middleware$fn__134506$apply_impersonation_postprocessing__134507$fn__134508.invoke(middleware.clj:35)""
    ""query_processor.middleware.enterprise$apply_impersonation_postprocessing_middleware$fn__78945.invoke(enterprise.clj:50)""
    ""query_processor.middleware.update_used_cards$update_used_cards_BANG_$fn__80735.invoke(update_used_cards.clj:67)""
    ""query_processor.execute$add_native_form_to_result_metadata$fn__80775.invoke(execute.clj:27)""
    ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__80782.invoke(execute.clj:39)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___80671.invoke(cache.clj:246)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__73625.invoke(permissions.clj:153)""
    ""metabase_enterprise.advanced_permissions.query_processor.middleware.permissions$fn__136247$oss_or_ee_fn__47344__auto____136248$fn__136249.invoke(permissions.clj:90)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__78973.invoke(enterprise.clj:92)""
    ""query_processor.execute$execute$fn__80814.invoke(execute.clj:99)""
    ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:232)""
    ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)""
    ""query_processor.execute$execute.invokeStatic(execute.clj:98)""
    ""query_processor.execute$execute.invoke(execute.clj:94)""
    ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:50)""
    ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:45)""
    ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__93788$handle_audit_app_internal_queries__93789$fn__93790.invoke(handle_audit_queries.clj:143)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__79001.invoke(enterprise.clj:131)""
    ""query_processor.middleware.process_userland_query$process_userland_query_middleware$fn__85492.invoke(process_userland_query.clj:181)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__85552.invoke(catch_exceptions.clj:139)""
    ""query_processor$process_query$fn__85592.invoke(query_processor.clj:81)""
    ""query_processor.setup$do_with_canceled_chan$fn__80074.invoke(setup.clj:194)""
    ""query_processor.setup$do_with_database_local_settings$fn__80069.invoke(setup.clj:188)""
    ""query_processor.setup$do_with_driver$fn__80060$fn__80061.invoke(setup.clj:173)""
    ""driver$do_with_driver.invokeStatic(driver.clj:54)""
    ""driver$do_with_driver.invoke(driver.clj:49)""
    ""query_processor.setup$do_with_driver$fn__80060.invoke(setup.clj:172)""
    ""query_processor.setup$do_with_metadata_provider$fn__80052.invoke(setup.clj:137)""
    ""query_processor.setup$do_with_resolved_database$fn__80044.invoke(setup.clj:125)""
    ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:240)""
    ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)""
    ""query_processor$process_query.invokeStatic(query_processor.clj:79)""
    ""query_processor$process_query.invoke(query_processor.clj:72)""
    ""query_processor.card$process_query_for_card_default_qp.invokeStatic(card.clj:235)""
    ""query_processor.card$process_query_for_card_default_qp.invoke(card.clj:231)""
    ""query_processor.card$process_query_for_card_default_run_fn$fn__88760$fn__88761.invoke(card.clj:243)""
    ""query_processor.streaming$_streaming_response$fn__65606$fn__65607$fn__65608.invoke(streaming.clj:225)""
    ""query_processor.streaming$_streaming_response$fn__65606$fn__65607.invoke(streaming.clj:223)""
    ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:214)""
    ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:201)""
    ""query_processor.streaming$_streaming_response$fn__65606.invoke(streaming.clj:220)""
    ""server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:83)""
    ""server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:81)""
    ""server.streaming_response$do_f_async$task__57166.invoke(streaming_response.clj:98)""],
   :error_type :invalid-query,
   :ex-data
   {:driver :postgres,
    :sql
    [""-- Metabase:: userID: 2 queryType: MBQL queryHash: 4eb6cb6b9896f3cdbddf983ed223328f193ee9b00ecbb8f6a5f235bb210b9bc7""
     ""SELECT""
     ""  SUM(\""source\"".\""quantity\"") AS \""sum\""""
     ""FROM""
     ""  (""
     ""    SELECT""
     ""      \""public\"".\""orders\"".\""id\"" AS \""id\"",""
     ""      \""public\"".\""orders\"".\""user_id\"" AS \""user_id\"",""
     ""      \""public\"".\""orders\"".\""product_id\"" AS \""product_id\"",""
     ""      \""public\"".\""orders\"".\""subtotal\"" AS \""subtotal\"",""
     ""      \""public\"".\""orders\"".\""created_at\"" AS \""created_at\"",""
     ""      \""public\"".\""orders\"".\""quantity\"" AS \""quantity\""""
     ""    FROM""
     ""      \""public\"".\""orders\""""
     ""      LEFT JOIN (""
     ""        SELECT""
     ""          \""source\"".\""id\"" AS \""id\"",""
     ""          \""source\"".\""address\"" AS \""address\"",""
     ""          \""source\"".\""email\"" AS \""email\"",""
     ""          \""source\"".\""password\"" AS \""password\"",""
     ""          \""source\"".\""name\"" AS \""name\"",""
     ""          \""source\"".\""city\"" AS \""city\"",""
     ""          \""source\"".\""longitude\"" AS \""longitude\"",""
     ""          \""source\"".\""state\"" AS \""state\"",""
     ""          \""source\"".\""source\"" AS \""source\"",""
     ""          \""source\"".\""birth_date\"" AS \""birth_date\"",""
     ""          \""source\"".\""zip\"" AS \""zip\"",""
     ""          \""source\"".\""latitude\"" AS \""latitude\"",""
     ""          \""source\"".\""created_at\"" AS \""created_at\""""
     ""        FROM""
     ""          (""
     ""            SELECT""
     ""              \""public\"".\""people\"".\""id\"" AS \""id\"",""
     ""              \""public\"".\""people\"".\""address\"" AS \""address\"",""
     ""              \""public\"".\""people\"".\""password\"" AS \""password\"",""
     ""              \""public\"".\""people\"".\""city\"" AS \""city\"",""
     ""              \""public\"".\""people\"".\""longitude\"" AS \""longitude\"",""
     ""              \""public\"".\""people\"".\""state\"" AS \""state\"",""
     ""              \""public\"".\""people\"".\""source\"" AS \""source\"",""
     ""              \""public\"".\""people\"".\""birth_date\"" AS \""birth_date\"",""
     ""              \""public\"".\""people\"".\""zip\"" AS \""zip\"",""
     ""              \""public\"".\""people\"".\""latitude\"" AS \""latitude\"",""
     ""              \""public\"".\""people\"".\""created_at\"" AS \""created_at\""""
     ""            FROM""
     ""              \""public\"".\""people\""""
     ""            WHERE""
     ""              \""public\"".\""people\"".\""id\"" = 1""
     ""          ) AS \""source\""""
     ""      ) AS \""people__via__user_id\"" ON \""public\"".\""orders\"".\""user_id\"" = \""people__via__user_id\"".\""id\""""
     ""    WHERE""
     ""      \""people__via__user_id\"".\""id\"" = 1""
     ""  ) AS \""source\""""],
    :params nil,
    :type :invalid-query}}],
 :action_id nil,
 :state ""42703"",
 :error_type :invalid-query,
 :json_query
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :lib/type :mbql/query,
  :lib/metadata
  (metabase.lib.metadata.invocation-tracker/invocation-tracker-provider (metabase.lib.metadata.cached-provider/cached-metadata-provider (metabase.lib-be.metadata.jvm/->UncachedApplicationDatabaseMetadataProvider 1))),
  :stages
  [{:lib/type :mbql.stage/mbql,
    :source-table 16,
    :aggregation
    [[:sum
      {:lib/uuid ""aa056483-83c0-49a5-a965-000bdb0fc1e6""}
      [:field
       {:lib/uuid ""80bb3c43-ffab-47c4-b8a1-fe9a450823db"", :effective-type :type/Integer, :base-type :type/Integer}
       211]]]}],
  :middleware {:js-int-to-string? true, :ignore-cached-results? false, :userland-query? true},
  :cache-strategy nil,
  :viz-settings {},
  :database 1},
 :status :failed,
 :class org.postgresql.util.PSQLException,
 :stacktrace
 [""org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2734)""
  ""org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2421)""
  ""org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)""
  ""org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:518)""
  ""org.postgresql.jdbc.PgStatement.execute(PgStatement.java:435)""
  ""org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:357)""
  ""org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:342)""
  ""org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:318)""
  ""org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)""
  ""com.mchange.v2.c3p0.impl.NewProxyStatement.execute(NewProxyStatement.java:1341)""
  ""--> driver.sql_jdbc.execute$fn__93475.invokeStatic(execute.clj:582)""
  ""driver.sql_jdbc.execute$fn__93475.invoke(execute.clj:580)""
  ""driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invokeStatic(execute.clj:590)""
  ""driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invoke(execute.clj:587)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__93569$fn__93570.invoke(execute.clj:768)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__93569.invoke(execute.clj:767)""
  ""driver.sql_jdbc.execute$fn__93344$fn__93345.invoke(execute.clj:422)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:347)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:327)""
  ""driver.sql_jdbc.execute$fn__93344.invokeStatic(execute.clj:416)""
  ""driver.sql_jdbc.execute$fn__93344.invoke(execute.clj:414)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:760)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:749)""
  ""driver.sql_jdbc$fn__98254.invokeStatic(sql_jdbc.clj:87)""
  ""driver.sql_jdbc$fn__98254.invoke(sql_jdbc.clj:85)""
  ""query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:59)""
  ""query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:44)""
  ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:119)""
  ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:108)""
  ""query_processor.execute$run.invokeStatic(execute.clj:72)""
  ""query_processor.execute$run.invoke(execute.clj:62)""
  ""metabase_enterprise.database_routing.middleware$fn__147568$swap_destination_db__147569$fn__147570.invoke(middleware.clj:32)""
  ""query_processor.middleware.enterprise$swap_destination_db_middleware$fn__78963.invoke(enterprise.clj:75)""
  ""metabase_enterprise.impersonation.middleware$fn__134506$apply_impersonation_postprocessing__134507$fn__134508.invoke(middleware.clj:35)""
  ""query_processor.middleware.enterprise$apply_impersonation_postprocessing_middleware$fn__78945.invoke(enterprise.clj:50)""
  ""query_processor.middleware.update_used_cards$update_used_cards_BANG_$fn__80735.invoke(update_used_cards.clj:67)""
  ""query_processor.execute$add_native_form_to_result_metadata$fn__80775.invoke(execute.clj:27)""
  ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__80782.invoke(execute.clj:39)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___80671.invoke(cache.clj:246)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__73625.invoke(permissions.clj:153)""
  ""metabase_enterprise.advanced_permissions.query_processor.middleware.permissions$fn__136247$oss_or_ee_fn__47344__auto____136248$fn__136249.invoke(permissions.clj:90)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__78973.invoke(enterprise.clj:92)""
  ""query_processor.execute$execute$fn__80814.invoke(execute.clj:99)""
  ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:232)""
  ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)""
  ""query_processor.execute$execute.invokeStatic(execute.clj:98)""
  ""query_processor.execute$execute.invoke(execute.clj:94)""
  ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:50)""
  ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:45)""
  ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__93788$handle_audit_app_internal_queries__93789$fn__93790.invoke(handle_audit_queries.clj:143)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__79001.invoke(enterprise.clj:131)""
  ""query_processor.middleware.process_userland_query$process_userland_query_middleware$fn__85492.invoke(process_userland_query.clj:181)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__85552.invoke(catch_exceptions.clj:139)""
  ""query_processor$process_query$fn__85592.invoke(query_processor.clj:81)""
  ""query_processor.setup$do_with_canceled_chan$fn__80074.invoke(setup.clj:194)""
  ""query_processor.setup$do_with_database_local_settings$fn__80069.invoke(setup.clj:188)""
  ""query_processor.setup$do_with_driver$fn__80060$fn__80061.invoke(setup.clj:173)""
  ""driver$do_with_driver.invokeStatic(driver.clj:54)""
  ""driver$do_with_driver.invoke(driver.clj:49)""
  ""query_processor.setup$do_with_driver$fn__80060.invoke(setup.clj:172)""
  ""query_processor.setup$do_with_metadata_provider$fn__80052.invoke(setup.clj:137)""
  ""query_processor.setup$do_with_resolved_database$fn__80044.invoke(setup.clj:125)""
  ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:240)""
  ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)""
  ""query_processor$process_query.invokeStatic(query_processor.clj:79)""
  ""query_processor$process_query.invoke(query_processor.clj:72)""
  ""query_processor.card$process_query_for_card_default_qp.invokeStatic(card.clj:235)""
  ""query_processor.card$process_query_for_card_default_qp.invoke(card.clj:231)""
  ""query_processor.card$process_query_for_card_default_run_fn$fn__88760$fn__88761.invoke(card.clj:243)""
  ""query_processor.streaming$_streaming_response$fn__65606$fn__65607$fn__65608.invoke(streaming.clj:225)""
  ""query_processor.streaming$_streaming_response$fn__65606$fn__65607.invoke(streaming.clj:223)""
  ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:214)""
  ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:201)""
  ""query_processor.streaming$_streaming_response$fn__65606.invoke(streaming.clj:220)""
  ""server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:83)""
  ""server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:81)""
  ""server.streaming_response$do_f_async$task__57166.invoke(streaming_response.clj:98)""],
 :card_id 96,
 :context :dashboard,
 :error ""ERROR: column source.email does not exist\n  Position: 525"",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
v1.57.5.5
```

### Severity

P1

### Additional context

This worked in 56",dragonsahead,2,"Type:Bug, Priority:P1, Administration/Data Sandboxes, .Escalation, .Team/Querying, Cloud-Blocker:57",https://github.com/metabase/metabase/issues/66781,2025-12-10T20:33:49Z,2025-12-11T05:29:21Z,negative,bug,high
3716518756,66777,Slow search in data picker after upgrade to v56,closed,"### Describe the bug

[Customer](https://app.usepylon.com/issues/views/9563cff7-93de-4f1b-8598-cafd59f31700?conversationID=1d67e29a-0aa7-4ad8-add5-57a44b71f311) reports search slowing down after upgrading from v53 to v56.
This search is triggered by opening a new question in Interactive embedding, which in turn calls the search API with `search?models=dataset&models=table&limit=0` and hangs until that is finished

### To Reproduce

Couldn't reproduce yet, but if you set up 5k tables and some data permissions (e.g. block some of them off), and view this from a user affected by those permissions, the performance becomes quite slow considering it's running locally (around 1s)


### Expected behavior

The performance should be comparable to v53

### Logs

Attached is an `EXPLAIN` of the query
[auto_explain (5).sql](https://github.com/user-attachments/files/24086489/auto_explain.5.sql)


### Information about your Metabase installation

```JSON
v56.15
```

### Severity

P2

### Additional context

In [this PR](https://github.com/metabase/metabase/pull/57541/files#diff-57b90a9752402ee2ad8d2bf3ea283bf457ccf3edff285adc6571908461fa1491R72) we added some permissions subqueries to the search SQL, and it turns out for this customer with 5k+ tables, search is taking around 5s when loading the data picker, which feels very slow.
Primary suspect on line 65 of the EXPLAIN ANALYZE attached is that the permissions subquery is looped 5k+ times for the candidate tables, and that node takes around 3s.",ghostframe,2,"Type:Bug, Priority:P1, Administration/Permissions, Organization/Search, .Escalation, .Team/UXWest",https://github.com/metabase/metabase/issues/66777,2025-12-10T19:34:33Z,2025-12-17T18:04:03Z,negative,bug,high
3716398032,66775,Deleting a card/dashboard through API doesn't remove it from the AppDB index until next reindex,open,"### Describe the bug

If you delete a card/dashboard through its DELETE endpoint, it will remain in the search index until the next reindex (which happens at least every 1 hour)

### To Reproduce

1. Search for ""Unique customers per month"" from our Examples

<img width=""651"" height=""352"" alt=""Image"" src=""https://github.com/user-attachments/assets/c0e010b3-c2da-4cf5-95f3-801660e67630"" />
 
2. Do an API call to delete it: `DELETE /api/card/30`
3. Refresh, search again. It's still there but if you visit it you get ""not found""

Repeat the process with another card, but delete it through the UI by trashing it first. Now, it is correctly removed from the index.

### Expected behavior

It should remove it from the index

### Logs

_No response_

### Information about your Metabase installation

```JSON
v56.16
```

### Severity

P2

### Additional context

We seem to react to trashing due to this:
https://github.com/metabase/metabase/blob/a18d59447cf5bcf95ebd5021c29bc36043754a7d/src/metabase/search/models.clj#L16-L20

(comes from this [PR](https://github.com/metabase/metabase/pull/49666/files#diff-4cdadf188f5f21df92674f4a68266c85e86f4eda223e2e3795d8fc4d8ca2bf4a))",ghostframe,0,"Type:Bug, Priority:P2, Organization/Search, Organization/Trash, .Team/UXWest, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66775,2025-12-10T18:51:52Z,,negative,bug,medium
3716212440,66773,"Dummy task, ignore",closed,"**Context**


- issue links: _related issues if any_

",albertoperdomo,0,".Task, Release-Blocker/58/Gold, Release-Blocker/58/Beta",https://github.com/metabase/metabase/issues/66773,2025-12-10T17:50:55Z,2025-12-11T15:21:09Z,neutral,other,low
3716194332,66772,Permissions table is not respecting the frozen column in the UI,closed,"### Describe the bug

<img width=""1500"" height=""642"" alt=""Image"" src=""https://github.com/user-attachments/assets/f8d8710d-ea8f-43e8-a297-9d963f164332"" />
<img width=""1511"" height=""612"" alt=""Image"" src=""https://github.com/user-attachments/assets/a432fc62-7a14-4edf-b2a1-40217f32cad0"" />

### To Reproduce

1. Go to 'Admin Settings'
2. Click on 'Permissions'
3. Go to the Data tab
4. Scroll the names to the left
5. See error

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Version v1.57.5.2
Built on 2025-12-02

Hash: 63b11ed
```

### Severity

low

### Additional context

_No response_",psalinasy,0,"Type:Bug, Priority:P3, Administration/Permissions, Difficulty:Easy, .Frontend, .Reproduced, .Team/UXWest, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66772,2025-12-10T17:45:39Z,2025-12-23T02:40:03Z,negative,bug,low
3715995228,66769,"Users get ""Stuck"" in Exploration when they don't have Access to ""Initial Collection"" in metabase-browser",open,"### Describe the bug

If you embed metabase-browser and set ""initial collection"" to a collection the user has no access to, the browser still ""works"". You can create a new exploration and you can see the toast at the top of the page.

From there they get a bit ""stuck"" because they are presented with a save option they can't use. Then, at the top, the ""New Exploration"" toast is isolated and looks like a clickable link but it's not. 

### To Reproduce

1. Embed metabase-browser component with EAJS
2. Set the initial-collection to a collection the user has ""No access"" to
3. Create a new exploration
4. Note that ""save' doesn't work because the user doesn't have curate permissions
5. Note that the ""new exploration"" in the toast looks clickable/like navigation
6.  User is stranded

This is still confusing if the user has ""No access"" to the initial collection because the ""New exploration"" toast looks clickable. The reporting customer expected that to be another method of creating a new explore because it sounds a bit like a call to action.

https://www.loom.com/share/200e76ca88034f2b848ac1dbe8ce8959

### Expected behavior

I'm not positive but I suspect if the user doesn't have access at all to the initial collection we should show an error instead of allowing exploration? 

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57.5
```

### Severity

confusing

### Additional context

Reporting customer though this would allow you to begin a new exploration because it appears to be a button. ",ixipixi,1,"Type:Bug, Priority:P3, .Team/Embedding, Embedding/EmbedJS",https://github.com/metabase/metabase/issues/66769,2025-12-10T16:44:32Z,,negative,bug,medium
3715944666,66768,"Modular Embedding: We Display the ""Save"" button in the Browser UI even if the user doesn't have Curate Access",open,"### Describe the bug

If you embed metabase-browser and the initial-collection is one the user doesn't have curate access to we still display the ""save"" button.

### To Reproduce

1. Embed metabase-browser component with EAJS
2. Set the initial-collection to a collection the user has ""Can View"" access to
3. Create a new exploration
4. Note the ""Save"" option is available even thought they can't save the question

### Expected behavior

I would think we shouldn't imply they can save the explore if they can't

### Logs

_No response_

### Information about your Metabase installation

```JSON
v57.5
```

### Severity

confusing

### Additional context

_No response_",ixipixi,0,"Type:Bug, Priority:P3, .Team/Embedding, Embedding/EmbedJS, .Triaged Dec 2025",https://github.com/metabase/metabase/issues/66768,2025-12-10T16:31:49Z,,negative,bug,medium
3715746939,66763,Warn users that their JVM timezone differs from their Report timezone,open,"**Is your feature request related to a problem? Please describe.**
In our [docs](https://www.metabase.com/docs/latest/configuring-metabase/timezones#recommended-settings) we tell people to configure their JVM timezone to match their Report timezone. However, if you didn't read this specific bit in the docs and these two differ, it's not too obvious to the user - some things like date field filters will use the JVM ""now"" in UTC and cause wrong results when running queries since it's different from the configured report timezone's ""now"".

**Describe the solution you'd like**
A warning/callout in the admin panel and or/logs that tells you if you have a report timezone set and your current JVM timezone doesn't match this timezone",ghostframe,0,"Type:New Feature, Administration/Settings, .Team/UXWest, .Auto triaged",https://github.com/metabase/metabase/issues/66763,2025-12-10T15:41:20Z,,neutral,feature_request,medium
